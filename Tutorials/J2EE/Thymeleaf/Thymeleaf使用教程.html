<!DOCTYPE html>
<!-- saved from url=(0048)http://www.thymeleaf.org/doc/usingthymeleaf.html -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>Tutorial: Using Thymeleaf</title>
	<meta charset="utf-8">
	<meta name="generator" content="pandoc">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="format-detection" content="telephone=no">

	<link rel="icon" href="./resources/icon.png">
	<link rel="stylesheet" href="./resources/open-sans.css">
	<link rel="stylesheet" href="./resources/source-sans-pro.css">
	<link rel="stylesheet" href="./resources/normalize.css">
	<link rel="stylesheet" href="./resources/thymeleaf.css">
	<link rel="stylesheet" href="./resources/thymeleaf-screen.css" media="screen">
	<link rel="stylesheet" href="./resources/thymeleaf-print.css" media="print">

	<script type="text/javascript" async="" src="./resources/ga.js"></script><script src="./resources/prettify.min.js"></script>
	<script src="./resources/jquery.min.js"></script>
	<script src="./resources/thymeleaf-tutorials.js"></script>

	<!-- Google Analytics script -->
	<script>
		var _gaq = _gaq || [];
			_gaq.push(['_setAccount', 'UA-1276954-9']);
			_gaq.push(['_trackPageview']);
		(function() {
			var ga = document.createElement('script');
				ga.type = 'text/javascript';
				ga.async = true;
				ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0];
				s.parentNode.insertBefore(ga, s);
		})();
	</script>

</head>

<body class="tutorial">

	<div id="documentation-wrapper">

	<div id="title-block-wrapper">
		<header id="title-block">
			<img id="doc-banner" class="banner" src="./resources/header.png" alt="Thymeleaf logo">
			<h1 id="doc-title" class="title">Tutorial: Using Thymeleaf</h1>
			<div id="doc-info">
				<div id="doc-version">
					<span class="info-header">Document version:</span> 20140702 - 02 July 2014
				</div>
				<div id="project-version">
					<span class="info-header">Project Version:</span> 2.1.3.RELEASE
				</div>
				<div id="project-website">
					<span class="info-header">Project web site:</span>
					<a href="http://www.thymeleaf.org/">http://www.thymeleaf.org</a>
				</div>
			</div>
		</header>
	</div>

	<div id="toc-wrapper">
		<nav id="toc">
<ul class="level1">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#introducing-thymeleaf">1 Introducing Thymeleaf</a><ul class="level2">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#what-is-thymeleaf">1.1 What is Thymeleaf?</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#what-kind-of-templates-can-thymeleaf-process">1.2 What kind of templates can Thymeleaf process?</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#dialects-the-standard-dialect">1.3 Dialects: The Standard Dialect</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#overall-architecture">1.4 Overall Architecture</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#before-going-any-further-you-should-read">1.5 Before going any further, you should read…</a></li>
</ul></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#the-good-thymes-virtual-grocery">2 The Good Thymes Virtual Grocery</a><ul class="level2">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#a-website-for-a-grocery">2.1 A website for a grocery</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#creating-and-configuring-the-template-engine">2.2 Creating and configuring the Template Engine</a><ul class="level3">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#the-template-resolver">The Template Resolver</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#the-template-engine">The Template Engine</a></li>
</ul></li>
</ul></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#using-texts">3 Using Texts</a><ul class="level2">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#a-multi-language-welcome">3.1 A multi-language welcome</a><ul class="level3">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#using-thtext-and-externalizing-text">Using th:text and externalizing text</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#contexts">Contexts</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#executing-the-template-engine">Executing the template engine</a></li>
</ul></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#more-on-texts-and-variables">3.2 More on texts and variables</a><ul class="level3">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#unescaped-text">Unescaped Text</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#using-and-displaying-variables">Using and displaying variables</a></li>
</ul></li>
</ul></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#standard-expression-syntax">4 Standard Expression Syntax</a><ul class="level2">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#messages">4.1 Messages</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#variables">4.2 Variables</a><ul class="level3">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#expression-basic-objects">Expression Basic Objects</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#expression-utility-objects">Expression Utility Objects</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#reformatting-dates-in-our-home-page">Reformatting dates in our home page</a></li>
</ul></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#expressions-on-selections-asterisk-syntax">4.3 Expressions on selections (asterisk syntax)</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#link-urls">4.4 Link URLs</a><ul class="level3">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#a-menu-for-our-home-page">A menu for our home page</a></li>
</ul></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#literals">4.5 Literals</a><ul class="level3">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#text-literals">Text literals</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#number-literals">Number literals</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#boolean-literals">Boolean literals</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#the-null-literal">The null literal</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#literal-tokens">Literal tokens</a></li>
</ul></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#appending-texts">4.6 Appending texts</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#literal-substitutions">4.7 Literal substitutions</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#arithmetic-operations">4.8 Arithmetic operations</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#comparators-and-equality">4.9 Comparators and Equality</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#conditional-expressions">4.10 Conditional expressions</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#default-expressions-elvis-operator">4.11 Default expressions (Elvis operator)</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#preprocessing">4.12 Preprocessing</a></li>
</ul></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#setting-attribute-values">5 Setting Attribute Values</a><ul class="level2">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#setting-the-value-of-any-attribute">5.1 Setting the value of any attribute</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#setting-value-to-specific-attributes">5.2 Setting value to specific attributes</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#setting-more-than-one-value-at-a-time">5.3 Setting more than one value at a time</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#appending-and-prepending">5.4 Appending and prepending</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#fixed-value-boolean-attributes">5.5 Fixed-value boolean attributes</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#support-for-html5-friendly-attribute-and-element-names">5.6 Support for HTML5-friendly attribute and element names</a></li>
</ul></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#iteration">6 Iteration</a><ul class="level2">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#iteration-basics">6.1 Iteration basics</a><ul class="level3">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#using-theach">Using th:each</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#iterable-values">Iterable values</a></li>
</ul></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#keeping-iteration-status">6.2 Keeping iteration status</a></li>
</ul></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#conditional-evaluation">7 Conditional Evaluation</a><ul class="level2">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#simple-conditionals-if-and-unless">7.1 Simple conditionals: “if” and “unless”</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#switch-statements">7.2 Switch statements</a></li>
</ul></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#template-layout">8 Template Layout</a><ul class="level2">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#including-template-fragments">8.1 Including template fragments</a><ul class="level3">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#defining-and-referencing-fragments">Defining and referencing fragments</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#referencing-fragments-without-thfragment">Referencing fragments without <code>th:fragment</code></a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#difference-between-thinclude-and-threplace">Difference between <code>th:include</code> and <code>th:replace</code></a></li>
</ul></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#parameterizable-fragment-signatures">8.2 Parameterizable fragment signatures</a><ul class="level3">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#fragment-local-variables-without-fragment-signature">Fragment local variables without fragment signature</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#thassert-for-in-template-assertions">th:assert for in-template assertions</a></li>
</ul></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#removing-template-fragments">8.3 Removing template fragments</a></li>
</ul></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#local-variables">9 Local Variables</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#attribute-precedence">10 Attribute Precedence</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#comments-and-blocks">11. Comments and Blocks</a><ul class="level2">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#standard-htmlxml-comments">11.1. Standard HTML/XML comments</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#thymeleaf-parser-level-comment-blocks">11.2. Thymeleaf parser-level comment blocks</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#thymeleaf-prototype-only-comment-blocks">11.3. Thymeleaf prototype-only comment blocks</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#synthetic-thblock-tag">11.4. Synthetic <code>th:block</code> tag</a></li>
</ul></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#inlining">12 Inlining</a><ul class="level2">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#text-inlining">12.1 Text inlining</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#script-inlining-javascript-and-dart">12.2 Script inlining (JavaScript and Dart)</a><ul class="level3">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#adding-code">Adding code</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#removing-code">Removing code</a></li>
</ul></li>
</ul></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#validation-and-doctypes">13 Validation and Doctypes</a><ul class="level2">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#validating-templates">13.1 Validating templates</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#doctype-translation">13.2 Doctype translation</a></li>
</ul></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#some-more-pages-for-our-grocery">14 Some more Pages for our Grocery</a><ul class="level2">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#order-list">14.1 Order List</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#order-details">14.2 Order Details</a></li>
</ul></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#more-on-configuration">15 More on Configuration</a><ul class="level2">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#template-resolvers">15.1 Template Resolvers</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#message-resolvers">15.2 Message Resolvers</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#logging">15.3 Logging</a></li>
</ul></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#template-cache">16 Template Cache</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#appendix-a-expression-basic-objects">17 Appendix A: Expression Basic Objects</a><ul class="level2">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#base-objects">Base objects</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#web-context-namespaces-for-requestsession-attributes-etc.">Web context namespaces for request/session attributes, etc.</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#web-context-objects">Web context objects</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#spring-context-objects">Spring context objects</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#spring-beans">Spring beans</a></li>
</ul></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#appendix-b-expression-utility-objects">18 Appendix B: Expression Utility Objects</a><ul class="level2">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#dates">Dates</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#calendars">Calendars</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#numbers">Numbers</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#strings">Strings</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#objects">Objects</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#booleans">Booleans</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#arrays">Arrays</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#lists">Lists</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#sets">Sets</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#maps">Maps</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#aggregates">Aggregates</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#messages-1">Messages</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#ids">IDs</a></li>
</ul></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#appendix-c-dom-selector-syntax">19 Appendix C: DOM Selector syntax</a><ul class="level2">
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#multivalued-class-matching">Multivalued class matching</a></li>
<li><a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#optional-brackets">Optional brackets</a></li>
</ul></li>
</ul>
		</nav>
	</div>

	<div id="content-wrapper">
		<div id="content">
<section id="introducing-thymeleaf" class="level1">
<h1>1 Introducing Thymeleaf</h1>
<section id="what-is-thymeleaf" class="level2">
<h2>1.1 What is Thymeleaf?</h2>
<p>Thymeleaf is a Java library. It is an XML/XHTML/HTML5 template engine able to apply a set of transformations to template files in order to display data and/or text produced by your applications.</p>
<p>It is better suited for serving XHTML/HTML5 in web applications, but it can process any XML file, be it in web or in standalone applications.</p>
<p>The main goal of Thymeleaf is to provide an elegant and well-formed way of creating templates. In order to achieve this, it is based on XML tags and attributes that define the execution of predefined logic on the <em>DOM (Document Object Model)</em>, instead of explicitly writing that logic as code inside the template.</p>
<p>Its architecture allows a fast processing of templates, relying on intelligent caching of parsed files in order to use the least possible amount of I/O operations during execution.</p>
<p>And last but not least, Thymeleaf has been designed from the beginning with XML and Web standards in mind, allowing you to create fully validating templates if that is a need for you.</p>
</section>
<section id="what-kind-of-templates-can-thymeleaf-process" class="level2">
<h2>1.2 What kind of templates can Thymeleaf process?</h2>
<p>Out-of-the-box, Thymeleaf allows you to process six kinds of templates, each of which is called a Template Mode:</p>
<ul>
<li>XML</li>
<li>Valid XML</li>
<li>XHTML</li>
<li>Valid XHTML</li>
<li>HTML5</li>
<li>Legacy HTML5</li>
</ul>
<p>All of these modes refer to well-formed XML files except the <em>Legacy HTML5</em> mode, which allows you to process HTML5 files with features such as standalone (not closed) tags, tag attributes without a value or not written between commas. In order to process files in this specific mode, Thymeleaf will first perform a transformation that will convert your files to well-formed XML files which are still perfectly valid HTML5 (and are in fact the recommended way to create HTML5 code)<a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>.</p>
<p>Also note that validation is only available for XML and XHTML templates.</p>
<p>Nevertheless, these are not the only types of template that Thymeleaf can process, and the user is always able to define his/her own mode by specifying both a way to <em>parse</em> templates in this mode and a way to <em>write</em> the results. This way, anything that can be modelled as a DOM tree (be it XML or not) could effectively be processed as a template by Thymeleaf.</p>
</section>
<section id="dialects-the-standard-dialect" class="level2">
<h2>1.3 Dialects: The Standard Dialect</h2>
<p>Thymeleaf is an extremely extensible template engine (in fact it should be better called a <em>template engine framework</em>) that allows you to completely define the DOM nodes that will be processed in your templates and also how they will be processed.</p>
<p>An object that applies some logic to a DOM node is called a <em>processor</em>, and a set of these processors —plus some extra artifacts— is called a dialect, of which Thymeleaf’s core library provides one out-of-the-box called the <em>Standard Dialect</em>, which should be enough for the needs of a big percent of users.</p>
<p><em>The Standard Dialect is the dialect this tutorial covers</em>. Every attribute and syntax feature you will learn about in the following pages is defined by this dialect, even if that isn’t explicitly mentioned.</p>
<p>Of course, users may create their own dialects (even extending the Standard one) if they want to define their own processing logic while taking advantage of the library’s advanced features. A Template Engine can be configured several dialects at a time.</p>
<blockquote>
<p>The official thymeleaf-spring3 and thymeleaf-spring4 integration packages both define a dialect called the “SpringStandard Dialect”, mostly equivalent to the Standard Dialect but with small adaptations to make better use of some features in Spring Framework (for example, by using Spring Expression Language instead of Thymeleaf’s standard OGNL). So if you are a Spring MVC user you are not wasting your time, as almost everything you learn here will be of use in your Spring applications.</p>
</blockquote>
<p>The Thymeleaf Standard Dialect can process templates in any mode, but is especially suited for web-oriented template modes (XHTML and HTML5 ones). Besides HTML5, it specifically supports and validates the following XHTML specifications: <em>XHTML 1.0 Transitional</em>, <em>XHTML 1.0 Strict</em>, <em>XHTML 1.0 Frameset</em>, and <em>XHTML 1.1</em>.</p>
<p>Most of the processors of the Standard Dialect are <em>attribute processors</em>. This allows browsers to correctly display XHTML/HTML5 template files even before being processed, because they will simply ignore the additional attributes. For example, while a JSP using tag libraries could include a fragment of code not directly displayable by a browser like:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;form:inputText</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"userName"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"${user.name}"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></pre>
<p>…the Thymeleaf Standard Dialect would allow us to achieve the same functionality with:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"userName"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"James Carrot"</span><span class="pln"> </span><span class="atn">th:value</span><span class="pun">=</span><span class="atv">"${user.name}"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></pre>
<p>Which not only will be correctly displayed by browsers, but also allow us to (optionally) specify a value attribute in it (“James Carrot”, in this case) that will be displayed when the prototype is statically opened in a browser, and that will be substituted by the value resulting from the evaluation of <code>${user.name}</code> during Thymeleaf processing of the template.</p>
<p>If needed, this will allow your designer and developer to work on the very same template file and reduce the effort required to transform a static prototype into a working template file. The ability to do this is a feature usually called <em>Natural Templating</em>.</p>
</section>
<section id="overall-architecture" class="level2">
<h2>1.4 Overall Architecture</h2>
<p>Thymeleaf’s core is a DOM processing engine. Specifically, it uses its own high-performance DOM implementation —not the standard DOM API— for building in-memory tree representations of your templates, on which it later operates by traversing their nodes and executing processors on them that modify the DOM according to the current <em>configuration</em> and the set of data that is passed to the template for its representation —known as the context.</p>
<p>The use of a DOM template representation makes it very well suited for web applications because web documents are very often represented as object trees (in fact DOM trees are the way browsers represent web pages in memory). Also, building on the idea that most web applications use only a few dozen templates, that these are not big files and that they don’t normally change while the application is running, Thymeleaf’s usage of an in-memory cache of parsed template DOM trees allows it to be fast in production environments, because very little I/O is needed (if any) for most template processing operations.</p>
<blockquote>
<p>If you want more detail, later in this tutorial there is an entire chapter dedicated to caching and to the way Thymeleaf optimizes memory and resource usage for faster operation.</p>
</blockquote>
<p>Nevertheless, there is a restriction: this architecture also requires the use of bigger amounts of memory space for each template execution than other template parsing/processing approaches, which means that you should not use the library for creating big data XML documents (as opposed to web documents). As a general rule of thumb (and always depending on the memory size of your JVM), if you are generating XML files with sizes around the tens of megabytes in a single template execution, you probably should not be using Thymeleaf.</p>
<blockquote>
<p>The reason we consider this restriction only applies to data XML files and not web XHTML/HTML5 is that you should never generate web documents so big that your users’ browsers set ablaze and/or explode – remember that these browsers will also have to create DOM trees for your pages!</p>
</blockquote>
</section>
<section id="before-going-any-further-you-should-read" class="level2">
<h2>1.5 Before going any further, you should read…</h2>
<p>Thymeleaf is especially suited for working in web applications. And web applications are based on a series of standards that everyone should know very well but few do – even if they have been working with them for years.</p>
<p>With the advent of HTML5, the state of the art in web standards today is more confusing than ever… <em>are we going back from XHTML to HTML? Will we abandon XML syntax? Why is nobody talking about XHTML 2.0 anymore?</em></p>
<p>So before going any further in this tutorial, you are strongly advised to read an article on Thymeleaf’s web site called <em>“From HTML to HTML (via HTML)”</em>, which you can find at this address: <a href="http://www.thymeleaf.org/doc/fromhtmltohtmlviahtml.html">http://www.thymeleaf.org/fromhtmltohtmlviahtml.html</a></p>
</section>
</section>
<section id="the-good-thymes-virtual-grocery" class="level1">
<h1>2 The Good Thymes Virtual Grocery</h1>
<section id="a-website-for-a-grocery" class="level2">
<h2>2.1 A website for a grocery</h2>
<p>In order to better explain the concepts involved in processing templates with Thymeleaf, this tutorial will use a demo application you can download from the project web site.</p>
<p>This application represents the web site of an imaginary virtual grocery, and will provide us with the adequate scenarios to exemplify diverse Thymeleaf features.</p>
<p>We will need a quite simple set of model entities for our application: <code>Products</code> which are sold to <code>Customers</code> by creating <code>Orders</code>. We will also be managing <code>Comments</code> about those <code>Products</code>:</p>
<figure>
<img src="./resources/gtvg-model.png" alt="Example application model"><figcaption>Example application model</figcaption>
</figure>
<p>Our small application will also have a very simple service layer, composed by <code>Service</code> objects containing methods like:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">ProductService</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="pun">...</span><span class="pln">

    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Product</span><span class="pun">&gt;</span><span class="pln"> findAll</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">ProductRepository</span><span class="pun">.</span><span class="pln">getInstance</span><span class="pun">().</span><span class="pln">findAll</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">Product</span><span class="pln"> findById</span><span class="pun">(</span><span class="typ">Integer</span><span class="pln"> id</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">ProductRepository</span><span class="pun">.</span><span class="pln">getInstance</span><span class="pun">().</span><span class="pln">findById</span><span class="pun">(</span><span class="pln">id</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    
</span><span class="pun">}</span></code></pre>
<p>Finally, at the web layer our application will have a filter that will delegate execution to Thymeleaf-enabled commands depending on the request URL:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="kwd">private</span><span class="pln"> </span><span class="kwd">boolean</span><span class="pln"> process</span><span class="pun">(</span><span class="typ">HttpServletRequest</span><span class="pln"> request</span><span class="pun">,</span><span class="pln"> </span><span class="typ">HttpServletResponse</span><span class="pln"> response</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">ServletException</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        
    </span><span class="kwd">try</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            
        </span><span class="com">/*
         * Query controller/URL mapping and obtain the controller
         * that will process the request. If no controller is available,
         * return false and let other filters/servlets process the request.
         */</span><span class="pln">
        </span><span class="typ">IGTVGController</span><span class="pln"> controller </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GTVGApplication</span><span class="pun">.</span><span class="pln">resolveControllerForRequest</span><span class="pun">(</span><span class="pln">request</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">controller </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="com">/*
         * Obtain the TemplateEngine instance.
         */</span><span class="pln">
        </span><span class="typ">TemplateEngine</span><span class="pln"> templateEngine </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GTVGApplication</span><span class="pun">.</span><span class="pln">getTemplateEngine</span><span class="pun">();</span><span class="pln">
            
        </span><span class="com">/*
         * Write the response headers
         */</span><span class="pln">
        response</span><span class="pun">.</span><span class="pln">setContentType</span><span class="pun">(</span><span class="str">"text/html;charset=UTF-8"</span><span class="pun">);</span><span class="pln">
        response</span><span class="pun">.</span><span class="pln">setHeader</span><span class="pun">(</span><span class="str">"Pragma"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"no-cache"</span><span class="pun">);</span><span class="pln">
        response</span><span class="pun">.</span><span class="pln">setHeader</span><span class="pun">(</span><span class="str">"Cache-Control"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"no-cache"</span><span class="pun">);</span><span class="pln">
        response</span><span class="pun">.</span><span class="pln">setDateHeader</span><span class="pun">(</span><span class="str">"Expires"</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">

        </span><span class="com">/*
         * Execute the controller and process view template,
         * writing the results to the response writer.
         */</span><span class="pln">
        controller</span><span class="pun">.</span><span class="pln">process</span><span class="pun">(</span><span class="pln">
                request</span><span class="pun">,</span><span class="pln"> response</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">servletContext</span><span class="pun">,</span><span class="pln"> templateEngine</span><span class="pun">);</span><span class="pln">

        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
            
    </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">catch</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Exception</span><span class="pln"> e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">throw</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ServletException</span><span class="pun">(</span><span class="pln">e</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
        
</span><span class="pun">}</span><span class="pln">    </span></code></pre>
<p>This is our <code>IGTVGController</code> interface:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">interface</span><span class="pln"> </span><span class="typ">IGTVGController</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> process</span><span class="pun">(</span><span class="pln">
            </span><span class="typ">HttpServletRequest</span><span class="pln"> request</span><span class="pun">,</span><span class="pln"> </span><span class="typ">HttpServletResponse</span><span class="pln"> response</span><span class="pun">,</span><span class="pln">
            </span><span class="typ">ServletContext</span><span class="pln"> servletContext</span><span class="pun">,</span><span class="pln"> </span><span class="typ">TemplateEngine</span><span class="pln"> templateEngine</span><span class="pun">);</span><span class="pln">    
    
</span><span class="pun">}</span></code></pre>
<p>All we have to do now is create implementations of the <code>IGTVGController</code> interface, retrieving data from the services and processing templates using the <code>TemplateEngine</code> object.</p>
<p>In the end, it will look like this:</p>
<figure>
<img src="./resources/gtvg-view.png" alt="Example application home page"><figcaption>Example application home page</figcaption>
</figure>
<p>But first let’s see how that template engine is initialized.</p>
</section>
<section id="creating-and-configuring-the-template-engine" class="level2">
<h2>2.2 Creating and configuring the Template Engine</h2>
<p>The <em>process(…)</em> method in our filter contained this sentence:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="typ">TemplateEngine</span><span class="pln"> templateEngine </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GTVGApplication</span><span class="pun">.</span><span class="pln">getTemplateEngine</span><span class="pun">();</span></code></pre>
<p>Which means that the <em>GTVGApplication</em> class is in charge of creating and configuring one of the most important objects in a Thymeleaf-enabled application: The <code>TemplateEngine</code> instance.</p>
<p>Our <code>org.thymeleaf.TemplateEngine</code> object is initialized like this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">GTVGApplication</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  
    
    </span><span class="pun">...</span><span class="pln">
    </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="typ">TemplateEngine</span><span class="pln"> templateEngine</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">...</span><span class="pln">
    
    
    </span><span class="kwd">static</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="pun">...</span><span class="pln">
        initializeTemplateEngine</span><span class="pun">();</span><span class="pln">
        </span><span class="pun">...</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    
    
    </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> initializeTemplateEngine</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        
        </span><span class="typ">ServletContextTemplateResolver</span><span class="pln"> templateResolver </span><span class="pun">=</span><span class="pln"> 
            </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ServletContextTemplateResolver</span><span class="pun">();</span><span class="pln">
        </span><span class="com">// XHTML is the default mode, but we set it anyway for better understanding of code</span><span class="pln">
        templateResolver</span><span class="pun">.</span><span class="pln">setTemplateMode</span><span class="pun">(</span><span class="str">"XHTML"</span><span class="pun">);</span><span class="pln">
        </span><span class="com">// This will convert "home" to "/WEB-INF/templates/home.html"</span><span class="pln">
        templateResolver</span><span class="pun">.</span><span class="pln">setPrefix</span><span class="pun">(</span><span class="str">"/WEB-INF/templates/"</span><span class="pun">);</span><span class="pln">
        templateResolver</span><span class="pun">.</span><span class="pln">setSuffix</span><span class="pun">(</span><span class="str">".html"</span><span class="pun">);</span><span class="pln">
        </span><span class="com">// Template cache TTL=1h. If not set, entries would be cached until expelled by LRU</span><span class="pln">
        templateResolver</span><span class="pun">.</span><span class="pln">setCacheTTLMs</span><span class="pun">(</span><span class="lit">3600000L</span><span class="pun">);</span><span class="pln">
        
        templateEngine </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">TemplateEngine</span><span class="pun">();</span><span class="pln">
        templateEngine</span><span class="pun">.</span><span class="pln">setTemplateResolver</span><span class="pun">(</span><span class="pln">templateResolver</span><span class="pun">);</span><span class="pln">
        
    </span><span class="pun">}</span><span class="pln">
    
    </span><span class="pun">...</span><span class="pln">

</span><span class="pun">}</span></code></pre>
<p>Of course there are many ways of configuring a <code>TemplateEngine</code> object, but for now these few lines of code will teach us enough about the steps needed.</p>
<section id="the-template-resolver" class="level3">
<h3>The Template Resolver</h3>
<p>Let’s start with the Template Resolver:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="typ">ServletContextTemplateResolver</span><span class="pln"> templateResolver </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ServletContextTemplateResolver</span><span class="pun">();</span></code></pre>
<p>Template Resolvers are objects that implement an interface from the Thymeleaf API called <code>org.thymeleaf.templateresolver.ITemplateResolver</code>:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">interface</span><span class="pln"> </span><span class="typ">ITemplateResolver</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="pun">...</span><span class="pln">
  
    </span><span class="com">/*
     * Templates are resolved by String name (templateProcessingParameters.getTemplateName())
     * Will return null if template cannot be handled by this template resolver.
     */</span><span class="pln">
    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">TemplateResolution</span><span class="pln"> resolveTemplate</span><span class="pun">(</span><span class="pln">
            </span><span class="typ">TemplateProcessingParameters</span><span class="pln"> templateProcessingParameters</span><span class="pun">);</span><span class="pln">

</span><span class="pun">}</span></code></pre>
<p>These objects are in charge of determining how our templates will be accessed, and in this GTVG application, the <code>org.thymeleaf.templateresolver.ServletContextTemplateResolver</code> implementation that we are using specifies that we are going to retrieve our template files as resources from the <em>Servlet Context</em>: an application-wide <code>javax.servlet.ServletContext</code> object that exists in every Java web application, and that resolves resources considering the web application root as the root for resource paths.</p>
<p>But that’s not all we can say about the template resolver, because we can set some configuration parameters on it. First, the template mode, one of the standard ones:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="pln">templateResolver</span><span class="pun">.</span><span class="pln">setTemplateMode</span><span class="pun">(</span><span class="str">"XHTML"</span><span class="pun">);</span></code></pre>
<p>XHTML is the default template mode for <code>ServletContextTemplateResolver</code>, but it is good practice to establish it anyway so that our code documents clearly what is going on.</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="pln">templateResolver</span><span class="pun">.</span><span class="pln">setPrefix</span><span class="pun">(</span><span class="str">"/WEB-INF/templates/"</span><span class="pun">);</span><span class="pln">
templateResolver</span><span class="pun">.</span><span class="pln">setSuffix</span><span class="pun">(</span><span class="str">".html"</span><span class="pun">);</span></code></pre>
<p>These <em>prefix</em> and <em>suffix</em> do exactly what it looks like: modify the template names that we will be passing to the engine for obtaining the real resource names to be used.</p>
<p>Using this configuration, the template name <em>“product/list”</em> would correspond to:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="pln">servletContext</span><span class="pun">.</span><span class="pln">getResourceAsStream</span><span class="pun">(</span><span class="str">"/WEB-INF/templates/product/list.html"</span><span class="pun">)</span></code></pre>
<p>Optionally, the amount of time that a parsed template living in cache will be considered valid can be configured at the Template Resolver by means of the <em>cacheTTLMs</em> property:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="pln">templateResolver</span><span class="pun">.</span><span class="pln">setCacheTTLMs</span><span class="pun">(</span><span class="lit">3600000L</span><span class="pun">);</span></code></pre>
<p>Of course, a template can be expelled from cache before that TTL is reached if the max cache size is reached and it is the oldest entry currently cached.</p>
<blockquote>
<p>Cache behaviour and sizes can be defined by the user by implementing the <code>ICacheManager</code> interface or simply modifying the <code>StandardCacheManager</code> object set to manage caches by default.</p>
</blockquote>
<p>We will learn more about template resolvers later. Now let’s have a look at the creation of our Template Resolver object.</p>
</section>
<section id="the-template-engine" class="level3">
<h3>The Template Engine</h3>
<p>Template Engine objects are of class <em>org.thymeleaf.TemplateEngine</em>, and these are the lines that created our engine in the current example:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="pln">templateEngine </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">TemplateEngine</span><span class="pun">();</span><span class="pln">
templateEngine</span><span class="pun">.</span><span class="pln">setTemplateResolver</span><span class="pun">(</span><span class="pln">templateResolver</span><span class="pun">);</span></code></pre>
<p>Rather simple, isn’t it? All we need is to create an instance and set the Template Resolver to it.</p>
<p>A template resolver is the only required parameter a <code>TemplateEngine</code> needs, although of course there are many others that will be covered later (message resolvers, cache sizes, etc). For now, this is all we need.</p>
<p>Our Template Engine is now ready and we can start creating our pages using Thymeleaf.</p>
</section>
</section>
</section>
<section id="using-texts" class="level1">
<h1>3 Using Texts</h1>
<section id="a-multi-language-welcome" class="level2">
<h2>3.1 A multi-language welcome</h2>
<p>Our first task will be to create a home page for our grocery site.</p>
<p>The first version we will write of this page will be extremely simple: just a title and a welcome message. This is our <code>/WEB-INF/templates/home.html</code> file:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="dec">&lt;!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd"&gt;</span><span class="pln">

</span><span class="tag">&lt;html</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.w3.org/1999/xhtml"</span><span class="pln">
      </span><span class="atn">xmlns:th</span><span class="pun">=</span><span class="atv">"http://www.thymeleaf.org"</span><span class="tag">&gt;</span><span class="pln">

  </span><span class="tag">&lt;head&gt;</span><span class="pln">
    </span><span class="tag">&lt;title&gt;</span><span class="pln">Good Thymes Virtual Grocery</span><span class="tag">&lt;/title&gt;</span><span class="pln">
    </span><span class="tag">&lt;meta</span><span class="pln"> </span><span class="atn">http-equiv</span><span class="pun">=</span><span class="atv">"Content-Type"</span><span class="pln"> </span><span class="atn">content</span><span class="pun">=</span><span class="atv">"text/html; charset=UTF-8"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
    </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"stylesheet"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text/css"</span><span class="pln"> </span><span class="atn">media</span><span class="pun">=</span><span class="atv">"all"</span><span class="pln"> 
          </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"../../css/gtvg.css"</span><span class="pln"> </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/css/gtvg.css}"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/head&gt;</span><span class="pln">

  </span><span class="tag">&lt;body&gt;</span><span class="pln">
  
    </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"#{home.welcome}"</span><span class="tag">&gt;</span><span class="pln">Welcome to our grocery store!</span><span class="tag">&lt;/p&gt;</span><span class="pln">
  
  </span><span class="tag">&lt;/body&gt;</span><span class="pln">

</span><span class="tag">&lt;/html&gt;</span></code></pre>
<p>The first thing you will notice here is that this file is XHTML that can be correctly displayed by any browser, because it does not include any non-XHTML tags (and browsers ignore all attributes they don’t understand, like <code>th:text</code>). Also, browsers will display it in standards mode (not in quirks mode), because it has a well-formed <code>DOCTYPE</code> declaration.</p>
<p>Next, this is also <em>valid</em> XHTML<a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a>, because we have specified a Thymeleaf DTD which defines attributes like <code>th:text</code> so that your templates can be considered valid. And even more: once the template is processed (and all <code>th:*</code> attributes are removed), Thymeleaf will automatically substitute that DTD declaration in the <code>DOCTYPE</code> clause by a standard <code>XHTML 1.0 Strict</code> one (we will leave this DTD translation features for a later chapter).</p>
<p>A thymeleaf namespace is also being declared for <code>th:*</code> attributes:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;html</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.w3.org/1999/xhtml"</span><span class="pln">
      </span><span class="atn">xmlns:th</span><span class="pun">=</span><span class="atv">"http://www.thymeleaf.org"</span><span class="tag">&gt;</span></code></pre>
<p>Note that, if we hadn’t cared about our template’s validity or well-formedness at all, we could have simply specified a standard <code>XHTML 1.0 Strict DOCTYPE</code>, along with no xmlns namespace declarations:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="dec">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;</span><span class="pln">

</span><span class="tag">&lt;html&gt;</span><span class="pln">

  </span><span class="tag">&lt;head&gt;</span><span class="pln">
    </span><span class="tag">&lt;title&gt;</span><span class="pln">Good Thymes Virtual Grocery</span><span class="tag">&lt;/title&gt;</span><span class="pln">
    </span><span class="tag">&lt;meta</span><span class="pln"> </span><span class="atn">http-equiv</span><span class="pun">=</span><span class="atv">"Content-Type"</span><span class="pln"> </span><span class="atn">content</span><span class="pun">=</span><span class="atv">"text/html; charset=UTF-8"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
    </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"stylesheet"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text/css"</span><span class="pln"> </span><span class="atn">media</span><span class="pun">=</span><span class="atv">"all"</span><span class="pln"> 
          </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"../../css/gtvg.css"</span><span class="pln"> </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/css/gtvg.css}"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/head&gt;</span><span class="pln">

  </span><span class="tag">&lt;body&gt;</span><span class="pln">
  
    </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"#{home.welcome}"</span><span class="tag">&gt;</span><span class="pln">Welcome to our grocery store!</span><span class="tag">&lt;/p&gt;</span><span class="pln">
  
  </span><span class="tag">&lt;/body&gt;</span><span class="pln">

</span><span class="tag">&lt;/html&gt;</span></code></pre>
<p>…and this would still be perfectly processable by Thymeleaf in the XHTML mode (although probably our IDE would make our life quite miserable showing warnings everywhere).</p>
<p>But enough about validation. Now for the really interesting part of the template: let’s see what that <code>th:text</code> attribute is about.</p>
<section id="using-thtext-and-externalizing-text" class="level3">
<h3>Using th:text and externalizing text</h3>
<p>Externalizing text is extracting fragments of template code out of template files so that they can be kept in specific separate files (typically <code>.properties</code> files) and that they can be easily substituted by equivalent texts written in other languages (a process called internationalization or simply <em>i18n</em>). Externalized fragments of text are usually called “messages”.</p>
<p>Messages have always a key that identifies them, and Thymeleaf allows you to specify that a text should correspond to a specific message with the <code>#{...}</code> syntax:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"#{home.welcome}"</span><span class="tag">&gt;</span><span class="pln">Welcome to our grocery store!</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>What we can see here are in fact two different features of the Thymeleaf Standard Dialect:</p>
<ul>
<li>The <code>th:text</code> attribute, which evaluates its value expression and sets the result of this evaluation as the body of the tag it is in, effectively substituting that “Welcome to our grocery store!” text we see in the code.</li>
<li>The <code>#{home.welcome}</code> expression, specified in the <em>Standard Expression Syntax</em>, specifying that the text to be used by the <code>th:text</code> attribute should be the message with the <code>home.welcome</code> key corresponding to whichever locale we are processing the template with.</li>
</ul>
<p>Now, where is this externalized text?</p>
<p>The location of externalized text in Thymeleaf is fully configurable, and it will depend on the specific <code>org.thymeleaf.messageresolver.IMessageResolver</code> implementation being used. Normally, an implementation based on <code>.properties</code> files will be used, but we could create our own implementations if we wanted, for example, to obtain messages from a database.</p>
<p>However, we have not specified a message resolver to our Template Engine during initialization, and that means that our application is using the <em>Standard Message Resolver</em>, implemented by class <code>org.thymeleaf.messageresolver.StandardMessageResolver</code>.</p>
<p>This standard message resolver expects to find messages for <code>/WEB-INF/templates/home.html</code> in .properties files in the same folder and with the same name as the template, like:</p>
<ul>
<li><code>/WEB-INF/templates/home_en.properties</code> for English texts.</li>
<li><code>/WEB-INF/templates/home_es.properties</code> for Spanish language texts.</li>
<li><code>/WEB-INF/templates/home_pt_BR.properties</code> for Portuguese (Brazil) language texts.</li>
<li><code>/WEB-INF/templates/home.properties</code> for default texts (if locale is not matched).</li>
</ul>
<p>Let’s have a look at our <code>home_es.properties</code> file:</p>
<pre><code>home.welcome=¡Bienvenido a nuestra tienda de comestibles!</code></pre>
<p>This is all we need for making Thymeleaf process our template. Let’s create our Home controller then.</p>
</section>
<section id="contexts" class="level3">
<h3>Contexts</h3>
<p>In order to process our template, we will create a <code>HomeController</code> class implementing the <code>IGTVGController</code> interface we saw before:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">HomeController</span><span class="pln"> </span><span class="kwd">implements</span><span class="pln"> </span><span class="typ">IGTVGController</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> process</span><span class="pun">(</span><span class="pln">
            </span><span class="typ">HttpServletRequest</span><span class="pln"> request</span><span class="pun">,</span><span class="pln"> </span><span class="typ">HttpServletResponse</span><span class="pln"> response</span><span class="pun">,</span><span class="pln">
            </span><span class="typ">ServletContext</span><span class="pln"> servletContext</span><span class="pun">,</span><span class="pln"> </span><span class="typ">TemplateEngine</span><span class="pln"> templateEngine</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        
        </span><span class="typ">WebContext</span><span class="pln"> ctx </span><span class="pun">=</span><span class="pln"> 
            </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">WebContext</span><span class="pun">(</span><span class="pln">request</span><span class="pun">,</span><span class="pln"> response</span><span class="pun">,</span><span class="pln"> servletContext</span><span class="pun">,</span><span class="pln"> request</span><span class="pun">.</span><span class="pln">getLocale</span><span class="pun">());</span><span class="pln">
        templateEngine</span><span class="pun">.</span><span class="pln">process</span><span class="pun">(</span><span class="str">"home"</span><span class="pun">,</span><span class="pln"> ctx</span><span class="pun">,</span><span class="pln"> response</span><span class="pun">.</span><span class="pln">getWriter</span><span class="pun">());</span><span class="pln">
        
    </span><span class="pun">}</span><span class="pln">

</span><span class="pun">}</span></code></pre>
<p>The first thing we can see here is the creation of a context. A Thymeleaf context is an object implementing the <code>org.thymeleaf.context.IContext</code> interface. Contexts should contain all the data required for an execution of the Template Engine in a variables map, and also reference the Locale that must be used for externalized messages.</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">interface</span><span class="pln"> </span><span class="typ">IContext</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">VariablesMap</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="typ">Object</span><span class="pun">&gt;</span><span class="pln"> getVariables</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">Locale</span><span class="pln"> getLocale</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">...</span><span class="pln">
    
</span><span class="pun">}</span></code></pre>
<p>There is a specialized extension of this interface, <code>org.thymeleaf.context.IWebContext</code>:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">interface</span><span class="pln"> </span><span class="typ">IWebContext</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">IContext</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    
    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">HttpSerlvetRequest</span><span class="pln"> getHttpServletRequest</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">HttpSession</span><span class="pln"> getHttpSession</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">ServletContext</span><span class="pln"> getServletContext</span><span class="pun">();</span><span class="pln">
    
    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">VariablesMap</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="typ">String</span><span class="pun">[]&gt;</span><span class="pln"> getRequestParameters</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">VariablesMap</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="typ">Object</span><span class="pun">&gt;</span><span class="pln"> getRequestAttributes</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">VariablesMap</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="typ">Object</span><span class="pun">&gt;</span><span class="pln"> getSessionAttributes</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">VariablesMap</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="typ">Object</span><span class="pun">&gt;</span><span class="pln"> getApplicationAttributes</span><span class="pun">();</span><span class="pln">
    
</span><span class="pun">}</span></code></pre>
<p>The Thymeleaf core library offers an implementation of each of these interfaces:</p>
<ul>
<li><code>org.thymeleaf.context.Context</code> implements <code>IContext</code></li>
<li><code>org.thymeleaf.context.WebContext</code> implements <code>IWebContext</code></li>
</ul>
<p>And as you can see in the controller code, <code>WebContext</code> is the one we will use. In fact we have to, because the use of a <code>ServletContextTemplateResolver</code> requires that we use a context implementing <code>IWebContext</code>.</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="typ">WebContext</span><span class="pln"> ctx </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">WebContext</span><span class="pun">(</span><span class="pln">request</span><span class="pun">,</span><span class="pln"> servletContext</span><span class="pun">,</span><span class="pln"> request</span><span class="pun">.</span><span class="pln">getLocale</span><span class="pun">());</span></code></pre>
<p>Only two of those three constructor arguments are required, because the default locale for the system will be used if none is specified (although you should never let this happen in real applications).</p>
<p>From the interface definition we can tell that <code>WebContext</code> will offer specialized methods for obtaining the request parameters and request, session and application attributes . But in fact <code>WebContext</code> will do a little bit more than just that:</p>
<ul>
<li>Add all the request attributes to the context variables map.</li>
<li>Add a context variable called <code>param</code> containing all the request parameters.</li>
<li>Add a context variable called <code>session</code> containing all the session attributes.</li>
<li>Add a context variable called <code>application</code> containing all the ServletContext attributes.</li>
</ul>
<p>Just before execution, a special variable is set into all context objects (implementations of <code>IContext</code>), including both <code>Context</code> and <code>WebContext</code>, called the execution info (<code>execInfo</code>). This variable contains two pieces of data that can be used from within your templates:</p>
<ul>
<li>The template name (<code>${execInfo.templateName}</code>), the name specified for engine execution, and corresponding to the template being executed.</li>
<li>The current date and time (<code>${execInfo.now}</code>), a <code>Calendar</code> object corresponding to the moment the template engine started its execution for this template.</li>
</ul>
</section>
<section id="executing-the-template-engine" class="level3">
<h3>Executing the template engine</h3>
<p>With our context object ready, all we need is executing the template engine specifying the template name and the context, and passing on the response writer so that the response can be written to it:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="pln">templateEngine</span><span class="pun">.</span><span class="pln">process</span><span class="pun">(</span><span class="str">"home"</span><span class="pun">,</span><span class="pln"> ctx</span><span class="pun">,</span><span class="pln"> response</span><span class="pun">.</span><span class="pln">getWriter</span><span class="pun">());</span></code></pre>
<p>Let’s see the results of this using the Spanish locale:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="dec">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;</span><span class="pln">

</span><span class="tag">&lt;html</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.w3.org/1999/xhtml"</span><span class="tag">&gt;</span><span class="pln">

  </span><span class="tag">&lt;head&gt;</span><span class="pln">
    </span><span class="tag">&lt;title&gt;</span><span class="pln">Good Thymes Virtual Grocery</span><span class="tag">&lt;/title&gt;</span><span class="pln">
    </span><span class="tag">&lt;meta</span><span class="pln"> </span><span class="atn">content</span><span class="pun">=</span><span class="atv">"text/html; charset=UTF-8"</span><span class="pln"> </span><span class="atn">http-equiv</span><span class="pun">=</span><span class="atv">"Content-Type"</span><span class="tag">/&gt;</span><span class="pln">
    </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"stylesheet"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text/css"</span><span class="pln"> </span><span class="atn">media</span><span class="pun">=</span><span class="atv">"all"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/gtvg/css/gtvg.css"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/head&gt;</span><span class="pln">

  </span><span class="tag">&lt;body&gt;</span><span class="pln">
  
    </span><span class="tag">&lt;p&gt;</span><span class="pln">¡Bienvenido a nuestra tienda de comestibles!</span><span class="tag">&lt;/p&gt;</span><span class="pln">

  </span><span class="tag">&lt;/body&gt;</span><span class="pln">

</span><span class="tag">&lt;/html&gt;</span></code></pre>
</section>
</section>
<section id="more-on-texts-and-variables" class="level2">
<h2>3.2 More on texts and variables</h2>
<section id="unescaped-text" class="level3">
<h3>Unescaped Text</h3>
<p>The simplest version of our Home page seems to be ready now, but there is something we have not thought about… what if we had a message like this?</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="pln">home</span><span class="pun">.</span><span class="pln">welcome</span><span class="pun">=</span><span class="typ">Welcome</span><span class="pln"> to our </span><span class="pun">&lt;</span><span class="pln">b</span><span class="pun">&gt;</span><span class="pln">fantastic</span><span class="pun">&lt;/</span><span class="pln">b</span><span class="pun">&gt;</span><span class="pln"> grocery store</span><span class="pun">!</span></code></pre>
<p>If we execute this template like before, we will obtain:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p&gt;</span><span class="pln">Welcome to our &amp;lt;b&amp;gt;fantastic&amp;lt;/b&amp;gt; grocery store!</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>Which is not exactly what we expected, because our <code>&lt;b&gt;</code> tag has been escaped and therefore it will be displayed at the browser.</p>
<p>This is the default behaviour of the th:text attribute. If we want Thymeleaf to respect our XHTML tags and not escape them, we will have to use a different attribute: <code>th:utext</code> (for “unescaped text”):</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">th:utext</span><span class="pun">=</span><span class="atv">"#{home.welcome}"</span><span class="tag">&gt;</span><span class="pln">Welcome to our grocery store!</span><span class="tag">&lt;/p&gt;</span><span class="pln">
This will output our message just like we wanted it:
</span><span class="tag">&lt;p&gt;</span><span class="pln">Welcome to our </span><span class="tag">&lt;b&gt;</span><span class="pln">fantastic</span><span class="tag">&lt;/b&gt;</span><span class="pln"> grocery store!</span><span class="tag">&lt;/p&gt;</span></code></pre>
</section>
<section id="using-and-displaying-variables" class="level3">
<h3>Using and displaying variables</h3>
<p>Now let’s add some more contents to our home page. For example, we could want to display the date below our welcome message, like this:</p>
<pre><code>Welcome to our fantastic grocery store!

Today is: 12 july 2010</code></pre>
<p>First of all, we will have to modify our controller so that we add that date as a context variable:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> process</span><span class="pun">(</span><span class="pln">
        </span><span class="typ">HttpServletRequest</span><span class="pln"> request</span><span class="pun">,</span><span class="pln"> </span><span class="typ">HttpServletResponse</span><span class="pln"> response</span><span class="pun">,</span><span class="pln">
        </span><span class="typ">ServletContext</span><span class="pln"> servletContext</span><span class="pun">,</span><span class="pln"> </span><span class="typ">TemplateEngine</span><span class="pln"> templateEngine</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        
    </span><span class="typ">SimpleDateFormat</span><span class="pln"> dateFormat </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SimpleDateFormat</span><span class="pun">(</span><span class="str">"dd MMMM yyyy"</span><span class="pun">);</span><span class="pln">
    </span><span class="typ">Calendar</span><span class="pln"> cal </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Calendar</span><span class="pun">.</span><span class="pln">getInstance</span><span class="pun">();</span><span class="pln">
        
    </span><span class="typ">WebContext</span><span class="pln"> ctx </span><span class="pun">=</span><span class="pln"> 
        </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">WebContext</span><span class="pun">(</span><span class="pln">request</span><span class="pun">,</span><span class="pln"> response</span><span class="pun">,</span><span class="pln"> servletContext</span><span class="pun">,</span><span class="pln"> request</span><span class="pun">.</span><span class="pln">getLocale</span><span class="pun">());</span><span class="pln">
    ctx</span><span class="pun">.</span><span class="pln">setVariable</span><span class="pun">(</span><span class="str">"today"</span><span class="pun">,</span><span class="pln"> dateFormat</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">cal</span><span class="pun">.</span><span class="pln">getTime</span><span class="pun">()));</span><span class="pln">
        
    templateEngine</span><span class="pun">.</span><span class="pln">process</span><span class="pun">(</span><span class="str">"home"</span><span class="pun">,</span><span class="pln"> ctx</span><span class="pun">,</span><span class="pln"> response</span><span class="pun">.</span><span class="pln">getWriter</span><span class="pun">());</span><span class="pln">
      
</span><span class="pun">}</span></code></pre>
<p>We have added a <code>String</code> today variable to our context, and now we can display it in our template:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;body&gt;</span><span class="pln">

  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">th:utext</span><span class="pun">=</span><span class="atv">"#{home.welcome}"</span><span class="tag">&gt;</span><span class="pln">Welcome to our grocery store!</span><span class="tag">&lt;/p&gt;</span><span class="pln">

  </span><span class="tag">&lt;p&gt;</span><span class="pln">Today is: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${today}"</span><span class="tag">&gt;</span><span class="pln">13 February 2011</span><span class="tag">&lt;/span&gt;&lt;/p&gt;</span><span class="pln">
  
</span><span class="tag">&lt;/body&gt;</span></code></pre>
<p>As you can see, we are still using the <code>th:text</code> attribute for the job (and that’s correct, because we want to substitute the tag’s body), but the syntax is a little bit different this time and instead of a <code>#{...}</code> expression value, we are using a <code>${...}</code> one. This is a variable expression value, and it contains an expression in a language called <em>OGNL (Object-Graph Navigation Language)</em> that will be executed on the context variables map.</p>
<p>The <code>${today}</code> expression simply means “get the variable called today”, but these expressions could be more complex (like <code>${user.name}</code> for “get the variable called user, and call its <code>getName()</code> method”).</p>
<p>There are quite a lot of possibilities in attribute values: messages, variable expressions… and quite a lot more. Next chapter will show us what all these possibilities are.</p>
</section>
</section>
</section>
<section id="standard-expression-syntax" class="level1">
<h1>4 Standard Expression Syntax</h1>
<p>We will make a small break in the development of our grocery virtual store to learn about one of the most important parts of the Thymeleaf Standard Dialect: the Thymeleaf Standard Expression syntax.</p>
<p>We have already seen two types of valid attribute values expressed in this syntax: message and variable expressions:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">th:utext</span><span class="pun">=</span><span class="atv">"#{home.welcome}"</span><span class="tag">&gt;</span><span class="pln">Welcome to our grocery store!</span><span class="tag">&lt;/p&gt;</span><span class="pln">

</span><span class="tag">&lt;p&gt;</span><span class="pln">Today is: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${today}"</span><span class="tag">&gt;</span><span class="pln">13 february 2011</span><span class="tag">&lt;/span&gt;&lt;/p&gt;</span></code></pre>
<p>But there are more types of value we don’t know yet, and more interesting detail to know about the ones we already know. First, let’s see a quick summary of the Standard Expression features:</p>
<ul>
<li>Simple expressions:
<ul>
<li>Variable Expressions: <code>${...}</code></li>
<li>Selection Variable Expressions: <code>*{...}</code></li>
<li>Message Expressions: <code>#{...}</code></li>
<li>Link URL Expressions: <code>@{...}</code></li>
</ul></li>
<li>Literals
<ul>
<li>Text literals: <code>'one text'</code>, <code>'Another one!'</code>,…</li>
<li>Number literals: <code>0</code>, <code>34</code>, <code>3.0</code>, <code>12.3</code>,…</li>
<li>Boolean literals: <code>true</code>, <code>false</code></li>
<li>Null literal: <code>null</code></li>
<li>Literal tokens: <code>one</code>, <code>sometext</code>, <code>main</code>,…</li>
</ul></li>
<li>Text operations:
<ul>
<li>String concatenation: <code>+</code></li>
<li>Literal substitutions: <code>|The name is ${name}|</code></li>
</ul></li>
<li>Arithmetic operations:
<ul>
<li>Binary operators: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code></li>
<li>Minus sign (unary operator): <code>-</code></li>
</ul></li>
<li>Boolean operations:
<ul>
<li>Binary operators: <code>and</code>, <code>or</code></li>
<li>Boolean negation (unary operator): <code>!</code>, <code>not</code></li>
</ul></li>
<li>Comparisons and equality:
<ul>
<li>Comparators: <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code> (<code>gt</code>, <code>lt</code>, <code>ge</code>, <code>le</code>)</li>
<li>Equality operators: <code>==</code>, <code>!=</code> (<code>eq</code>, <code>ne</code>)</li>
</ul></li>
<li>Conditional operators:
<ul>
<li>If-then: <code>(if) ? (then)</code></li>
<li>If-then-else: <code>(if) ? (then) : (else)</code></li>
<li>Default: <code>(value) ?: (defaultvalue)</code></li>
</ul></li>
</ul>
<p>All these features can be combined and nested:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="pln">'User is of type ' + (${user.isAdmin()} ? 'Administrator' : (${user.type} ?: 'Unknown'))</span></code></pre>
<section id="messages" class="level2">
<h2>4.1 Messages</h2>
<p>As we already know, <code>#{...}</code> message expressions allow us to link this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">th:utext</span><span class="pun">=</span><span class="atv">"#{home.welcome}"</span><span class="tag">&gt;</span><span class="pln">Welcome to our grocery store!</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>…to this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="pln">home.welcome=¡Bienvenido a nuestra tienda de comestibles!</span></code></pre>
<p>But there’s one aspect we still haven’t thought of: what happens if the message text is not completely static? What if, for example, our application knew who is the user visiting the site at any moment and we wanted to greet him/her by name?</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p&gt;</span><span class="pln">¡Bienvenido a nuestra tienda de comestibles, John Apricot!</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>This means we would need to add a parameter to our message. Just like this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="pln">home.welcome=¡Bienvenido a nuestra tienda de comestibles, {0}!</span></code></pre>
<p>Parameters are specified according to the <code>java.text.MessageFormat</code> standard syntax, which means you could add format to numbers and dates as specified in the API docs for that class.</p>
<p>In order to specify a value for our parameter, and given an HTTP session attribute called <code>user</code>, we would have:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">th:utext</span><span class="pun">=</span><span class="atv">"#{home.welcome(${session.user.name})}"</span><span class="tag">&gt;</span><span class="pln">
  Welcome to our grocery store, Sebastian Pepper!
</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>If needed, several parameters could be specified, separated by commas. In fact, the message key itself could come from a variable:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">th:utext</span><span class="pun">=</span><span class="atv">"#{${welcomeMsgKey}(${session.user.name})}"</span><span class="tag">&gt;</span><span class="pln">
  Welcome to our grocery store, Sebastian Pepper!
</span><span class="tag">&lt;/p&gt;</span></code></pre>
</section>
<section id="variables" class="level2">
<h2>4.2 Variables</h2>
<p>We already mentioned that <code>${...}</code> expressions are in fact OGNL (Object-Graph Navigation Language) expressions executed on the map of variables contained in the context.</p>
<blockquote>
<p>For detailed info about OGNL syntax and features, you should read the OGNL Language Guide at: <a href="http://commons.apache.org/ognl/">http://commons.apache.org/ognl/</a></p>
</blockquote>
<p>From OGNL’s syntax, we know that this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p&gt;</span><span class="pln">Today is: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${today}"</span><span class="tag">&gt;</span><span class="pln">13 february 2011</span><span class="tag">&lt;/span&gt;</span><span class="pln">.</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>…is in fact equivalent to this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="pln">ctx</span><span class="pun">.</span><span class="pln">getVariables</span><span class="pun">().</span><span class="pln">get</span><span class="pun">(</span><span class="str">"today"</span><span class="pun">);</span></code></pre>
<p>But OGNL allows us to create quite more powerful expressions, and that’s how this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">th:utext</span><span class="pun">=</span><span class="atv">"#{home.welcome(${session.user.name})}"</span><span class="tag">&gt;</span><span class="pln">
  Welcome to our grocery store, Sebastian Pepper!
</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>…does in fact obtain the user name by executing:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="pun">((</span><span class="typ">User</span><span class="pun">)</span><span class="pln"> ctx</span><span class="pun">.</span><span class="pln">getVariables</span><span class="pun">().</span><span class="pln">get</span><span class="pun">(</span><span class="str">"session"</span><span class="pun">).</span><span class="pln">get</span><span class="pun">(</span><span class="str">"user"</span><span class="pun">)).</span><span class="pln">getName</span><span class="pun">();</span></code></pre>
<p>But getter method navigation is just one of OGNL’s features. Let’s see some more:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">/*
 * Access to properties using the point (.). Equivalent to calling property getters.
 */</span><span class="pln">
$</span><span class="pun">{</span><span class="pln">person</span><span class="pun">.</span><span class="pln">father</span><span class="pun">.</span><span class="pln">name</span><span class="pun">}</span><span class="pln">

</span><span class="com">/*
 * Access to properties can also be made by using brackets ([]) and writing 
 * the name of the property as a variable or between single quotes.
 */</span><span class="pln">
$</span><span class="pun">{</span><span class="pln">person</span><span class="pun">[</span><span class="str">'father'</span><span class="pun">][</span><span class="str">'name'</span><span class="pun">]}</span><span class="pln">

</span><span class="com">/*
 * If the object is a map, both dot and bracket syntax will be equivalent to 
 * executing a call on its get(...) method.
 */</span><span class="pln">
$</span><span class="pun">{</span><span class="pln">countriesByCode</span><span class="pun">.</span><span class="pln">ES</span><span class="pun">}</span><span class="pln">
$</span><span class="pun">{</span><span class="pln">personsByName</span><span class="pun">[</span><span class="str">'Stephen Zucchini'</span><span class="pun">].</span><span class="pln">age</span><span class="pun">}</span><span class="pln">

</span><span class="com">/*
 * Indexed access to arrays or collections is also performed with brackets, 
 * writing the index without quotes.
 */</span><span class="pln">
$</span><span class="pun">{</span><span class="pln">personsArray</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">name</span><span class="pun">}</span><span class="pln">

</span><span class="com">/*
 * Methods can be called, even with arguments.
 */</span><span class="pln">
$</span><span class="pun">{</span><span class="pln">person</span><span class="pun">.</span><span class="pln">createCompleteName</span><span class="pun">()}</span><span class="pln">
$</span><span class="pun">{</span><span class="pln">person</span><span class="pun">.</span><span class="pln">createCompleteNameWithSeparator</span><span class="pun">(</span><span class="str">'-'</span><span class="pun">)}</span></code></pre>
<section id="expression-basic-objects" class="level3">
<h3>Expression Basic Objects</h3>
<p>When evaluating OGNL expressions on the context variables, some objects are made available to expressions for higher flexibility. These objects will be referenced (per OGNL standard) starting with the <code>#</code> symbol:</p>
<ul>
<li><code>#ctx</code>: the context object.</li>
<li><code>#vars:</code> the context variables.</li>
<li><code>#locale</code>: the context locale.</li>
<li><code>#httpServletRequest</code>: (only in Web Contexts) the <code>HttpServletRequest</code> object.</li>
<li><code>#httpSession</code>: (only in Web Contexts) the <code>HttpSession</code> object.</li>
</ul>
<p>So we can do this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="pln">Established locale country: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${#locale.country}"</span><span class="tag">&gt;</span><span class="pln">US</span><span class="tag">&lt;/span&gt;</span><span class="pln">.</span></code></pre>
<p>You can read the full reference of these objects in the <a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#appendix-a-expression-basic-objects">Appendix A</a>.</p>
</section>
<section id="expression-utility-objects" class="level3">
<h3>Expression Utility Objects</h3>
<p>Besides these basic objects, Thymeleaf will offer us a set of utility objects that will help us perform common tasks in our expressions.</p>
<ul>
<li><code>#dates</code>: utility methods for <code>java.util.Date</code> objects: formatting, component extraction, etc.</li>
<li><code>#calendars</code>: analogous to <code>#dates</code>, but for <code>java.util.Calendar</code> objects.</li>
<li><code>#numbers</code>: utility methods for formatting numeric objects.</li>
<li><code>#strings</code>: utility methods for <code>String</code> objects: contains, startsWith, prepending/appending, etc.</li>
<li><code>#objects</code>: utility methods for objects in general.</li>
<li><code>#bools</code>: utility methods for boolean evaluation.</li>
<li><code>#arrays</code>: utility methods for arrays.</li>
<li><code>#lists</code>: utility methods for lists.</li>
<li><code>#sets</code>: utility methods for sets.</li>
<li><code>#maps</code>: utility methods for maps.</li>
<li><code>#aggregates</code>: utility methods for creating aggregates on arrays or collections.</li>
<li><code>#messages</code>: utility methods for obtaining externalized messages inside variables expressions, in the same way as they would be obtained using #{…} syntax.</li>
<li><code>#ids</code>: utility methods for dealing with id attributes that might be repeated (for example, as a result of an iteration).</li>
</ul>
<p>You can check what functions are offered by each of these utility objects in the <a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#appendix-b-expression-utility-objects">Appendix B</a>.</p>
</section>
<section id="reformatting-dates-in-our-home-page" class="level3">
<h3>Reformatting dates in our home page</h3>
<p>Now we know about these utility objects, we could use them to change the way in which we show the date in our home page. Instead of doing this in our <code>HomeController</code>:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="typ">SimpleDateFormat</span><span class="pln"> dateFormat </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SimpleDateFormat</span><span class="pun">(</span><span class="str">"dd MMMM yyyy"</span><span class="pun">);</span><span class="pln">
</span><span class="typ">Calendar</span><span class="pln"> cal </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Calendar</span><span class="pun">.</span><span class="pln">getInstance</span><span class="pun">();</span><span class="pln">

</span><span class="typ">WebContext</span><span class="pln"> ctx </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">WebContext</span><span class="pun">(</span><span class="pln">request</span><span class="pun">,</span><span class="pln"> servletContext</span><span class="pun">,</span><span class="pln"> request</span><span class="pun">.</span><span class="pln">getLocale</span><span class="pun">());</span><span class="pln">
ctx</span><span class="pun">.</span><span class="pln">setVariable</span><span class="pun">(</span><span class="str">"today"</span><span class="pun">,</span><span class="pln"> dateFormat</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">cal</span><span class="pun">.</span><span class="pln">getTime</span><span class="pun">()));</span><span class="pln">

templateEngine</span><span class="pun">.</span><span class="pln">process</span><span class="pun">(</span><span class="str">"home"</span><span class="pun">,</span><span class="pln"> ctx</span><span class="pun">,</span><span class="pln"> response</span><span class="pun">.</span><span class="pln">getWriter</span><span class="pun">());</span></code></pre>
<p>…we can do just this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="typ">WebContext</span><span class="pln"> ctx </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">WebContext</span><span class="pun">(</span><span class="pln">request</span><span class="pun">,</span><span class="pln"> servletContext</span><span class="pun">,</span><span class="pln"> request</span><span class="pun">.</span><span class="pln">getLocale</span><span class="pun">());</span><span class="pln">
ctx</span><span class="pun">.</span><span class="pln">setVariable</span><span class="pun">(</span><span class="str">"today"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Calendar</span><span class="pun">.</span><span class="pln">getInstance</span><span class="pun">());</span><span class="pln">

templateEngine</span><span class="pun">.</span><span class="pln">process</span><span class="pun">(</span><span class="str">"home"</span><span class="pun">,</span><span class="pln"> ctx</span><span class="pun">,</span><span class="pln"> response</span><span class="pun">.</span><span class="pln">getWriter</span><span class="pun">());</span></code></pre>
<p>…and then perform date formatting in the view layer itself:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p&gt;</span><span class="pln">
  Today is: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${#calendars.format(today,'dd MMMM yyyy')}"</span><span class="tag">&gt;</span><span class="pln">13 May 2011</span><span class="tag">&lt;/span&gt;</span><span class="pln">
</span><span class="tag">&lt;/p&gt;</span></code></pre>
</section>
</section>
<section id="expressions-on-selections-asterisk-syntax" class="level2">
<h2>4.3 Expressions on selections (asterisk syntax)</h2>
<p>Variable expressions not only can be written in <code>${...}</code> expressions, but also in <code>*{...}</code> ones.</p>
<p>There is an important difference, though: the asterisk syntax evaluates expressions on selected objects rather than on the whole context variables map. This is: as long as there is no selected object, the dollar and the asterisk syntaxes do exactly the same.</p>
<p>And what is that object selection thing? A <code>th:object</code> attribute. Let’s use it in our user profile (<code>userprofile.html</code>) page:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="pln">  </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:object</span><span class="pun">=</span><span class="atv">"${session.user}"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;p&gt;</span><span class="pln">Name: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"*{firstName}"</span><span class="tag">&gt;</span><span class="pln">Sebastian</span><span class="tag">&lt;/span&gt;</span><span class="pln">.</span><span class="tag">&lt;/p&gt;</span><span class="pln">
    </span><span class="tag">&lt;p&gt;</span><span class="pln">Surname: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"*{lastName}"</span><span class="tag">&gt;</span><span class="pln">Pepper</span><span class="tag">&lt;/span&gt;</span><span class="pln">.</span><span class="tag">&lt;/p&gt;</span><span class="pln">
    </span><span class="tag">&lt;p&gt;</span><span class="pln">Nationality: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"*{nationality}"</span><span class="tag">&gt;</span><span class="pln">Saturn</span><span class="tag">&lt;/span&gt;</span><span class="pln">.</span><span class="tag">&lt;/p&gt;</span><span class="pln">
  </span><span class="tag">&lt;/div&gt;</span></code></pre>
<p>Which is exactly equivalent to:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div&gt;</span><span class="pln">
  </span><span class="tag">&lt;p&gt;</span><span class="pln">Name: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${session.user.firstName}"</span><span class="tag">&gt;</span><span class="pln">Sebastian</span><span class="tag">&lt;/span&gt;</span><span class="pln">.</span><span class="tag">&lt;/p&gt;</span><span class="pln">
  </span><span class="tag">&lt;p&gt;</span><span class="pln">Surname: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${session.user.lastName}"</span><span class="tag">&gt;</span><span class="pln">Pepper</span><span class="tag">&lt;/span&gt;</span><span class="pln">.</span><span class="tag">&lt;/p&gt;</span><span class="pln">
  </span><span class="tag">&lt;p&gt;</span><span class="pln">Nationality: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${session.user.nationality}"</span><span class="tag">&gt;</span><span class="pln">Saturn</span><span class="tag">&lt;/span&gt;</span><span class="pln">.</span><span class="tag">&lt;/p&gt;</span><span class="pln">
</span><span class="tag">&lt;/div&gt;</span></code></pre>
<p>Of course, dollar and asterisk syntax can be mixed:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:object</span><span class="pun">=</span><span class="atv">"${session.user}"</span><span class="tag">&gt;</span><span class="pln">
  </span><span class="tag">&lt;p&gt;</span><span class="pln">Name: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"*{firstName}"</span><span class="tag">&gt;</span><span class="pln">Sebastian</span><span class="tag">&lt;/span&gt;</span><span class="pln">.</span><span class="tag">&lt;/p&gt;</span><span class="pln">
  </span><span class="tag">&lt;p&gt;</span><span class="pln">Surname: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${session.user.lastName}"</span><span class="tag">&gt;</span><span class="pln">Pepper</span><span class="tag">&lt;/span&gt;</span><span class="pln">.</span><span class="tag">&lt;/p&gt;</span><span class="pln">
  </span><span class="tag">&lt;p&gt;</span><span class="pln">Nationality: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"*{nationality}"</span><span class="tag">&gt;</span><span class="pln">Saturn</span><span class="tag">&lt;/span&gt;</span><span class="pln">.</span><span class="tag">&lt;/p&gt;</span><span class="pln">
</span><span class="tag">&lt;/div&gt;</span></code></pre>
<p>When an object selection is in place, the selected object will be also available to dollar expressions as the <code>#object</code> expression variable:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:object</span><span class="pun">=</span><span class="atv">"${session.user}"</span><span class="tag">&gt;</span><span class="pln">
  </span><span class="tag">&lt;p&gt;</span><span class="pln">Name: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${#object.firstName}"</span><span class="tag">&gt;</span><span class="pln">Sebastian</span><span class="tag">&lt;/span&gt;</span><span class="pln">.</span><span class="tag">&lt;/p&gt;</span><span class="pln">
  </span><span class="tag">&lt;p&gt;</span><span class="pln">Surname: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${session.user.lastName}"</span><span class="tag">&gt;</span><span class="pln">Pepper</span><span class="tag">&lt;/span&gt;</span><span class="pln">.</span><span class="tag">&lt;/p&gt;</span><span class="pln">
  </span><span class="tag">&lt;p&gt;</span><span class="pln">Nationality: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"*{nationality}"</span><span class="tag">&gt;</span><span class="pln">Saturn</span><span class="tag">&lt;/span&gt;</span><span class="pln">.</span><span class="tag">&lt;/p&gt;</span><span class="pln">
</span><span class="tag">&lt;/div&gt;</span></code></pre>
<p>As said, if no object selection has been performed, dollar and asterisk syntaxes are exactly equivalent.</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div&gt;</span><span class="pln">
  </span><span class="tag">&lt;p&gt;</span><span class="pln">Name: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"*{session.user.name}"</span><span class="tag">&gt;</span><span class="pln">Sebastian</span><span class="tag">&lt;/span&gt;</span><span class="pln">.</span><span class="tag">&lt;/p&gt;</span><span class="pln">
  </span><span class="tag">&lt;p&gt;</span><span class="pln">Surname: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"*{session.user.surname}"</span><span class="tag">&gt;</span><span class="pln">Pepper</span><span class="tag">&lt;/span&gt;</span><span class="pln">.</span><span class="tag">&lt;/p&gt;</span><span class="pln">
  </span><span class="tag">&lt;p&gt;</span><span class="pln">Nationality: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"*{session.user.nationality}"</span><span class="tag">&gt;</span><span class="pln">Saturn</span><span class="tag">&lt;/span&gt;</span><span class="pln">.</span><span class="tag">&lt;/p&gt;</span><span class="pln">
</span><span class="tag">&lt;/div&gt;</span></code></pre>
</section>
<section id="link-urls" class="level2">
<h2>4.4 Link URLs</h2>
<p>Because of their importance, URLs are first-class citizens in web application templates, and the <em>Thymeleaf Standard Dialect</em> has a special syntax for them, the <code>@</code> syntax: <code>@{...}</code></p>
<p>There are different types of URLs:</p>
<ul>
<li>Absolute URLs, like <code>http://www.thymeleaf.org</code></li>
<li>Relative URLs, which can be:
<ul>
<li>Page-relative, like <code>user/login.html</code></li>
<li>Context-relative, like <code>/itemdetails?id=3</code> (context name in server will be added automatically)</li>
<li>Server-relative, like <code>~/billing/processInvoice</code> (allows calling URLs in another context (= application) in the same server.</li>
<li>Protocol-relative URLs, like <code>//code.jquery.com/jquery-2.0.3.min.js</code></li>
</ul></li>
</ul>
<p>Thymeleaf can handle absolute URLs in any situation, but for relative ones it will require you to use a context object that implements the <code>IWebContext</code> interface, which contains some info coming from the HTTP request and needed to create relative links.</p>
<p>Let’s use this new syntax. Meet the <code>th:href</code> attribute:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="com">&lt;!-- Will produce 'http://localhost:8080/gtvg/order/details?orderId=3' (plus rewriting) --&gt;</span><span class="pln">
</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"details.html"</span><span class="pln"> 
   </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{http://localhost:8080/gtvg/order/details(orderId=${o.id})}"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span><span class="pln">

</span><span class="com">&lt;!-- Will produce '/gtvg/order/details?orderId=3' (plus rewriting) --&gt;</span><span class="pln">
</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"details.html"</span><span class="pln"> </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/order/details(orderId=${o.id})}"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span><span class="pln">

</span><span class="com">&lt;!-- Will produce '/gtvg/order/3/details' (plus rewriting) --&gt;</span><span class="pln">
</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"details.html"</span><span class="pln"> </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/order/{orderId}/details(orderId=${o.id})}"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span></code></pre>
<p>Some things to note here:</p>
<ul>
<li><code>th:href</code> is an attribute modifier attribute: once processed, it will compute the link URL to be used and set the href attribute of the <code>&lt;a&gt;</code> tag to this URL.</li>
<li>We are allowed to use expressions for URL parameters (as you can see in <code>orderId=${o.id}</code>). The required URL-encoding operations will also be automatically performed.</li>
<li>If several parameters are needed, these will be separated by commas like <code>@{/order/process(execId=${execId},execType='FAST')}</code></li>
<li>Variable templates are also allowed in URL paths, like <code>@{/order/{orderId}/details(orderId=${orderId}}}</code></li>
<li>Relative URLs starting with <code>/</code> (like <code>/order/details</code>) will be automatically prefixed the application context name.</li>
<li>If cookies are not enabled or this is not yet known, a <code>";jsessionid=..."</code> suffix might be added to relative URLs so that session is preserved. This is called <em>URL Rewriting</em>, and Thymeleaf allows you to plug in your own rewriting filters by using the <code>response.encodeURL(...)</code> mechanism from the Servlet API for every URL.</li>
<li>The <code>th:href</code> tag allowed us to (optionally) have a working static <code>href</code> attribute in our template, so that our template links remained navigable by a browser when opened directly for prototyping purposes.</li>
</ul>
<p>As was the case with the message syntax (<code>#{...}</code>), URL bases can also be the result of evaluating another expression:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{${url}(orderId=${o.id})}"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span><span class="pln">
</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{'/details/'+${user.login}(orderId=${o.id})}"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span></code></pre>
<section id="a-menu-for-our-home-page" class="level3">
<h3>A menu for our home page</h3>
<p>Now we know how to create link URLs, what about adding a small menu in our home for some of the other pages in the site?</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p&gt;</span><span class="pln">Please select an option</span><span class="tag">&lt;/p&gt;</span><span class="pln">
</span><span class="tag">&lt;ol&gt;</span><span class="pln">
  </span><span class="tag">&lt;li&gt;&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"product/list.html"</span><span class="pln"> </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/product/list}"</span><span class="tag">&gt;</span><span class="pln">Product List</span><span class="tag">&lt;/a&gt;&lt;/li&gt;</span><span class="pln">
  </span><span class="tag">&lt;li&gt;&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"order/list.html"</span><span class="pln"> </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/order/list}"</span><span class="tag">&gt;</span><span class="pln">Order List</span><span class="tag">&lt;/a&gt;&lt;/li&gt;</span><span class="pln">
  </span><span class="tag">&lt;li&gt;&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"subscribe.html"</span><span class="pln"> </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/subscribe}"</span><span class="tag">&gt;</span><span class="pln">Subscribe to our Newsletter</span><span class="tag">&lt;/a&gt;&lt;/li&gt;</span><span class="pln">
  </span><span class="tag">&lt;li&gt;&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"userprofile.html"</span><span class="pln"> </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/userprofile}"</span><span class="tag">&gt;</span><span class="pln">See User Profile</span><span class="tag">&lt;/a&gt;&lt;/li&gt;</span><span class="pln">
</span><span class="tag">&lt;/ol&gt;</span></code></pre>
</section>
</section>
<section id="literals" class="level2">
<h2>4.5 Literals</h2>
<section id="text-literals" class="level3">
<h3>Text literals</h3>
<p>Text literals are just character strings specified between single quotes. They can include any character, but you should escape any single quotes inside them as <code>\'</code>.</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p&gt;</span><span class="pln">
  Now you are looking at a </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"'working web application'"</span><span class="tag">&gt;</span><span class="pln">template file</span><span class="tag">&lt;/span&gt;</span><span class="pln">.
</span><span class="tag">&lt;/p&gt;</span></code></pre>
</section>
<section id="number-literals" class="level3">
<h3>Number literals</h3>
<p>Numeric literals look exactly like what they are: numbers.</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p&gt;</span><span class="pln">The year is </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"2013"</span><span class="tag">&gt;</span><span class="pln">1492</span><span class="tag">&lt;/span&gt;</span><span class="pln">.</span><span class="tag">&lt;/p&gt;</span><span class="pln">
</span><span class="tag">&lt;p&gt;</span><span class="pln">In two years, it will be </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"2013 + 2"</span><span class="tag">&gt;</span><span class="pln">1494</span><span class="tag">&lt;/span&gt;</span><span class="pln">.</span><span class="tag">&lt;/p&gt;</span></code></pre>
</section>
<section id="boolean-literals" class="level3">
<h3>Boolean literals</h3>
<p>The boolean literals are <code>true</code> and <code>false</code>. For example:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:if</span><span class="pun">=</span><span class="atv">"${user.isAdmin()} == false"</span><span class="tag">&gt;</span><span class="pln"> ...</span></code></pre>
<p>Note that in the above example, the <code>== false</code> is written outside the braces, and thus it is Thymeleaf itself who takes care of it. If it were written inside the braces, it would be the responsibility of the OGNL/SpringEL engines:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:if</span><span class="pun">=</span><span class="atv">"${user.isAdmin() == false}"</span><span class="tag">&gt;</span><span class="pln"> ...</span></code></pre>
</section>
<section id="the-null-literal" class="level3">
<h3>The null literal</h3>
<p>The <code>null</code> literal can be also used:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:if</span><span class="pun">=</span><span class="atv">"${variable.something} == null"</span><span class="tag">&gt;</span><span class="pln"> ...</span></code></pre>
</section>
<section id="literal-tokens" class="level3">
<h3>Literal tokens</h3>
<p>Numeric, boolean and null literals are in fact a particular case of <em>literal tokens</em>.</p>
<p>These tokens allow a little bit of simplification in Standard Expressions. They work exactly the same as text literals (<code>'...'</code>), but they only allow letters (<code>A-Z</code> and <code>a-z</code>), numbers (<code>0-9</code>), brackets (<code>[</code> and <code>]</code>), dots (<code>.</code>), hyphens (<code>-</code>) and underscores (<code>_</code>). So no whitespaces, no commas, etc.</p>
<p>The nice part? Tokens don’t need any quotes surrounding them. So we can do this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:class</span><span class="pun">=</span><span class="atv">"content"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/div&gt;</span></code></pre>
<p>instead of:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:class</span><span class="pun">=</span><span class="atv">"'content'"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/div&gt;</span></code></pre>
</section>
</section>
<section id="appending-texts" class="level2">
<h2>4.6 Appending texts</h2>
<p>Texts, no matter whether they are literals or the result of evaluating variable or message expressions, can be easily appended using the <code>+</code> operator:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="pln">th:text="'The name of the user is ' + ${user.name}"</span></code></pre>
</section>
<section id="literal-substitutions" class="level2">
<h2>4.7 Literal substitutions</h2>
<p>Literal substitutions allow the easy formatting of strings containing values from variables without the need to append literals with <code>'...' + '...'</code>.</p>
<p>These substitutions must be surrounded by vertical bars (<code>|</code>), like:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"|Welcome to our application, ${user.name}!|"</span><span class="tag">&gt;</span></code></pre>
<p>Which is actually equivalent to:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"'Welcome to our application, ' + ${user.name} + '!'"</span><span class="tag">&gt;</span></code></pre>
<p>Literal substitutions can be combined with other types of expressions:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${onevar} + ' ' + |${twovar}, ${threevar}|"</span><span class="tag">&gt;</span></code></pre>
<p><strong>Note:</strong> only variable expressions (<code>${...}</code>) are allowed inside <code>|...|</code> literal substitutions. No other literals (<code>'...'</code>), boolean/numeric tokens, conditional expressions etc. are.</p>
</section>
<section id="arithmetic-operations" class="level2">
<h2>4.8 Arithmetic operations</h2>
<p>Some arithmetic operations are also available: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code> and <code>%</code>.</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="pln">th:with="isEven=(${prodStat.count} % 2 == 0)"</span></code></pre>
<p>Note that these operators can also be applied inside OGNL variable expressions themselves (and in that case will be executed by OGNL instead of the Thymeleaf Standard Expression engine):</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="pln">th:with="isEven=${prodStat.count % 2 == 0}"</span></code></pre>
<p>Note that textual aliases exist for some of these operators: <code>div</code> (<code>/</code>), <code>mod</code> (<code>%</code>).</p>
</section>
<section id="comparators-and-equality" class="level2">
<h2>4.9 Comparators and Equality</h2>
<p>Values in expressions can be compared with the <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code> and <code>&lt;=</code> symbols, as usual, and also the <code>==</code> and <code>!=</code> operators can be used to check equality (or the lack of it). Note that XML establishes that the <code>&lt;</code> and <code>&gt;</code> symbols should not be used in attribute values, and so they should be substituted by <code>&amp;lt;</code> and <code>&amp;gt;</code>.</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="pln">th:if="${prodStat.count} &amp;gt; 1"
th:text="'Execution mode is ' + ( (${execMode} == 'dev')? 'Development' : 'Production')"</span></code></pre>
<p>Note that textual aliases exist for some of these operators: <code>gt</code> (<code>&gt;</code>), <code>lt</code> (<code>&lt;</code>), <code>ge</code> (<code>&gt;=</code>), <code>le</code> (<code>&lt;=</code>), <code>not</code> (<code>!</code>). Also <code>eq</code> (<code>==</code>), <code>neq</code>/<code>ne</code> (<code>!=</code>).</p>
</section>
<section id="conditional-expressions" class="level2">
<h2>4.10 Conditional expressions</h2>
<p><em>Conditional expressions</em> are meant to evaluate only one of two expressions depending on the result of evaluating a condition (which is itself another expression).</p>
<p>Let’s have a look at an example fragment (introducing another <em>attribute modifier</em>, this time <code>th:class</code>):</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">th:class</span><span class="pun">=</span><span class="atv">"${row.even}? 'even' : 'odd'"</span><span class="tag">&gt;</span><span class="pln">
  ...
</span><span class="tag">&lt;/tr&gt;</span></code></pre>
<p>All three parts of a conditional expression (<code>condition</code>, <code>then</code> and <code>else</code>) are themselves expressions, which means that they can be variables (<code>${...}</code>, <code>*{...}</code>), messages (<code>#{...}</code>), URLs (<code>@{...}</code>) or literals (<code>'...'</code>).</p>
<p>Conditional expressions can also be nested using parentheses:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">th:class</span><span class="pun">=</span><span class="atv">"${row.even}? (${row.first}? 'first' : 'even') : 'odd'"</span><span class="tag">&gt;</span><span class="pln">
  ...
</span><span class="tag">&lt;/tr&gt;</span></code></pre>
<p>Else expressions can also be omitted, in which case a null value is returned if the condition is false:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">th:class</span><span class="pun">=</span><span class="atv">"${row.even}? 'alt'"</span><span class="tag">&gt;</span><span class="pln">
  ...
</span><span class="tag">&lt;/tr&gt;</span></code></pre>
</section>
<section id="default-expressions-elvis-operator" class="level2">
<h2>4.11 Default expressions (Elvis operator)</h2>
<p>A <em>default expression</em> is a special kind of conditional value without a <em>then</em> part. It is equivalent to the <em>Elvis operator</em> present in some languages like Groovy, and allows to specify two expressions, being the second one evaluated only in the case of the first one returning null.</p>
<p>Let’s see it in action in our user profile page:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:object</span><span class="pun">=</span><span class="atv">"${session.user}"</span><span class="tag">&gt;</span><span class="pln">
  ...
  </span><span class="tag">&lt;p&gt;</span><span class="pln">Age: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"*{age}?: '(no age specified)'"</span><span class="tag">&gt;</span><span class="pln">27</span><span class="tag">&lt;/span&gt;</span><span class="pln">.</span><span class="tag">&lt;/p&gt;</span><span class="pln">
</span><span class="tag">&lt;/div&gt;</span></code></pre>
<p>As you can see, the operator is <code>?:</code>, and we use it here to specify a default value for a name (a literal value, in this case) only if the result of evaluating <code>*{age}</code> is null. This is therefore equivalent to:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p&gt;</span><span class="pln">Age: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"*{age != null}? *{age} : '(no age specified)'"</span><span class="tag">&gt;</span><span class="pln">27</span><span class="tag">&lt;/span&gt;</span><span class="pln">.</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>As with conditional values, they can contain nested expressions between parentheses:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p&gt;</span><span class="pln">
  Name: 
  </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"*{firstName}?: (*{admin}? 'Admin' : #{default.username})"</span><span class="tag">&gt;</span><span class="pln">Sebastian</span><span class="tag">&lt;/span&gt;</span><span class="pln">
</span><span class="tag">&lt;/p&gt;</span></code></pre>
</section>
<section id="preprocessing" class="level2">
<h2>4.12 Preprocessing</h2>
<p>In addition to all these features for expression processing, Thymeleaf offers to us the possibility of <em>preprocessing</em> expressions.</p>
<p>And what is that preprocessing thing? It is an execution of the expressions done before the normal one, that allows the modification of the actual expression that will be eventually executed.</p>
<p>Preprocessed expressions are exactly like normal ones, but appear surrounded by a double underscore symbol (like <code>__${expression}__</code>).</p>
<p>Let’s imagine we have an i18n <code>Messages_fr.properties</code> entry containing an OGNL expression calling a language-specific static method, like:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="pln">article</span><span class="pun">.</span><span class="pln">text</span><span class="pun">=</span><span class="lit">@myapp</span><span class="pun">.</span><span class="pln">translator</span><span class="pun">.</span><span class="typ">Translator@translateToFrench</span><span class="pun">({</span><span class="lit">0</span><span class="pun">})</span></code></pre>
<p>…and a <code>Messages_es.properties equivalent</code>:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="pln">article</span><span class="pun">.</span><span class="pln">text</span><span class="pun">=</span><span class="lit">@myapp</span><span class="pun">.</span><span class="pln">translator</span><span class="pun">.</span><span class="typ">Translator@translateToSpanish</span><span class="pun">({</span><span class="lit">0</span><span class="pun">})</span></code></pre>
<p>We can create a fragment of markup that evaluates one expression or the other depending on the locale. For this, we will first select the expression (by preprocessing) and then let Thymeleaf execute it:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${__#{article.text('textVar')}__}"</span><span class="tag">&gt;</span><span class="pln">Some text here...</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>Note that the preprocessing step for a French locale will be creating the following equivalent:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${@myapp.translator.Translator@translateToFrench(textVar)}"</span><span class="tag">&gt;</span><span class="pln">Some text here...</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>The preprocessing String <code>__</code> can be escaped in attributes using <code>\_\_</code>.</p>
</section>
</section>
<section id="setting-attribute-values" class="level1">
<h1>5 Setting Attribute Values</h1>
<p>This chapter will explain the way in which we can set (or modify) values of attributes in our markup tags, possibly the next most basic feature we will need after setting the tag body content.</p>
<section id="setting-the-value-of-any-attribute" class="level2">
<h2>5.1 Setting the value of any attribute</h2>
<p>Say our website publishes a newsletter, and we want our users to be able to subscribe to it, so we create a <code>/WEB-INF/templates/subscribe.html</code> template with a form:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;form</span><span class="pln"> </span><span class="atn">action</span><span class="pun">=</span><span class="atv">"subscribe.html"</span><span class="tag">&gt;</span><span class="pln">
  </span><span class="tag">&lt;fieldset&gt;</span><span class="pln">
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"email"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"submit"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"Subscribe me!"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/fieldset&gt;</span><span class="pln">
</span><span class="tag">&lt;/form&gt;</span></code></pre>
<p>It looks quite OK, but the fact is that this file looks more like a static XHTML page than a template for a web application. First, the action attribute in our form statically links to the template file itself, so that there is no place for useful URL rewriting. Second, the value attribute in the submit button makes it display a text in English, but we’d like it to be internationalized.</p>
<p>Enter then the <code>th:attr</code> attribute, and its ability to change the value of attributes of the tags it is set in:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;form</span><span class="pln"> </span><span class="atn">action</span><span class="pun">=</span><span class="atv">"subscribe.html"</span><span class="pln"> </span><span class="atn">th:attr</span><span class="pun">=</span><span class="atv">"action=@{/subscribe}"</span><span class="tag">&gt;</span><span class="pln">
  </span><span class="tag">&lt;fieldset&gt;</span><span class="pln">
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"email"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"submit"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"Subscribe me!"</span><span class="pln"> </span><span class="atn">th:attr</span><span class="pun">=</span><span class="atv">"value=#{subscribe.submit}"</span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/fieldset&gt;</span><span class="pln">
</span><span class="tag">&lt;/form&gt;</span></code></pre>
<p>The concept is quite straightforward: <code>th:attr</code> simply takes an expression that assigns a value to an attribute. Having created the corresponding controller and messages files, the result of processing this file will be as expected:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;form</span><span class="pln"> </span><span class="atn">action</span><span class="pun">=</span><span class="atv">"/gtvg/subscribe"</span><span class="tag">&gt;</span><span class="pln">
  </span><span class="tag">&lt;fieldset&gt;</span><span class="pln">
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"email"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"submit"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"¡Suscríbeme!"</span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/fieldset&gt;</span><span class="pln">
</span><span class="tag">&lt;/form&gt;</span></code></pre>
<p>Besides the new attribute values, you can also see that the applicacion context name has been automatically prefixed to the URL base in <code>/gtvg/subscribe</code>, as explained in the previous chapter.</p>
<p>But what if we wanted to set more than one attribute at a time? XML rules do not allow you to set an attribute twice in a tag, so <code>th:attr</code> will take a comma-separated list of assignments, like:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"../../images/gtvglogo.png"</span><span class="pln"> 
     </span><span class="atn">th:attr</span><span class="pun">=</span><span class="atv">"src=@{/images/gtvglogo.png},title=#{logo},alt=#{logo}"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></pre>
<p>Given the required messages files, this will output:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"/gtgv/images/gtvglogo.png"</span><span class="pln"> </span><span class="atn">title</span><span class="pun">=</span><span class="atv">"Logo de Good Thymes"</span><span class="pln"> </span><span class="atn">alt</span><span class="pun">=</span><span class="atv">"Logo de Good Thymes"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></pre>
</section>
<section id="setting-value-to-specific-attributes" class="level2">
<h2>5.2 Setting value to specific attributes</h2>
<p>By now, you might be thinking that something like:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"submit"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"Subscribe me!"</span><span class="pln"> </span><span class="atn">th:attr</span><span class="pun">=</span><span class="atv">"value=#{subscribe.submit}"</span><span class="tag">/&gt;</span></code></pre>
<p>…is quite an ugly piece of markup. Specifying an assignment inside an attribute’s value can be very practical, but it is not the most elegant way of creating templates if you have to do it all the time.</p>
<p>Thymeleaf agrees with you. And that’s why in fact <code>th:attr</code> is scarcely used in templates. Normally, you will be using other <code>th:*</code> attributes whose task is setting specific tag attributes (and not just any attribute like <code>th:attr</code>).</p>
<p>And which attribute does the Standard Dialect offer us for setting the <code>value</code> attribute of our button? Well, in a rather obvious manner, it’s <code>th:value</code>. Let’s have a look:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"submit"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"Subscribe me!"</span><span class="pln"> </span><span class="atn">th:value</span><span class="pun">=</span><span class="atv">"#{subscribe.submit}"</span><span class="tag">/&gt;</span></code></pre>
<p>This looks much better!. Let’s try and do the same to the <code>action</code> attribute in the <code>form</code> tag:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;form</span><span class="pln"> </span><span class="atn">action</span><span class="pun">=</span><span class="atv">"subscribe.html"</span><span class="pln"> </span><span class="atn">th:action</span><span class="pun">=</span><span class="atv">"@{/subscribe}"</span><span class="tag">&gt;</span></code></pre>
<p>And do you remember those <code>th:href</code> we put in our <code>home.html</code> before? They are exactly this same kind of attributes:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;li&gt;&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"product/list.html"</span><span class="pln"> </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/product/list}"</span><span class="tag">&gt;</span><span class="pln">Product List</span><span class="tag">&lt;/a&gt;&lt;/li&gt;</span></code></pre>
<p>There are quite a lot of attributes like these, each of them targeting a specific XHTML or HTML5 attribute:</p>
<table>
  <tbody><tr>
    <td>
<code>th:abbr</code>
</td>
    <td>
<code>th:accept</code>
</td>
    <td>
<code>th:accept-charset</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:accesskey</code>
</td>
    <td>
<code>th:action</code>
</td>
    <td>
<code>th:align</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:alt</code>
</td>
    <td>
<code>th:archive</code>
</td>
    <td>
<code>th:audio</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:autocomplete</code>
</td>
    <td>
<code>th:axis</code>
</td>
    <td>
<code>th:background</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:bgcolor</code>
</td>
    <td>
<code>th:border</code>
</td>
    <td>
<code>th:cellpadding</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:cellspacing</code>
</td>
    <td>
<code>th:challenge</code>
</td>
    <td>
<code>th:charset</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:cite</code>
</td>
    <td>
<code>th:class</code>
</td>
    <td>
<code>th:classid</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:codebase</code>
</td>
    <td>
<code>th:codetype</code>
</td>
    <td>
<code>th:cols</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:colspan</code>
</td>
    <td>
<code>th:compact</code>
</td>
    <td>
<code>th:content</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:contenteditable</code>
</td>
    <td>
<code>th:contextmenu</code>
</td>
    <td>
<code>th:data</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:datetime</code>
</td>
    <td>
<code>th:dir</code>
</td>
    <td>
<code>th:draggable</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:dropzone</code>
</td>
    <td>
<code>th:enctype</code>
</td>
    <td>
<code>th:for</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:form</code>
</td>
    <td>
<code>th:formaction</code>
</td>
    <td>
<code>th:formenctype</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:formmethod</code>
</td>
    <td>
<code>th:formtarget</code>
</td>
    <td>
<code>th:frame</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:frameborder</code>
</td>
    <td>
<code>th:headers</code>
</td>
    <td>
<code>th:height</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:high</code>
</td>
    <td>
<code>th:href</code>
</td>
    <td>
<code>th:hreflang</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:hspace</code>
</td>
    <td>
<code>th:http-equiv</code>
</td>
    <td>
<code>th:icon</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:id</code>
</td>
    <td>
<code>th:keytype</code>
</td>
    <td>
<code>th:kind</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:label</code>
</td>
    <td>
<code>th:lang</code>
</td>
    <td>
<code>th:list</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:longdesc</code>
</td>
    <td>
<code>th:low</code>
</td>
    <td>
<code>th:manifest</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:marginheight</code>
</td>
    <td>
<code>th:marginwidth</code>
</td>
    <td>
<code>th:max</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:maxlength</code>
</td>
    <td>
<code>th:media</code>
</td>
    <td>
<code>th:method</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:min</code>
</td>
    <td>
<code>th:name</code>
</td>
    <td>
<code>th:optimum</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:pattern</code>
</td>
    <td>
<code>th:placeholder</code>
</td>
    <td>
<code>th:poster</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:preload</code>
</td>
    <td>
<code>th:radiogroup</code>
</td>
    <td>
<code>th:rel</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:rev</code>
</td>
    <td>
<code>th:rows</code>
</td>
    <td>
<code>th:rowspan</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:rules</code>
</td>
    <td>
<code>th:sandbox</code>
</td>
    <td>
<code>th:scheme</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:scope</code>
</td>
    <td>
<code>th:scrolling</code>
</td>
    <td>
<code>th:size</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:sizes</code>
</td>
    <td>
<code>th:span</code>
</td>
    <td>
<code>th:spellcheck</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:src</code>
</td>
    <td>
<code>th:srclang</code>
</td>
    <td>
<code>th:standby</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:start</code>
</td>
    <td>
<code>th:step</code>
</td>
    <td>
<code>th:style</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:summary</code>
</td>
    <td>
<code>th:tabindex</code>
</td>
    <td>
<code>th:target</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:title</code>
</td>
    <td>
<code>th:type</code>
</td>
    <td>
<code>th:usemap</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:value</code>
</td>
    <td>
<code>th:valuetype</code>
</td>
    <td>
<code>th:vspace</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:width</code>
</td>
    <td>
<code>th:wrap</code>
</td>
    <td>
<code>th:xmlbase</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:xmllang</code>
</td>
    <td>
<code>th:xmlspace</code>
</td>
    <td></td>
  </tr>
</tbody></table>



</section>
<section id="setting-more-than-one-value-at-a-time" class="level2">
<h2>5.3 Setting more than one value at a time</h2>
<p>There are two rather special attributes called <code>th:alt-title</code> and <code>th:lang-xmllang</code> which can be used for setting two attributes to the same value at the same time. Specifically:</p>
<ul>
<li><code>th:alt-title</code> will set <code>alt</code> and <code>title</code>.</li>
<li><code>th:lang-xmllang</code> will set <code>lang</code> and <code>xml:lang</code>.</li>
</ul>
<p>For our GTVG home page, this will allow us to substitute this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"../../images/gtvglogo.png"</span><span class="pln"> 
     </span><span class="atn">th:attr</span><span class="pun">=</span><span class="atv">"src=@{/images/gtvglogo.png},title=#{logo},alt=#{logo}"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></pre>
<p>…or this, which is equivalent:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"../../images/gtvglogo.png"</span><span class="pln"> 
     </span><span class="atn">th:src</span><span class="pun">=</span><span class="atv">"@{/images/gtvglogo.png}"</span><span class="pln"> </span><span class="atn">th:title</span><span class="pun">=</span><span class="atv">"#{logo}"</span><span class="pln"> </span><span class="atn">th:alt</span><span class="pun">=</span><span class="atv">"#{logo}"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></pre>
<p>…by this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"../../images/gtvglogo.png"</span><span class="pln"> 
     </span><span class="atn">th:src</span><span class="pun">=</span><span class="atv">"@{/images/gtvglogo.png}"</span><span class="pln"> </span><span class="atn">th:alt-title</span><span class="pun">=</span><span class="atv">"#{logo}"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></pre>
</section>
<section id="appending-and-prepending" class="level2">
<h2>5.4 Appending and prepending</h2>
<p>Working in an equivalent way to <code>th:attr</code>, Thymeleaf offers the <code>th:attrappend</code> and <code>th:attrprepend</code> attributes, which append (suffix) or prepend (prefix) the result of their evaluation to the existing attribute values.</p>
<p>For example, you might want to store the name of a CSS class to be added (not set, just added) to one of your buttons in a context variable, because the specific CSS class to be used would depend on something that the user did before. Easy:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"button"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"Do it!"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"btn"</span><span class="pln"> </span><span class="atn">th:attrappend</span><span class="pun">=</span><span class="atv">"class=${' ' + cssStyle}"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></pre>
<p>If you process this template with the <code>cssStyle</code> variable set to <code>"warning"</code>, you will get:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"button"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"Do it!"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"btn warning"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></pre>
<p>There are also two specific <em>appending attributes</em> in the Standard Dialect: the <code>th:classappend</code> and <code>th:styleappend</code> attributes, which are used for adding a CSS class or a fragment of <em>style</em> to an element without overwriting the existing ones:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">th:each</span><span class="pun">=</span><span class="atv">"prod : ${prods}"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"row"</span><span class="pln"> </span><span class="atn">th:classappend</span><span class="pun">=</span><span class="atv">"${prodStat.odd}? 'odd'"</span><span class="tag">&gt;</span></code></pre>
<p>(Don’t worry about that <code>th:each</code> attribute. It is an <em>iterating attribute</em> and we will talk about it later.)</p>
</section>
<section id="fixed-value-boolean-attributes" class="level2">
<h2>5.5 Fixed-value boolean attributes</h2>
<p>Some XHTML/HTML5 attributes are special in that, either they are present in their elements with a specific and fixed value, or they are not present at all.</p>
<p>For example, <code>checked</code>:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"checkbox"</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"option1"</span><span class="pln"> </span><span class="atn">checked</span><span class="pun">=</span><span class="atv">"checked"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
</span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"checkbox"</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"option2"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></pre>
<p>No other value than <code>"checked"</code> is allowed according to the XHTML standards for the <code>checked</code> attribute (HTML5 rules are a little more relaxed on that). And the same happens with <code>disabled</code>, <code>multiple</code>, <code>readonly</code> and <code>selected</code>.</p>
<p>The Standard Dialect includes attributes that allow you to set these attributes by evaluating a condition, so that if evaluated to true, the attribute will be set to its fixed value, and if evaluated to false, the attribute will not be set:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"checkbox"</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"active"</span><span class="pln"> </span><span class="atn">th:checked</span><span class="pun">=</span><span class="atv">"${user.active}"</span><span class="pln"> </span><span class="tag">/&gt;</span></code></pre>
<p>The following fixed-value boolean attributes exist in the Standard Dialect:</p>
<table>
  <tbody><tr>
    <td>
<code>th:async</code>
</td>
    <td>
<code>th:autofocus</code>
</td>
    <td>
<code>th:autoplay</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:checked</code>
</td>
    <td>
<code>th:controls</code>
</td>
    <td>
<code>th:declare</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:default</code>
</td>
    <td>
<code>th:defer</code>
</td>
    <td>
<code>th:disabled</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:formnovalidate</code>
</td>
    <td>
<code>th:hidden</code>
</td>
    <td>
<code>th:ismap</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:loop</code>
</td>
    <td>
<code>th:multiple</code>
</td>
    <td>
<code>th:novalidate</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:nowrap</code>
</td>
    <td>
<code>th:open</code>
</td>
    <td>
<code>th:pubdate</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:readonly</code>
</td>
    <td>
<code>th:required</code>
</td>
    <td>
<code>th:reversed</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:scoped</code>
</td>
    <td>
<code>th:seamless</code>
</td>
    <td>
<code>th:selected</code>
</td>
  </tr>
</tbody></table>



</section>
<section id="support-for-html5-friendly-attribute-and-element-names" class="level2">
<h2>5.6 Support for HTML5-friendly attribute and element names</h2>
<p>It is also possible to use a completely different syntax to apply processors to your templates, more HTML5-friendly.</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;table&gt;</span><span class="pln">
    </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">data-th-each</span><span class="pun">=</span><span class="atv">"user : ${users}"</span><span class="tag">&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">data-th-text</span><span class="pun">=</span><span class="atv">"${user.login}"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/td&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">data-th-text</span><span class="pun">=</span><span class="atv">"${user.name}"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
</span><span class="tag">&lt;/table&gt;</span></code></pre>
<p>The <code>data-{prefix}-{name}</code> syntax is the standard way to write custom attributes in HTML5, without requiring developers to use any namespaced names like <code>th:*</code>. Thymeleaf makes this syntax automatically available to all your dialects (not only the Standard ones).</p>
<p>There is also a syntax to specify custom tags: <code>{prefix}-{name}</code>, which follows the <em>W3C Custom Elements specification</em> (a part of the larger <em>W3C Web Components spec</em>). This can be used, for example, for the <code>th:block</code> element (or also <code>th-block</code>), which will be explained in a later section.</p>
<p><strong>Important:</strong> this syntax is an addition to the namespaced <code>th:*</code> one, it does not replace it. There is no intention at all to deprecate the namespaced syntax in the future.</p>
</section>
</section>
<section id="iteration" class="level1">
<h1>6 Iteration</h1>
<p>So far we have created a home page, a user profile page and also a page for letting users subscribe to our newsletter… but what about our products? Shouldn’t we build a product list to let visitors know what we sell? Well, obviously yes. And there we go now.</p>
<section id="iteration-basics" class="level2">
<h2>6.1 Iteration basics</h2>
<p>For listing our products in our <code>/WEB-INF/templates/product/list.html</code> page we will need a table. Each of our products will be displayed in a row (a <code>&lt;tr&gt;</code> element), and so for our template we will need to create a <em>template row</em> —one that will exemplify how we want each product to be displayed— and then instruct Thymeleaf to <em>iterate it</em> once for each product.</p>
<p>The Standard Dialect offers us an attribute for exactly that, <code>th:each</code>.</p>
<section id="using-theach" class="level3">
<h3>Using th:each</h3>
<p>For our product list page, we will need a controller that retrieves the list of products from the service layer and adds it to the template context:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> process</span><span class="pun">(</span><span class="pln">
        </span><span class="typ">HttpServletRequest</span><span class="pln"> request</span><span class="pun">,</span><span class="pln"> </span><span class="typ">HttpServletResponse</span><span class="pln"> response</span><span class="pun">,</span><span class="pln">
        </span><span class="typ">ServletContext</span><span class="pln"> servletContext</span><span class="pun">,</span><span class="pln"> </span><span class="typ">TemplateEngine</span><span class="pln"> templateEngine</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="typ">ProductService</span><span class="pln"> productService </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ProductService</span><span class="pun">();</span><span class="pln">
    </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Product</span><span class="pun">&gt;</span><span class="pln"> allProducts </span><span class="pun">=</span><span class="pln"> productService</span><span class="pun">.</span><span class="pln">findAll</span><span class="pun">();</span><span class="pln"> 

    </span><span class="typ">WebContext</span><span class="pln"> ctx </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">WebContext</span><span class="pun">(</span><span class="pln">request</span><span class="pun">,</span><span class="pln"> servletContext</span><span class="pun">,</span><span class="pln"> request</span><span class="pun">.</span><span class="pln">getLocale</span><span class="pun">());</span><span class="pln">
    ctx</span><span class="pun">.</span><span class="pln">setVariable</span><span class="pun">(</span><span class="str">"prods"</span><span class="pun">,</span><span class="pln"> allProducts</span><span class="pun">);</span><span class="pln">

    templateEngine</span><span class="pun">.</span><span class="pln">process</span><span class="pun">(</span><span class="str">"product/list"</span><span class="pun">,</span><span class="pln"> ctx</span><span class="pun">,</span><span class="pln"> response</span><span class="pun">.</span><span class="pln">getWriter</span><span class="pun">());</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<p>And then we will use <code>th:each</code> in our template to iterate the list of products:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="dec">&lt;!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd"&gt;</span><span class="pln">

</span><span class="tag">&lt;html</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.w3.org/1999/xhtml"</span><span class="pln">
      </span><span class="atn">xmlns:th</span><span class="pun">=</span><span class="atv">"http://www.thymeleaf.org"</span><span class="tag">&gt;</span><span class="pln">

  </span><span class="tag">&lt;head&gt;</span><span class="pln">
    </span><span class="tag">&lt;title&gt;</span><span class="pln">Good Thymes Virtual Grocery</span><span class="tag">&lt;/title&gt;</span><span class="pln">
    </span><span class="tag">&lt;meta</span><span class="pln"> </span><span class="atn">http-equiv</span><span class="pun">=</span><span class="atv">"Content-Type"</span><span class="pln"> </span><span class="atn">content</span><span class="pun">=</span><span class="atv">"text/html; charset=UTF-8"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
    </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"stylesheet"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text/css"</span><span class="pln"> </span><span class="atn">media</span><span class="pun">=</span><span class="atv">"all"</span><span class="pln"> 
          </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"../../../css/gtvg.css"</span><span class="pln"> </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/css/gtvg.css}"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/head&gt;</span><span class="pln">

  </span><span class="tag">&lt;body&gt;</span><span class="pln">

    </span><span class="tag">&lt;h1&gt;</span><span class="pln">Product list</span><span class="tag">&lt;/h1&gt;</span><span class="pln">
  
    </span><span class="tag">&lt;table&gt;</span><span class="pln">
      </span><span class="tag">&lt;tr&gt;</span><span class="pln">
        </span><span class="tag">&lt;th&gt;</span><span class="pln">NAME</span><span class="tag">&lt;/th&gt;</span><span class="pln">
        </span><span class="tag">&lt;th&gt;</span><span class="pln">PRICE</span><span class="tag">&lt;/th&gt;</span><span class="pln">
        </span><span class="tag">&lt;th&gt;</span><span class="pln">IN STOCK</span><span class="tag">&lt;/th&gt;</span><span class="pln">
      </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
      </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">th:each</span><span class="pun">=</span><span class="atv">"prod : ${prods}"</span><span class="tag">&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.name}"</span><span class="tag">&gt;</span><span class="pln">Onions</span><span class="tag">&lt;/td&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.price}"</span><span class="tag">&gt;</span><span class="pln">2.41</span><span class="tag">&lt;/td&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.inStock}? #{true} : #{false}"</span><span class="tag">&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
      </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;/table&gt;</span><span class="pln">
  
    </span><span class="tag">&lt;p&gt;</span><span class="pln">
      </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"../home.html"</span><span class="pln"> </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/}"</span><span class="tag">&gt;</span><span class="pln">Return to home</span><span class="tag">&lt;/a&gt;</span><span class="pln">
    </span><span class="tag">&lt;/p&gt;</span><span class="pln">

  </span><span class="tag">&lt;/body&gt;</span><span class="pln">

</span><span class="tag">&lt;/html&gt;</span></code></pre>
<p>That <code>prod : ${prods}</code> attribute value you see above means “for each element in the result of evaluating <code>${prods}</code>, repeat this fragment of template setting that element into a variable called prod”. Let’s give a name each of the things we see:</p>
<ul>
<li>We will call <code>${prods}</code> the <em>iterated expression</em> or <em>iterated variable</em>.</li>
<li>We will call <code>prod</code> the <em>iteration variable</em> or simply <em>iter variable</em>.</li>
</ul>
<p>Note that the <code>prod</code> iter variable will only be available inside the <code>&lt;tr&gt;</code> element (including inner tags like <code>&lt;td&gt;</code>).</p>
</section>
<section id="iterable-values" class="level3">
<h3>Iterable values</h3>
<p>Not only <code>java.util.List</code> objects can be used for iteration in Thymeleaf. In fact, there is a quite complete set of objects that are considered <em>iterable</em> by a <code>th:each</code> attribute:</p>
<ul>
<li>Any object implementing <code>java.util.Iterable</code></li>
<li>Any object implementing <code>java.util.Map</code>. When iterating maps, iter variables will be of class <code>java.util.Map.Entry</code>.</li>
<li>Any array</li>
<li>Any other object will be treated as if it were a single-valued list containing the object itself.</li>
</ul>
</section>
</section>
<section id="keeping-iteration-status" class="level2">
<h2>6.2 Keeping iteration status</h2>
<p>When using <code>th:each,</code> Thymeleaf offers a mechanism useful for keeping track of the status of your iteration: the <em>status variable</em>.</p>
<p>Status variables are defined within a <code>th:each</code> attribute and contain the following data:</p>
<ul>
<li>The current <em>iteration index</em>, starting with 0. This is the <code>index</code> property.</li>
<li>The current <em>iteration index</em>, starting with 1. This is the <code>count</code> property.</li>
<li>The total amount of elements in the iterated variable. This is the <code>size</code> property.</li>
<li>The <em>iter variable</em> for each iteration. This is the <code>current</code> property.</li>
<li>Whether the current iteration is even or odd. These are the <code>even/odd</code> boolean properties.</li>
<li>Whether the current iteration is the first one. This is the <code>first</code> boolean property.</li>
<li>Whether the current iteration is the last one. This is the <code>last</code> boolean property.</li>
</ul>
<p>Let’s see how we could use it within the previous example:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;table&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">NAME</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">PRICE</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">IN STOCK</span><span class="tag">&lt;/th&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">th:each</span><span class="pun">=</span><span class="atv">"prod,iterStat : ${prods}"</span><span class="pln"> </span><span class="atn">th:class</span><span class="pun">=</span><span class="atv">"${iterStat.odd}? 'odd'"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.name}"</span><span class="tag">&gt;</span><span class="pln">Onions</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.price}"</span><span class="tag">&gt;</span><span class="pln">2.41</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.inStock}? #{true} : #{false}"</span><span class="tag">&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
</span><span class="tag">&lt;/table&gt;</span></code></pre>
<p>As you can see, the status variable (<code>iterStat</code> in this example) is defined in the <code>th:each</code> attribute by writing its name after the iter variable itself, separated by a comma. As happens to the iter variable, the status variable will only be available inside the fragment of code defined by the tag holding the <code>th:each</code> attribute.</p>
<p>Let’s have a look at the result of processing our template:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="dec">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;</span><span class="pln">

</span><span class="tag">&lt;html</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.w3.org/1999/xhtml"</span><span class="tag">&gt;</span><span class="pln">

  </span><span class="tag">&lt;head&gt;</span><span class="pln">
    </span><span class="tag">&lt;title&gt;</span><span class="pln">Good Thymes Virtual Grocery</span><span class="tag">&lt;/title&gt;</span><span class="pln">
    </span><span class="tag">&lt;meta</span><span class="pln"> </span><span class="atn">content</span><span class="pun">=</span><span class="atv">"text/html; charset=UTF-8"</span><span class="pln"> </span><span class="atn">http-equiv</span><span class="pun">=</span><span class="atv">"Content-Type"</span><span class="tag">/&gt;</span><span class="pln">
    </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"stylesheet"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text/css"</span><span class="pln"> </span><span class="atn">media</span><span class="pun">=</span><span class="atv">"all"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/gtvg/css/gtvg.css"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/head&gt;</span><span class="pln">

  </span><span class="tag">&lt;body&gt;</span><span class="pln">

    </span><span class="tag">&lt;h1&gt;</span><span class="pln">Product list</span><span class="tag">&lt;/h1&gt;</span><span class="pln">
  
    </span><span class="tag">&lt;table&gt;</span><span class="pln">
      </span><span class="tag">&lt;tr&gt;</span><span class="pln">
        </span><span class="tag">&lt;th</span><span class="pln"> </span><span class="atn">colspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="pln"> </span><span class="atn">rowspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="tag">&gt;</span><span class="pln">NAME</span><span class="tag">&lt;/th&gt;</span><span class="pln">
        </span><span class="tag">&lt;th</span><span class="pln"> </span><span class="atn">colspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="pln"> </span><span class="atn">rowspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="tag">&gt;</span><span class="pln">PRICE</span><span class="tag">&lt;/th&gt;</span><span class="pln">
        </span><span class="tag">&lt;th</span><span class="pln"> </span><span class="atn">colspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="pln"> </span><span class="atn">rowspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="tag">&gt;</span><span class="pln">IN STOCK</span><span class="tag">&lt;/th&gt;</span><span class="pln">
      </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
      </span><span class="tag">&lt;tr&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">colspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="pln"> </span><span class="atn">rowspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="tag">&gt;</span><span class="pln">Fresh Sweet Basil</span><span class="tag">&lt;/td&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">colspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="pln"> </span><span class="atn">rowspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="tag">&gt;</span><span class="pln">4.99</span><span class="tag">&lt;/td&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">colspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="pln"> </span><span class="atn">rowspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="tag">&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
      </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
      </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"odd"</span><span class="tag">&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">colspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="pln"> </span><span class="atn">rowspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="tag">&gt;</span><span class="pln">Italian Tomato</span><span class="tag">&lt;/td&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">colspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="pln"> </span><span class="atn">rowspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="tag">&gt;</span><span class="pln">1.25</span><span class="tag">&lt;/td&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">colspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="pln"> </span><span class="atn">rowspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="tag">&gt;</span><span class="pln">no</span><span class="tag">&lt;/td&gt;</span><span class="pln">
      </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
      </span><span class="tag">&lt;tr&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">colspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="pln"> </span><span class="atn">rowspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="tag">&gt;</span><span class="pln">Yellow Bell Pepper</span><span class="tag">&lt;/td&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">colspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="pln"> </span><span class="atn">rowspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="tag">&gt;</span><span class="pln">2.50</span><span class="tag">&lt;/td&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">colspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="pln"> </span><span class="atn">rowspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="tag">&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
      </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
      </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"odd"</span><span class="tag">&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">colspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="pln"> </span><span class="atn">rowspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="tag">&gt;</span><span class="pln">Old Cheddar</span><span class="tag">&lt;/td&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">colspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="pln"> </span><span class="atn">rowspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="tag">&gt;</span><span class="pln">18.75</span><span class="tag">&lt;/td&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">colspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="pln"> </span><span class="atn">rowspan</span><span class="pun">=</span><span class="atv">"1"</span><span class="tag">&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
      </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;/table&gt;</span><span class="pln">
  
    </span><span class="tag">&lt;p&gt;</span><span class="pln">
      </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/gtvg/"</span><span class="pln"> </span><span class="atn">shape</span><span class="pun">=</span><span class="atv">"rect"</span><span class="tag">&gt;</span><span class="pln">Return to home</span><span class="tag">&lt;/a&gt;</span><span class="pln">
    </span><span class="tag">&lt;/p&gt;</span><span class="pln">

  </span><span class="tag">&lt;/body&gt;</span><span class="pln">
  
</span><span class="tag">&lt;/html&gt;</span></code></pre>
<p>Note that our iteration status variable has worked perfectly, establishing the <code>odd</code> CSS class only to odd rows (row counting starts with 0).</p>
<blockquote>
<p>All those colspan and rowspan attributes in the <code>&lt;td&gt;</code> tags, as well as the shape one in <code>&lt;a&gt;</code> are automatically added by Thymeleaf in accordance with the DTD for the selected <em>XHTML 1.0 Strict</em> standard, that establishes those values as default for those attributes (remember that our template didn’t set a value for them). Don’t worry about them at all, because they will not affect the display of your page. As an example, if we were using HTML5 (which has no DTD), those attributes would never be added.</p>
</blockquote>
<p>If you don’t explicitly set an iteration variable, Thymeleaf will always create one for you by suffixing <code>Stat</code> to the name of the iter variable:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;table&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">NAME</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">PRICE</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">IN STOCK</span><span class="tag">&lt;/th&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">th:each</span><span class="pun">=</span><span class="atv">"prod : ${prods}"</span><span class="pln"> </span><span class="atn">th:class</span><span class="pun">=</span><span class="atv">"${prodStat.odd}? 'odd'"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.name}"</span><span class="tag">&gt;</span><span class="pln">Onions</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.price}"</span><span class="tag">&gt;</span><span class="pln">2.41</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.inStock}? #{true} : #{false}"</span><span class="tag">&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
</span><span class="tag">&lt;/table&gt;</span></code></pre>
</section>
</section>
<section id="conditional-evaluation" class="level1">
<h1>7 Conditional Evaluation</h1>
<section id="simple-conditionals-if-and-unless" class="level2">
<h2>7.1 Simple conditionals: “if” and “unless”</h2>
<p>Sometimes you will need a fragment of your template only to appear in the result if a certain condition is met.</p>
<p>For example, imagine we want to show in our product table a column with the number of comments that exist for each product and, if there are any comments, a link to the comment detail page for that product.</p>
<p>In order to do this, we would use the <code>th:if</code> attribute:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;table&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">NAME</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">PRICE</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">IN STOCK</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">COMMENTS</span><span class="tag">&lt;/th&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">th:each</span><span class="pun">=</span><span class="atv">"prod : ${prods}"</span><span class="pln"> </span><span class="atn">th:class</span><span class="pun">=</span><span class="atv">"${prodStat.odd}? 'odd'"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.name}"</span><span class="tag">&gt;</span><span class="pln">Onions</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.price}"</span><span class="tag">&gt;</span><span class="pln">2.41</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.inStock}? #{true} : #{false}"</span><span class="tag">&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">
      </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${#lists.size(prod.comments)}"</span><span class="tag">&gt;</span><span class="pln">2</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
      </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"comments.html"</span><span class="pln"> 
         </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/product/comments(prodId=${prod.id})}"</span><span class="pln"> 
         </span><span class="atn">th:if</span><span class="pun">=</span><span class="atv">"${not #lists.isEmpty(prod.comments)}"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span><span class="pln">
    </span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
</span><span class="tag">&lt;/table&gt;</span></code></pre>
<p>Quite a lot of things to see here, so let’s focus on the important line:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"comments.html"</span><span class="pln">
   </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/product/comments(prodId=${prod.id})}"</span><span class="pln"> 
   </span><span class="atn">th:if</span><span class="pun">=</span><span class="atv">"${not #lists.isEmpty(prod.comments)}"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span></code></pre>
<p>There is little to explain from this code, in fact: We will be creating a link to the comments page (with URL <code>/product/comments</code>) with a <code>prodId</code> parameter set to the <code>id</code> of the product, but only if the product has any comments.</p>
<p>Let’s have a look at the resulting markup (getting rid of the defaulted <code>rowspan</code> and <code>colspan</code> attributes for a cleaner view):</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;table&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">NAME</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">PRICE</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">IN STOCK</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">COMMENTS</span><span class="tag">&lt;/th&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">Fresh Sweet Basil</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">4.99</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">
      </span><span class="tag">&lt;span&gt;</span><span class="pln">0</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
    </span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"odd"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">Italian Tomato</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">1.25</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">no</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">
      </span><span class="tag">&lt;span&gt;</span><span class="pln">2</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
      </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/gtvg/product/comments?prodId=2"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span><span class="pln">
    </span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">Yellow Bell Pepper</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">2.50</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">
      </span><span class="tag">&lt;span&gt;</span><span class="pln">0</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
    </span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"odd"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">Old Cheddar</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">18.75</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">
      </span><span class="tag">&lt;span&gt;</span><span class="pln">1</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
      </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/gtvg/product/comments?prodId=4"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span><span class="pln">
    </span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
</span><span class="tag">&lt;/table&gt;</span></code></pre>
<p>Perfect! That’s exactly what we wanted.</p>
<p>Note that the <code>th:if</code> attribute will not only evaluate <em>boolean</em> conditions. Its capabilities go a little beyond that, and it will evaluate the specified expression as <code>true</code> following these rules:</p>
<ul>
<li>If value is not null:
<ul>
<li>If value is a boolean and is <code>true</code>.</li>
<li>If value is a number and is non-zero</li>
<li>If value is a character and is non-zero</li>
<li>If value is a String and is not “false”, “off” or “no”</li>
<li>If value is not a boolean, a number, a character or a String.</li>
</ul></li>
<li>(If value is null, th:if will evaluate to false).</li>
</ul>
<p>Also, <code>th:if</code> has a negative counterpart, <code>th:unless</code>, which we could have used in the previous example instead of using a <code>not</code> inside the OGNL expression:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"comments.html"</span><span class="pln">
   </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/comments(prodId=${prod.id})}"</span><span class="pln"> 
   </span><span class="atn">th:unless</span><span class="pun">=</span><span class="atv">"${#lists.isEmpty(prod.comments)}"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span></code></pre>
</section>
<section id="switch-statements" class="level2">
<h2>7.2 Switch statements</h2>
<p>There is also a way to display content conditionally using the equivalent of a <em>switch</em> structure in Java: the <code>th:switch</code> / <code>th:case</code> attribute set.</p>
<p>They work exactly as you would expect:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:switch</span><span class="pun">=</span><span class="atv">"${user.role}"</span><span class="tag">&gt;</span><span class="pln">
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">th:case</span><span class="pun">=</span><span class="atv">"'admin'"</span><span class="tag">&gt;</span><span class="pln">User is an administrator</span><span class="tag">&lt;/p&gt;</span><span class="pln">
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">th:case</span><span class="pun">=</span><span class="atv">"#{roles.manager}"</span><span class="tag">&gt;</span><span class="pln">User is a manager</span><span class="tag">&lt;/p&gt;</span><span class="pln">
</span><span class="tag">&lt;/div&gt;</span></code></pre>
<p>Note that as soon as one <code>th:case</code> attribute is evaluated as <code>true</code>, every other <code>th:case</code> attribute in the same switch context is evaluated as <code>false</code>.</p>
<p>The default option is specified as <code>th:case="*"</code>:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:switch</span><span class="pun">=</span><span class="atv">"${user.role}"</span><span class="tag">&gt;</span><span class="pln">
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">th:case</span><span class="pun">=</span><span class="atv">"'admin'"</span><span class="tag">&gt;</span><span class="pln">User is an administrator</span><span class="tag">&lt;/p&gt;</span><span class="pln">
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">th:case</span><span class="pun">=</span><span class="atv">"#{roles.manager}"</span><span class="tag">&gt;</span><span class="pln">User is a manager</span><span class="tag">&lt;/p&gt;</span><span class="pln">
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">th:case</span><span class="pun">=</span><span class="atv">"*"</span><span class="tag">&gt;</span><span class="pln">User is some other thing</span><span class="tag">&lt;/p&gt;</span><span class="pln">
</span><span class="tag">&lt;/div&gt;</span></code></pre>
</section>
</section>
<section id="template-layout" class="level1">
<h1>8 Template Layout</h1>
<section id="including-template-fragments" class="level2">
<h2>8.1 Including template fragments</h2>
<section id="defining-and-referencing-fragments" class="level3">
<h3>Defining and referencing fragments</h3>
<p>We will often want to include in our templates fragments from other templates. Common uses for this are footers, headers, menus…</p>
<p>In order to do this, Thymeleaf needs us to define the fragments available for inclusion, which we can do by using the <code>th:fragment</code> attribute.</p>
<p>Now let’s say we want to add a standard copyright footer to all our grocery pages, and for that we define a <code>/WEB-INF/templates/footer.html</code> file containing this code:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="dec">&lt;!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd"&gt;</span><span class="pln">

</span><span class="tag">&lt;html</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.w3.org/1999/xhtml"</span><span class="pln">
      </span><span class="atn">xmlns:th</span><span class="pun">=</span><span class="atv">"http://www.thymeleaf.org"</span><span class="tag">&gt;</span><span class="pln">

  </span><span class="tag">&lt;body&gt;</span><span class="pln">
  
    </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:fragment</span><span class="pun">=</span><span class="atv">"copy"</span><span class="tag">&gt;</span><span class="pln">
      &amp;copy; 2011 The Good Thymes Virtual Grocery
    </span><span class="tag">&lt;/div&gt;</span><span class="pln">
  
  </span><span class="tag">&lt;/body&gt;</span><span class="pln">
  
</span><span class="tag">&lt;/html&gt;</span></code></pre>
<p>The code above defines a fragment called <code>copy</code> that we can easily include in our home page using one of the <code>th:include</code> or <code>th:replace</code> attributes:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;body&gt;</span><span class="pln">

  ...

  </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:include</span><span class="pun">=</span><span class="atv">"footer :: copy"</span><span class="tag">&gt;&lt;/div&gt;</span><span class="pln">
  
</span><span class="tag">&lt;/body&gt;</span></code></pre>
<p>The syntax for both these inclusion attributes is quite straightforward. There are three different formats:</p>
<ul>
<li><code>"templatename::domselector"</code> or the equivalent <code>templatename::[domselector]</code> Includes the fragment resulting from executing the specified DOM Selector on the template named <code>templatename</code>.
<ul>
<li>Note that <code>domselector</code> can be a mere fragment name, so you could specify something as simple as <code>templatename::fragmentname</code> like in the <code>footer :: copy</code> above.</li>
</ul></li>
</ul>
<blockquote>
<p>DOM Selector syntax is similar to XPath expressions and CSS selectors, see the <a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#appendix-c-dom-selector-syntax">Appendix C</a> for more info on this syntax.</p>
</blockquote>
<ul>
<li><code>"templatename"</code> Includes the complete template named <code>templatename</code>.</li>
</ul>
<blockquote>
<p>Note that the template name you use in <code>th:include</code>/<code>th:replace</code> tags will have to be resolvable by the Template Resolver currently being used by the Template Engine.</p>
</blockquote>
<ul>
<li><code>::domselector"</code> or <code>"this::domselector"</code> Includes a fragment from the same template.</li>
</ul>
<p>Both <code>templatename</code> and <code>domselector</code> in the above examples can be fully-featured expressions (even conditionals!) like:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:include</span><span class="pun">=</span><span class="atv">"footer :: (${user.isAdmin}? #{footer.admin} : #{footer.normaluser})"</span><span class="tag">&gt;&lt;/div&gt;</span></code></pre>
<p>Fragments can include any <code>th:* attributes</code>. These attributes will be evaluated once the fragment is included into the target template (the one with the <code>th:include</code>/<code>th:replace</code> attribute), and they will be able to reference any context variables defined in this target template.</p>
<blockquote>
<p>A big advantage of this approach to fragments is that you can write your fragments’ code in pages that are perfectly displayable by a browser, with a complete and even validating XHTML structure, while still retaining the ability to make Thymeleaf include them into other templates.</p>
</blockquote>
</section>
<section id="referencing-fragments-without-thfragment" class="level3">
<h3>Referencing fragments without <code>th:fragment</code></h3>
<p>Besides, thanks to the power of DOM Selectors, we can include fragments that do not use any <code>th:fragment</code> attributes. It can even be markup code coming from a different application with no knowledge of Thymeleaf at all:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="pln">...
</span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"copy-section"</span><span class="tag">&gt;</span><span class="pln">
  &amp;copy; 2011 The Good Thymes Virtual Grocery
</span><span class="tag">&lt;/div&gt;</span><span class="pln">
...</span></code></pre>
<p>We can use the fragment above simply referencing it by its <code>id</code> attribute, in a similar way to a CSS selector:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;body&gt;</span><span class="pln">

  ...

  </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:include</span><span class="pun">=</span><span class="atv">"footer :: #copy-section"</span><span class="tag">&gt;&lt;/div&gt;</span><span class="pln">
  
</span><span class="tag">&lt;/body&gt;</span></code></pre>
</section>
<section id="difference-between-thinclude-and-threplace" class="level3">
<h3>Difference between <code>th:include</code> and <code>th:replace</code></h3>
<p>And what is the difference between <code>th:include</code> and <code>th:replace</code>? Whereas <code>th:include</code> will include the contents of the fragment into its host tag, <code>th:replace</code> will actually substitute the host tag by the fragment’s. So that an HTML5 fragment like this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;footer</span><span class="pln"> </span><span class="atn">th:fragment</span><span class="pun">=</span><span class="atv">"copy"</span><span class="tag">&gt;</span><span class="pln">
  &amp;copy; 2011 The Good Thymes Virtual Grocery
</span><span class="tag">&lt;/footer&gt;</span></code></pre>
<p>…included twice in host <code>&lt;div&gt;</code> tags, like this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;body&gt;</span><span class="pln">

  ...

  </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:include</span><span class="pun">=</span><span class="atv">"footer :: copy"</span><span class="tag">&gt;&lt;/div&gt;</span><span class="pln">
  </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:replace</span><span class="pun">=</span><span class="atv">"footer :: copy"</span><span class="tag">&gt;&lt;/div&gt;</span><span class="pln">
  
</span><span class="tag">&lt;/body&gt;</span></code></pre>
<p>…will result in:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;body&gt;</span><span class="pln">

  ...

  </span><span class="tag">&lt;div&gt;</span><span class="pln">
    &amp;copy; 2011 The Good Thymes Virtual Grocery
  </span><span class="tag">&lt;/div&gt;</span><span class="pln">
  </span><span class="tag">&lt;footer&gt;</span><span class="pln">
    &amp;copy; 2011 The Good Thymes Virtual Grocery
  </span><span class="tag">&lt;/footer&gt;</span><span class="pln">
  
</span><span class="tag">&lt;/body&gt;</span></code></pre>
<p>The <code>th:substituteby</code> attribute can also be used as an alias for <code>th:replace</code>, but the latter is recommended. Note that <code>th:substituteby</code> might be deprecated in future versions.</p>
</section>
</section>
<section id="parameterizable-fragment-signatures" class="level2">
<h2>8.2 Parameterizable fragment signatures</h2>
<p>In order to create a more <em>function-like</em> mechanism for the use of template fragments, fragments defined with <code>th:fragment</code> can specify a set of parameters:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:fragment</span><span class="pun">=</span><span class="atv">"frag (onevar,twovar)"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${onevar} + ' - ' + ${twovar}"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/p&gt;</span><span class="pln">
</span><span class="tag">&lt;/div&gt;</span></code></pre>
<p>This requires the use of one of these two syntaxes to call the fragment from <code>th:include</code>, <code>th:replace</code>:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:include</span><span class="pun">=</span><span class="atv">"::frag (${value1},${value2})"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/div&gt;</span><span class="pln">
</span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:include</span><span class="pun">=</span><span class="atv">"::frag (onevar=${value1},twovar=${value2})"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/div&gt;</span></code></pre>
<p>Note that order is not important in the last option:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:include</span><span class="pun">=</span><span class="atv">"::frag (twovar=${value2},onevar=${value1})"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/div&gt;</span></code></pre>
<section id="fragment-local-variables-without-fragment-signature" class="level3">
<h3>Fragment local variables without fragment signature</h3>
<p>Even if fragments are defined without signature, like this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:fragment</span><span class="pun">=</span><span class="atv">"frag"</span><span class="tag">&gt;</span><span class="pln">
    ...
</span><span class="tag">&lt;/div&gt;</span></code></pre>
<p>We could use the second syntax specified above to call them (and only the second one):</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:include</span><span class="pun">=</span><span class="atv">"::frag (onevar=${value1},twovar=${value2})"</span><span class="tag">&gt;</span></code></pre>
<p>This would be, in fact, equivalent to a combination of <code>th:include</code> and <code>th:with</code>:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:include</span><span class="pun">=</span><span class="atv">"::frag"</span><span class="pln"> </span><span class="atn">th:with</span><span class="pun">=</span><span class="atv">"onevar=${value1},twovar=${value2}"</span><span class="tag">&gt;</span></code></pre>
<p><strong>Note</strong> that this specification of local variables for a fragment —no matter whether it has a signature or not— does not cause the context to emptied previously to its execution. Fragments will still be able to access every context variable being used at the calling template like they currently are.</p>
</section>
<section id="thassert-for-in-template-assertions" class="level3">
<h3>th:assert for in-template assertions</h3>
<p>The <code>th:assert</code> attribute can specify a comma-separated list of expressions which should be evaluated and produce true for every evaluation, raising an exception if not.</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:assert</span><span class="pun">=</span><span class="atv">"${onevar},(${twovar} != 43)"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/div&gt;</span></code></pre>
<p>This comes in handy for validating parameters at a fragment signature:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;header</span><span class="pln"> </span><span class="atn">th:fragment</span><span class="pun">=</span><span class="atv">"contentheader(title)"</span><span class="pln"> </span><span class="atn">th:assert</span><span class="pun">=</span><span class="atv">"${!#strings.isEmpty(title)}"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/header&gt;</span></code></pre>
</section>
</section>
<section id="removing-template-fragments" class="level2">
<h2>8.3 Removing template fragments</h2>
<p>Let’s revisit the last version of our product list template:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;table&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">NAME</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">PRICE</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">IN STOCK</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">COMMENTS</span><span class="tag">&lt;/th&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">th:each</span><span class="pun">=</span><span class="atv">"prod : ${prods}"</span><span class="pln"> </span><span class="atn">th:class</span><span class="pun">=</span><span class="atv">"${prodStat.odd}? 'odd'"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.name}"</span><span class="tag">&gt;</span><span class="pln">Onions</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.price}"</span><span class="tag">&gt;</span><span class="pln">2.41</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.inStock}? #{true} : #{false}"</span><span class="tag">&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">
      </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${#lists.size(prod.comments)}"</span><span class="tag">&gt;</span><span class="pln">2</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
      </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"comments.html"</span><span class="pln"> 
         </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/product/comments(prodId=${prod.id})}"</span><span class="pln"> 
         </span><span class="atn">th:unless</span><span class="pun">=</span><span class="atv">"${#lists.isEmpty(prod.comments)}"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span><span class="pln">
    </span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
</span><span class="tag">&lt;/table&gt;</span></code></pre>
<p>This code is just fine as a template, but as a static page (when directly open by a browser without Thymeleaf processing it) it would not make a nice prototype.</p>
<p>Why? Because although perfectly displayable by browsers, that table only has a row, and this row has mock data. As a prototype, it simply wouldn’t look realistic enough… we should have more than one product, <em>we need more rows</em>.</p>
<p>So let’s add some:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;table&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">NAME</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">PRICE</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">IN STOCK</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">COMMENTS</span><span class="tag">&lt;/th&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">th:each</span><span class="pun">=</span><span class="atv">"prod : ${prods}"</span><span class="pln"> </span><span class="atn">th:class</span><span class="pun">=</span><span class="atv">"${prodStat.odd}? 'odd'"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.name}"</span><span class="tag">&gt;</span><span class="pln">Onions</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.price}"</span><span class="tag">&gt;</span><span class="pln">2.41</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.inStock}? #{true} : #{false}"</span><span class="tag">&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">
      </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${#lists.size(prod.comments)}"</span><span class="tag">&gt;</span><span class="pln">2</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
      </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"comments.html"</span><span class="pln"> 
         </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/product/comments(prodId=${prod.id})}"</span><span class="pln"> 
         </span><span class="atn">th:unless</span><span class="pun">=</span><span class="atv">"${#lists.isEmpty(prod.comments)}"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span><span class="pln">
    </span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"odd"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">Blue Lettuce</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">9.55</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">no</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">
      </span><span class="tag">&lt;span&gt;</span><span class="pln">0</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
    </span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">Mild Cinnamon</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">1.99</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">
      </span><span class="tag">&lt;span&gt;</span><span class="pln">3</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
      </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"comments.html"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span><span class="pln">
    </span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
</span><span class="tag">&lt;/table&gt;</span></code></pre>
<p>Ok, now we have three, definitely better for a prototype. But… what will happen when we process it with Thymeleaf?:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;table&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">NAME</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">PRICE</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">IN STOCK</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">COMMENTS</span><span class="tag">&lt;/th&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">Fresh Sweet Basil</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">4.99</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">
      </span><span class="tag">&lt;span&gt;</span><span class="pln">0</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
    </span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"odd"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">Italian Tomato</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">1.25</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">no</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">
      </span><span class="tag">&lt;span&gt;</span><span class="pln">2</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
      </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/gtvg/product/comments?prodId=2"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span><span class="pln">
    </span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">Yellow Bell Pepper</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">2.50</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">
      </span><span class="tag">&lt;span&gt;</span><span class="pln">0</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
    </span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"odd"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">Old Cheddar</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">18.75</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">
      </span><span class="tag">&lt;span&gt;</span><span class="pln">1</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
      </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/gtvg/product/comments?prodId=4"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span><span class="pln">
    </span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"odd"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">Blue Lettuce</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">9.55</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">no</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">
      </span><span class="tag">&lt;span&gt;</span><span class="pln">0</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
    </span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">Mild Cinnamon</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">1.99</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">
      </span><span class="tag">&lt;span&gt;</span><span class="pln">3</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
      </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"comments.html"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span><span class="pln">
    </span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
</span><span class="tag">&lt;/table&gt;</span></code></pre>
<p>The last two rows are mock rows! Well, of course they are: iteration was only applied to the first row, so there is no reason why Thymeleaf should have removed the other two.</p>
<p>We need a way to remove those two rows during template processing. Let’s use the <code>th:remove</code> attribute on the second and third <code>&lt;tr&gt;</code> tags:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;table&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">NAME</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">PRICE</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">IN STOCK</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">COMMENTS</span><span class="tag">&lt;/th&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">th:each</span><span class="pun">=</span><span class="atv">"prod : ${prods}"</span><span class="pln"> </span><span class="atn">th:class</span><span class="pun">=</span><span class="atv">"${prodStat.odd}? 'odd'"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.name}"</span><span class="tag">&gt;</span><span class="pln">Onions</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.price}"</span><span class="tag">&gt;</span><span class="pln">2.41</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.inStock}? #{true} : #{false}"</span><span class="tag">&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">
      </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${#lists.size(prod.comments)}"</span><span class="tag">&gt;</span><span class="pln">2</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
      </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"comments.html"</span><span class="pln"> 
         </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/product/comments(prodId=${prod.id})}"</span><span class="pln"> 
         </span><span class="atn">th:unless</span><span class="pun">=</span><span class="atv">"${#lists.isEmpty(prod.comments)}"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span><span class="pln">
    </span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"odd"</span><span class="pln"> </span><span class="atn">th:remove</span><span class="pun">=</span><span class="atv">"all"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">Blue Lettuce</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">9.55</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">no</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">
      </span><span class="tag">&lt;span&gt;</span><span class="pln">0</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
    </span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">th:remove</span><span class="pun">=</span><span class="atv">"all"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">Mild Cinnamon</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">1.99</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">
      </span><span class="tag">&lt;span&gt;</span><span class="pln">3</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
      </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"comments.html"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span><span class="pln">
    </span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
</span><span class="tag">&lt;/table&gt;</span></code></pre>
<p>Once processed, everything will look again as it should:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;table&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">NAME</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">PRICE</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">IN STOCK</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;th&gt;</span><span class="pln">COMMENTS</span><span class="tag">&lt;/th&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">Fresh Sweet Basil</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">4.99</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">
      </span><span class="tag">&lt;span&gt;</span><span class="pln">0</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
    </span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"odd"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">Italian Tomato</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">1.25</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">no</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">
      </span><span class="tag">&lt;span&gt;</span><span class="pln">2</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
      </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/gtvg/product/comments?prodId=2"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span><span class="pln">
    </span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">Yellow Bell Pepper</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">2.50</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">
      </span><span class="tag">&lt;span&gt;</span><span class="pln">0</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
    </span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"odd"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">Old Cheddar</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">18.75</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;td&gt;</span><span class="pln">
      </span><span class="tag">&lt;span&gt;</span><span class="pln">1</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
      </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/gtvg/product/comments?prodId=4"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span><span class="pln">
    </span><span class="tag">&lt;/td&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
</span><span class="tag">&lt;/table&gt;</span></code></pre>
<p>And what about that <code>all</code> value in the attribute, what does it mean? Well, in fact <code>th:remove</code> can behave in three different ways, depending on its value:</p>
<ul>
<li><code>all</code>: Remove both the containing tag and all its children.</li>
<li><code>body</code>: Do not remove the containing tag, but remove all its children.</li>
<li><code>tag</code>: Remove the containing tag, but do not remove its children.</li>
<li><code>all-but-first</code>: Remove all children of the containing tag except the first one.</li>
<li><code>none</code> : Do nothing. This value is useful for dynamic evaluation.</li>
</ul>
<p>What can that <code>all-but-first</code> value be useful for? It will let us save some <code>th:remove="all"</code> when prototyping:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;table&gt;</span><span class="pln">
  </span><span class="tag">&lt;thead&gt;</span><span class="pln">
    </span><span class="tag">&lt;tr&gt;</span><span class="pln">
      </span><span class="tag">&lt;th&gt;</span><span class="pln">NAME</span><span class="tag">&lt;/th&gt;</span><span class="pln">
      </span><span class="tag">&lt;th&gt;</span><span class="pln">PRICE</span><span class="tag">&lt;/th&gt;</span><span class="pln">
      </span><span class="tag">&lt;th&gt;</span><span class="pln">IN STOCK</span><span class="tag">&lt;/th&gt;</span><span class="pln">
      </span><span class="tag">&lt;th&gt;</span><span class="pln">COMMENTS</span><span class="tag">&lt;/th&gt;</span><span class="pln">
    </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;/thead&gt;</span><span class="pln">
  </span><span class="tag">&lt;tbody</span><span class="pln"> </span><span class="atn">th:remove</span><span class="pun">=</span><span class="atv">"all-but-first"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">th:each</span><span class="pun">=</span><span class="atv">"prod : ${prods}"</span><span class="pln"> </span><span class="atn">th:class</span><span class="pun">=</span><span class="atv">"${prodStat.odd}? 'odd'"</span><span class="tag">&gt;</span><span class="pln">
      </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.name}"</span><span class="tag">&gt;</span><span class="pln">Onions</span><span class="tag">&lt;/td&gt;</span><span class="pln">
      </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.price}"</span><span class="tag">&gt;</span><span class="pln">2.41</span><span class="tag">&lt;/td&gt;</span><span class="pln">
      </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${prod.inStock}? #{true} : #{false}"</span><span class="tag">&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
      </span><span class="tag">&lt;td&gt;</span><span class="pln">
        </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${#lists.size(prod.comments)}"</span><span class="tag">&gt;</span><span class="pln">2</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
        </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"comments.html"</span><span class="pln"> 
           </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/product/comments(prodId=${prod.id})}"</span><span class="pln"> 
           </span><span class="atn">th:unless</span><span class="pun">=</span><span class="atv">"${#lists.isEmpty(prod.comments)}"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span><span class="pln">
      </span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"odd"</span><span class="tag">&gt;</span><span class="pln">
      </span><span class="tag">&lt;td&gt;</span><span class="pln">Blue Lettuce</span><span class="tag">&lt;/td&gt;</span><span class="pln">
      </span><span class="tag">&lt;td&gt;</span><span class="pln">9.55</span><span class="tag">&lt;/td&gt;</span><span class="pln">
      </span><span class="tag">&lt;td&gt;</span><span class="pln">no</span><span class="tag">&lt;/td&gt;</span><span class="pln">
      </span><span class="tag">&lt;td&gt;</span><span class="pln">
        </span><span class="tag">&lt;span&gt;</span><span class="pln">0</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
      </span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;tr&gt;</span><span class="pln">
      </span><span class="tag">&lt;td&gt;</span><span class="pln">Mild Cinnamon</span><span class="tag">&lt;/td&gt;</span><span class="pln">
      </span><span class="tag">&lt;td&gt;</span><span class="pln">1.99</span><span class="tag">&lt;/td&gt;</span><span class="pln">
      </span><span class="tag">&lt;td&gt;</span><span class="pln">yes</span><span class="tag">&lt;/td&gt;</span><span class="pln">
      </span><span class="tag">&lt;td&gt;</span><span class="pln">
        </span><span class="tag">&lt;span&gt;</span><span class="pln">3</span><span class="tag">&lt;/span&gt;</span><span class="pln"> comment/s
        </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"comments.html"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span><span class="pln">
      </span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;/tbody&gt;</span><span class="pln">
</span><span class="tag">&lt;/table&gt;</span></code></pre>
<p>The <code>th:remove</code> attribute can take any <em>Thymeleaf Standard Expression</em>, as long as it returns one of the allowed String values (<code>all</code>, <code>tag</code>, <code>body</code>, <code>all-but-first</code> or <code>none</code>).</p>
<p>This means removals could be conditional, like:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/something"</span><span class="pln"> </span><span class="atn">th:remove</span><span class="pun">=</span><span class="atv">"${condition}? tag : none"</span><span class="tag">&gt;</span><span class="pln">Link text not to be removed</span><span class="tag">&lt;/a&gt;</span></code></pre>
<p>Also note that <code>th:remove</code> considers <code>null</code> a synonym to <code>none</code>, so that the following works exactly as the example above:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/something"</span><span class="pln"> </span><span class="atn">th:remove</span><span class="pun">=</span><span class="atv">"${condition}? tag"</span><span class="tag">&gt;</span><span class="pln">Link text not to be removed</span><span class="tag">&lt;/a&gt;</span></code></pre>
<p>In this case, if <code>${condition}</code> is false, <code>null</code> will be returned, and thus no removal will be performed.</p>
</section>
</section>
<section id="local-variables" class="level1">
<h1>9 Local Variables</h1>
<p>Thymeleaf calls <em>local variables</em> those variables that are defined for a specific fragment of a template, and are only available for evaluation inside that fragment.</p>
<p>An example we have already seen is the <code>prod</code> iter variable in our product list page:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">th:each</span><span class="pun">=</span><span class="atv">"prod : ${prods}"</span><span class="tag">&gt;</span><span class="pln">
    ...
</span><span class="tag">&lt;/tr&gt;</span></code></pre>
<p>That <code>prod</code> variable will be available only within the bonds of the <code>&lt;tr&gt;</code> tag. Specifically:</p>
<ul>
<li>It will be available for any other <code>th:*</code> attributes executing in that tag with less <em>precedence</em> than <code>th:each</code> (which means they will execute after <code>th:each</code>).</li>
<li>It will be available for any child element of the <code>&lt;tr&gt;</code> tag, such as <code>&lt;td&gt;</code> elements.</li>
</ul>
<p>Thymeleaf offers you a way to declare local variables without iteration. It is the <code>th:with</code> attribute, and its syntax is like that of attribute value assignments:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:with</span><span class="pun">=</span><span class="atv">"firstPer=${persons[0]}"</span><span class="tag">&gt;</span><span class="pln">
  </span><span class="tag">&lt;p&gt;</span><span class="pln">
    The name of the first person is </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${firstPer.name}"</span><span class="tag">&gt;</span><span class="pln">Julius Caesar</span><span class="tag">&lt;/span&gt;</span><span class="pln">.
  </span><span class="tag">&lt;/p&gt;</span><span class="pln">
</span><span class="tag">&lt;/div&gt;</span></code></pre>
<p>When <code>th:with</code> is processed, that <code>firstPer</code> variable is created as a local variable and added to the variables map coming from the context, so that it is as available for evaluation as any other variables declared in the context from the beginning, but only within the bounds of the containing <code>&lt;div&gt;</code> tag.</p>
<p>You can define several variables at the same time using the usual multiple assignment syntax:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:with</span><span class="pun">=</span><span class="atv">"firstPer=${persons[0]},secondPer=${persons[1]}"</span><span class="tag">&gt;</span><span class="pln">
  </span><span class="tag">&lt;p&gt;</span><span class="pln">
    The name of the first person is </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${firstPer.name}"</span><span class="tag">&gt;</span><span class="pln">Julius Caesar</span><span class="tag">&lt;/span&gt;</span><span class="pln">.
  </span><span class="tag">&lt;/p&gt;</span><span class="pln">
  </span><span class="tag">&lt;p&gt;</span><span class="pln">
    But the name of the second person is 
    </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${secondPer.name}"</span><span class="tag">&gt;</span><span class="pln">Marcus Antonius</span><span class="tag">&lt;/span&gt;</span><span class="pln">.
  </span><span class="tag">&lt;/p&gt;</span><span class="pln">
</span><span class="tag">&lt;/div&gt;</span></code></pre>
<p>The <code>th:with</code> attribute allows reusing variables defined in the same attribute:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:with</span><span class="pun">=</span><span class="atv">"company=${user.company + ' Co.'},account=${accounts[company]}"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/div&gt;</span></code></pre>
<p>Let’s use this in our Grocery’s home page! Remember the code we wrote for outputting a formatted date?</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p&gt;</span><span class="pln">
  Today is: 
  </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${#calendars.format(today,'dd MMMM yyyy')}"</span><span class="tag">&gt;</span><span class="pln">13 february 2011</span><span class="tag">&lt;/span&gt;</span><span class="pln">
</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>Well, what if we wanted that <code>"dd MMMM yyyy"</code> to actually depend on the locale? For example, we might want to add the following message to our <code>home_en.properties</code>:</p>
<pre><code>date.format=MMMM dd'','' yyyy</code></pre>
<p>…and an equivalent one to our <code>home_es.properties</code>:</p>
<pre><code>date.format=dd ''de'' MMMM'','' yyyy</code></pre>
<p>Now, let’s use <code>th:with</code> to get the localized date format into a variable, and then use it in our <code>th:text</code> expression:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">th:with</span><span class="pun">=</span><span class="atv">"df=#{date.format}"</span><span class="tag">&gt;</span><span class="pln">
  Today is: </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${#calendars.format(today,df)}"</span><span class="tag">&gt;</span><span class="pln">13 February 2011</span><span class="tag">&lt;/span&gt;</span><span class="pln">
</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>That was clean and easy. In fact, given the fact that <code>th:with</code> has a higher <code>precedence</code> than <code>th:text</code>, we could have solved this all in the <code>span</code> tag:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p&gt;</span><span class="pln">
  Today is: 
  </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:with</span><span class="pun">=</span><span class="atv">"df=#{date.format}"</span><span class="pln"> 
        </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${#calendars.format(today,df)}"</span><span class="tag">&gt;</span><span class="pln">13 February 2011</span><span class="tag">&lt;/span&gt;</span><span class="pln">
</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>You might be thinking: Precedence? We haven’t talked about that yet! Well, don’t worry because that is exactly what the next chapter is about.</p>
</section>
<section id="attribute-precedence" class="level1">
<h1>10 Attribute Precedence</h1>
<p>What happens when you write more than one <code>th:*</code> attribute in the same tag? For example:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;ul&gt;</span><span class="pln">
  </span><span class="tag">&lt;li</span><span class="pln"> </span><span class="atn">th:each</span><span class="pun">=</span><span class="atv">"item : ${items}"</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${item.description}"</span><span class="tag">&gt;</span><span class="pln">Item description here...</span><span class="tag">&lt;/li&gt;</span><span class="pln">
</span><span class="tag">&lt;/ul&gt;</span></code></pre>
<p>Of course, we would expect that <code>th:each</code> attribute to execute before the <code>th:text</code> so that we get the results we want, but given the fact that the DOM (Document Object Model) standard does not give any kind of meaning to the order in which the attributes of a tag are written, a <em>precedence</em> mechanism has to be established in the attributes themselves in order to be sure that this will work as expected.</p>
<p>So, all Thymeleaf attributes define a numeric precedence, which establishes the order in which they are executed in the tag. This order is:</p>
<table>
  <thead>
    <tr><th>
Order
</th>
    <th>
Feature
</th>
    <th>
Attributes
</th>
  </tr></thead>
  <tbody>
    <tr>
      <td>
1
</td>
      <td>
Fragment inclusion
</td>
      <td>
        
<code>th:include</code><br> <code>th:replace</code>
</td>
    </tr>
    <tr>
      <td>
2
</td>
      <td>
Fragment iteration
</td>
      <td>
<code>th:each</code>
</td>
    </tr>
    <tr>
      <td>
3
</td>
      <td>
Conditional evaluation
</td>
      <td>
        
<code>th:if</code><br> <code>th:unless</code><br> <code>th:switch</code><br> <code>th:case</code>
</td>
    </tr>
    <tr>
      <td>
4
</td>
      <td>
Local variable definition
</td>
      <td>
        
<code>th:object</code><br> <code>th:with</code>
</td>
    </tr>
    <tr>
      <td>
5
</td>
      <td>
General attribute modification
</td>
      <td>
        
<code>th:attr</code><br> <code>th:attrprepend</code><br> <code>th:attrappend</code>
</td>
    </tr>
    <tr>
      <td>
6
</td>
      <td>
Specific attribute modification
</td>
      <td>
<code>th:value</code>, <code>th:href</code>, <code>th:src</code>, etc.
</td>
    </tr>
    <tr>
      <td>
7
</td>
      <td>
Text (tag body modification)
</td>
      <td>
        
<code>th:text</code><br> <code>th:utext</code>
</td>
    </tr>
    <tr>
      <td>
8
</td>
      <td>
Fragment specification
</td>
      <td>
<code>th:fragment</code>
</td>
    </tr>
    <tr>
      <td>
9
</td>
      <td>
Fragment removal
</td>
      <td>
<code>th:remove</code>
</td>
    </tr>
  </tbody>
</table>

<p>This precedence mechanism means that the above iteration fragment will give exactly the same results if the attribute position is inverted (although it would be slightly less readable):</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;ul&gt;</span><span class="pln">
  </span><span class="tag">&lt;li</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${item.description}"</span><span class="pln"> </span><span class="atn">th:each</span><span class="pun">=</span><span class="atv">"item : ${items}"</span><span class="tag">&gt;</span><span class="pln">Item description here...</span><span class="tag">&lt;/li&gt;</span><span class="pln">
</span><span class="tag">&lt;/ul&gt;</span></code></pre>
</section>
<section id="comments-and-blocks" class="level1">
<h1>11. Comments and Blocks</h1>
<section id="standard-htmlxml-comments" class="level2">
<h2>11.1. Standard HTML/XML comments</h2>
<p>Standard HTML/XML comments <code>&lt;!-- ... --&gt;</code> can be used anywhere in thymeleaf templates. Anything inside these comments won’t be processed by neither Thymeleaf nor the browser, and will be just copied verbatim to the result:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="com">&lt;!-- User info follows --&gt;</span><span class="pln">
</span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${...}"</span><span class="tag">&gt;</span><span class="pln">
  ...
</span><span class="tag">&lt;/div&gt;</span></code></pre>
</section>
<section id="thymeleaf-parser-level-comment-blocks" class="level2">
<h2>11.2. Thymeleaf parser-level comment blocks</h2>
<p>Parser-level comment blocks are code that will be simply removed from the template when thymeleaf parses it. They look like this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="com">&lt;!--/* This code will be removed at thymeleaf parsing time! */--&gt;</span></code></pre>
<p>Thymeleaf will remove absolutely everything between <code>&lt;!--/*</code> and <code>*/--&gt;</code>, so these comment blocks can also be used for displaying code when a template is statically open, knowing that it will be removed when thymeleaf processes it:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="com">&lt;!--/*--&gt;</span><span class="pln"> 
  </span><span class="tag">&lt;div&gt;</span><span class="pln">
     you can see me only before thymeleaf processes me!
  </span><span class="tag">&lt;/div&gt;</span><span class="pln">
</span><span class="com">&lt;!--*/--&gt;</span></code></pre>
<p>This might come very handy for prototyping tables with a lot of <code>&lt;tr&gt;</code>’s, for example:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;table&gt;</span><span class="pln">
   </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">th:each</span><span class="pun">=</span><span class="atv">"x : ${xs}"</span><span class="tag">&gt;</span><span class="pln">
     ...
   </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
   </span><span class="com">&lt;!--/*--&gt;</span><span class="pln">
   </span><span class="tag">&lt;tr&gt;</span><span class="pln">
     ...
   </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
   </span><span class="tag">&lt;tr&gt;</span><span class="pln">
     ...
   </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
   </span><span class="com">&lt;!--*/--&gt;</span><span class="pln">
</span><span class="tag">&lt;/table&gt;</span></code></pre>
</section>
<section id="thymeleaf-prototype-only-comment-blocks" class="level2">
<h2>11.3. Thymeleaf prototype-only comment blocks</h2>
<p>Thymeleaf allows the definition of special comment blocks marked to be comments when the template is open statically (i.e.&nbsp;as a prototype), but considered normal markup by Thymeleaf when executing the template.</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;span&gt;</span><span class="pln">hello!</span><span class="tag">&lt;/span&gt;</span><span class="pln">
</span><span class="com">&lt;!--/*/
  &lt;div th:text="${...}"&gt;
    ...
  &lt;/div&gt;
/*/--&gt;</span><span class="pln">
</span><span class="tag">&lt;span&gt;</span><span class="pln">goodbye!</span><span class="tag">&lt;/span&gt;</span></code></pre>
<p>Thymeleaf’s parsing system will simply remove the <code>&lt;!--/*/</code> and <code>/*/--&gt;</code> markers, but not its contents, which will be left therefore uncommented. So when executing the template, Thymeleaf will actually see this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;span&gt;</span><span class="pln">hello!</span><span class="tag">&lt;/span&gt;</span><span class="pln">
 
  </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${...}"</span><span class="tag">&gt;</span><span class="pln">
    ...
  </span><span class="tag">&lt;/div&gt;</span><span class="pln">
 
</span><span class="tag">&lt;span&gt;</span><span class="pln">goodbye!</span><span class="tag">&lt;/span&gt;</span></code></pre>
<p>As happens with parser-level comment blocks, note that this feature is dialect-independent.</p>
</section>
<section id="synthetic-thblock-tag" class="level2">
<h2>11.4. Synthetic <code>th:block</code> tag</h2>
<p>Thymeleaf’s only element processor (not an attribute) included in the Standard Dialects is <code>th:block</code>.</p>
<p><code>th:block</code> is a mere attribute container that allows template developers to specify whichever attributes they want. Thymeleaf will execute these attributes and then simply make the block dissapear without a trace.</p>
<p>So it could be useful, for example, when creating iterated tables that require more than one <code>&lt;tr&gt;</code> for each element:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;table&gt;</span><span class="pln">
  </span><span class="tag">&lt;th:block</span><span class="pln"> </span><span class="atn">th:each</span><span class="pun">=</span><span class="atv">"user : ${users}"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;tr&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${user.login}"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/td&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${user.name}"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;tr&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">colspan</span><span class="pun">=</span><span class="atv">"2"</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${user.address}"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
  </span><span class="tag">&lt;/th:block&gt;</span><span class="pln">
</span><span class="tag">&lt;/table&gt;</span></code></pre>
<p>And especially useful when used in combination with prototype-only comment blocks:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;table&gt;</span><span class="pln">
    </span><span class="com">&lt;!--/*/ &lt;th:block th:each="user : ${users}"&gt; /*/--&gt;</span><span class="pln">
    </span><span class="tag">&lt;tr&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${user.login}"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/td&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${user.name}"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;tr&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">colspan</span><span class="pun">=</span><span class="atv">"2"</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${user.address}"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/td&gt;</span><span class="pln">
    </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
    </span><span class="com">&lt;!--/*/ &lt;/th:block&gt; /*/--&gt;</span><span class="pln">
</span><span class="tag">&lt;/table&gt;</span></code></pre>
<p>Note how this solution allows templates to be valid HTML (no need to add forbidden <code>&lt;div&gt;</code> blocks inside <code>&lt;table&gt;</code>), and still works OK when open statically in browsers as prototypes!</p>
</section>
</section>
<section id="inlining" class="level1">
<h1>12 Inlining</h1>
<section id="text-inlining" class="level2">
<h2>12.1 Text inlining</h2>
<p>Although the Standard Dialect allows us to do almost everything we might need by using tag attributes, there are situations in which we could prefer writing expressions directly into our HTML texts. For example, we could prefer writing this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p&gt;</span><span class="pln">Hello, [[${session.user.name}]]!</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>…instead of this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p&gt;</span><span class="pln">Hello, </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${session.user.name}"</span><span class="tag">&gt;</span><span class="pln">Sebastian</span><span class="tag">&lt;/span&gt;</span><span class="pln">!</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>Expressions between <code>[[...]]</code> are considered expression inlining in Thymeleaf, and in them you can use any kind of expression that would also be valid in a <code>th:text</code> attribute.</p>
<p>In order for inlining to work, we must activate it by using the <code>th:inline</code> attribute, which has three possible values or modes (<code>text</code>, <code>javascript</code> and <code>none</code>). Let’s try <code>text</code>:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">th:inline</span><span class="pun">=</span><span class="atv">"text"</span><span class="tag">&gt;</span><span class="pln">Hello, [[${session.user.name}]]!</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>The tag holding the <code>th:inline</code> does not have to be the one containing the inlined expression/s, any parent tag would do:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;body</span><span class="pln"> </span><span class="atn">th:inline</span><span class="pun">=</span><span class="atv">"text"</span><span class="tag">&gt;</span><span class="pln">

   ...

   </span><span class="tag">&lt;p&gt;</span><span class="pln">Hello, [[${session.user.name}]]!</span><span class="tag">&lt;/p&gt;</span><span class="pln">

   ...

</span><span class="tag">&lt;/body&gt;</span></code></pre>
<p>So you might now be asking: <em>Why aren’t we doing this from the beginning? It’s less code than all those</em> <code>th:text</code> <em>attributes!</em> Well, be careful there, because although you might find inlining quite interesting, you should always remember that inlined expressions will be displayed verbatim in your HTML files when you open them statically, so you probably won’t be able to use them as prototypes anymore!</p>
<p>The difference between how a browser would statically display our fragment of code without using inlining…</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="pln">Hello, Sebastian!</span></code></pre>
<p>…and using it…</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="pln">Hello, [[${session.user.name}]]!</span></code></pre>
<p>…is quite clear.</p>
</section>
<section id="script-inlining-javascript-and-dart" class="level2">
<h2>12.2 Script inlining (JavaScript and Dart)</h2>
<p>Thymeleaf offers a series of “scripting” modes for its inlining capabilities, so that you can integrate your data inside scripts created in some script languages.</p>
<p>Current scripting modes are <code>javascript</code> (<code>th:inline="javascript"</code>) and <code>dart</code> (<code>th:inline="dart"</code>).</p>
<p>The first thing we can do with script inlining is writing the value of expressions into our scripts, like:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">th:inline</span><span class="pun">=</span><span class="atv">"javascript"</span><span class="tag">&gt;</span><span class="pln">
</span><span class="com">/*&lt;![CDATA[*/</span><span class="pln">
    </span><span class="pun">...</span><span class="pln">

    </span><span class="kwd">var</span><span class="pln"> username </span><span class="pun">=</span><span class="pln"> </span><span class="com">/*[[${session.user.name}]]*/</span><span class="pln"> </span><span class="str">'Sebastian'</span><span class="pun">;</span><span class="pln">

    </span><span class="pun">...</span><span class="pln">
</span><span class="com">/*]]&gt;*/</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<p>The <code>/*[[...]]*/</code> syntax, instructs Thymeleaf to evaluate the contained expression. But there are more implications here:</p>
<ul>
<li>Being a javascript comment (<code>/*...*/</code>), our expression will be ignored when displaying the page statically in a browser.</li>
<li>The code after the inline expression (<code>'Sebastian'</code>) will be executed when displaying the page statically.</li>
<li>Thymeleaf will execute the expression and insert the result, but it will also remove all the code in the line after the inline expression itself (the part that is executed when displayed statically).</li>
</ul>
<p>So, the result of executing this will be:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">th:inline</span><span class="pun">=</span><span class="atv">"javascript"</span><span class="tag">&gt;</span><span class="pln">
</span><span class="com">/*&lt;![CDATA[*/</span><span class="pln">
    </span><span class="pun">...</span><span class="pln">

    </span><span class="kwd">var</span><span class="pln"> username </span><span class="pun">=</span><span class="pln"> </span><span class="str">'John Apricot'</span><span class="pun">;</span><span class="pln">

    </span><span class="pun">...</span><span class="pln">
</span><span class="com">/*]]&gt;*/</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<p>You can also do it without comments with the same effects, but that will make your script to fail when loaded statically:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">th:inline</span><span class="pun">=</span><span class="atv">"javascript"</span><span class="tag">&gt;</span><span class="pln">
</span><span class="com">/*&lt;![CDATA[*/</span><span class="pln">
    </span><span class="pun">...</span><span class="pln">

    </span><span class="kwd">var</span><span class="pln"> username </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[[</span><span class="pln">$</span><span class="pun">{</span><span class="pln">session</span><span class="pun">.</span><span class="pln">user</span><span class="pun">.</span><span class="pln">name</span><span class="pun">}]];</span><span class="pln">

    </span><span class="pun">...</span><span class="pln">
</span><span class="com">/*]]&gt;*/</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<p>Note that this evaluation is intelligent and not limited to Strings. Thymeleaf will correctly write in Javascript/Dart syntax the following kinds of objects:</p>
<ul>
<li>Strings</li>
<li>Numbers</li>
<li>Booleans</li>
<li>Arrays</li>
<li>Collections</li>
<li>Maps</li>
<li>Beans (objects with <em>getter</em> and <em>setter</em> methods)</li>
</ul>
<p>For example, if we had the following code:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">th:inline</span><span class="pun">=</span><span class="atv">"javascript"</span><span class="tag">&gt;</span><span class="pln">
</span><span class="com">/*&lt;![CDATA[*/</span><span class="pln">
    </span><span class="pun">...</span><span class="pln">

    </span><span class="kwd">var</span><span class="pln"> user </span><span class="pun">=</span><span class="pln"> </span><span class="com">/*[[${session.user}]]*/</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><span class="pln">

    </span><span class="pun">...</span><span class="pln">
</span><span class="com">/*]]&gt;*/</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<p>That <code>${session.user}</code> expression will evaluate to a <code>User</code> object, and Thymeleaf will correctly convert it to Javascript syntax:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">th:inline</span><span class="pun">=</span><span class="atv">"javascript"</span><span class="tag">&gt;</span><span class="pln">
</span><span class="com">/*&lt;![CDATA[*/</span><span class="pln">
    </span><span class="pun">...</span><span class="pln">

    </span><span class="kwd">var</span><span class="pln"> user </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="str">'age'</span><span class="pun">:</span><span class="kwd">null</span><span class="pun">,</span><span class="str">'firstName'</span><span class="pun">:</span><span class="str">'John'</span><span class="pun">,</span><span class="str">'lastName'</span><span class="pun">:</span><span class="str">'Apricot'</span><span class="pun">,</span><span class="pln">
                </span><span class="str">'name'</span><span class="pun">:</span><span class="str">'John Apricot'</span><span class="pun">,</span><span class="str">'nationality'</span><span class="pun">:</span><span class="str">'Antarctica'</span><span class="pun">};</span><span class="pln">

    </span><span class="pun">...</span><span class="pln">
</span><span class="com">/*]]&gt;*/</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<section id="adding-code" class="level3">
<h3>Adding code</h3>
<p>An additional feature when using javascript inlining is the ability to include code between a special comment syntax <code>/*[+...+]*/</code> so that Thymeleaf will automatically uncomment that code when processing the template:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-javascript"><span class="kwd">var</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">23</span><span class="pun">;</span><span class="pln">

</span><span class="com">/*[+

var msg  = 'This is a working application';

+]*/</span><span class="pln">

</span><span class="kwd">var</span><span class="pln"> f </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="pun">...</span></code></pre>
<p>Will be executed as:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-javascript"><span class="kwd">var</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">23</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">var</span><span class="pln"> msg  </span><span class="pun">=</span><span class="pln"> </span><span class="str">'This is a working application'</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">var</span><span class="pln"> f </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pun">...</span></code></pre>
<p>You can include expressions inside these comments, and they will be evaluated:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-javascript"><span class="kwd">var</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">23</span><span class="pun">;</span><span class="pln">

</span><span class="com">/*[+

var msg  = 'Hello, ' + [[${session.user.name}]];

+]*/</span><span class="pln">

</span><span class="kwd">var</span><span class="pln"> f </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pun">...</span></code></pre>
</section>
<section id="removing-code" class="level3">
<h3>Removing code</h3>
<p>It is also possible to make Thymeleaf remove code between special <code>/*[- */</code> and <code>/* -]*/</code> comments, like this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-javascript"><span class="kwd">var</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">23</span><span class="pun">;</span><span class="pln">

</span><span class="com">/*[- */</span><span class="pln">

</span><span class="kwd">var</span><span class="pln"> msg  </span><span class="pun">=</span><span class="pln"> </span><span class="str">'This is a non-working template'</span><span class="pun">;</span><span class="pln">

</span><span class="com">/* -]*/</span><span class="pln">

</span><span class="kwd">var</span><span class="pln"> f </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pun">...</span></code></pre>
</section>
</section>
</section>
<section id="validation-and-doctypes" class="level1">
<h1>13 Validation and Doctypes</h1>
<section id="validating-templates" class="level2">
<h2>13.1 Validating templates</h2>
<p>As mentioned before, Thymeleaf offers us out-of-the-box two standard template modes that validate our templates before processing them: <code>VALIDXML</code> and <code>VALIDXHTML.</code> These modes require our templates to be not only <em>well-formed XML</em> (which they should always be), but in fact valid according to the specified <code>DTD</code>.</p>
<p>The problem is that if we use the <code>VALIDXHTML</code> mode with templates including a <code>DOCTYPE</code> clause such as this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="dec">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;</span></code></pre>
<p>…we are going to obtain validation errors because the <code>th:*</code> tags do not exist according to that <code>DTD.</code> That’s perfectly normal, as the W3C obviously has no reason to include Thymeleaf’s features in their standards but, how do we solve it? By changing the <code>DTD.</code></p>
<p>Thymeleaf includes a set of <code>DTD</code> files that mirror the original ones from the XHTML standards, but adding all the available <code>th:*</code> attributes from the Standard Dialect. That’s why we have been using this in our templates:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="dec">&lt;!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd"&gt;</span></code></pre>
<p>That <code>SYSTEM</code> identifier instructs the Thymeleaf parser to resolve the special Thymeleaf-enabled <code>XHTML 1.0 Strict DTD</code> file and use it for validating our template. And don’t worry about that <code>http</code> thing, because that is only an identifier, and the <code>DTD</code> file will be locally read from Thymeleaf’s jar files.</p>
<blockquote>
<p>Note that because this DOCTYPE declaration is a perfectly valid one, if we open a browser to statically display our template as a prototype it will be rendered in <em>Standards Mode</em>.</p>
</blockquote>
<p>Here you have the complete set of Thymeleaf-enabled <code>DTD</code> declarations for all the supported flavours of XHTML:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="dec">&lt;!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd"&gt;</span><span class="pln">
</span><span class="dec">&lt;!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-transitional-thymeleaf-4.dtd"&gt;</span><span class="pln">
</span><span class="dec">&lt;!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-frameset-thymeleaf-4.dtd"&gt;</span><span class="pln">
</span><span class="dec">&lt;!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml11-thymeleaf-4.dtd"&gt;</span></code></pre>
<p>Also note that, in order for your IDE to be happy, and even if you are not working in a validating mode, you will need to declare the <code>th</code> namespace in your <code>html</code> tag:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;html</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.w3.org/1999/xhtml"</span><span class="pln">
      </span><span class="atn">xmlns:th</span><span class="pun">=</span><span class="atv">"http://www.thymeleaf.org"</span><span class="tag">&gt;</span></code></pre>
</section>
<section id="doctype-translation" class="level2">
<h2>13.2 Doctype translation</h2>
<p>It is fine for our templates to have a <code>DOCTYPE</code> like:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="dec">&lt;!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd"&gt;</span></code></pre>
<p>But it would not be fine for our web applications to send XHTML documents with this <code>DOCTYPE</code> to client browsers, because:</p>
<ul>
<li>They are not <code>PUBLIC</code> (they are <code>SYSTEM DOCTYPE</code>s), and therefore our web would not be validatable with the W3C Validators.</li>
<li>They are not needed, because once processed, all <code>th:*</code> tags will have dissapeared.</li>
</ul>
<p>That’s why Thymeleaf includes a mechanism for <em>DOCTYPE translation</em>, which will automatically translate your thymeleaf-specific XHTML <code>DOCTYPE</code>s into standard <code>DOCTYPE</code>s.</p>
<p>For example, if your template is <em>XHTML 1.0 Strict</em> and looks like this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="dec">&lt;!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd"&gt;</span><span class="pln">

</span><span class="tag">&lt;html</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.w3.org/1999/xhtml"</span><span class="pln">
      </span><span class="atn">xmlns:th</span><span class="pun">=</span><span class="atv">"http://www.thymeleaf.org"</span><span class="tag">&gt;</span><span class="pln">
    ... 
</span><span class="tag">&lt;/html&gt;</span></code></pre>
<p>After making Thymeleaf process the template, your resulting XHTML will look like this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="dec">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;</span><span class="pln">

</span><span class="tag">&lt;html</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.w3.org/1999/xhtml"</span><span class="tag">&gt;</span><span class="pln">
    ... 
</span><span class="tag">&lt;/html&gt;</span></code></pre>
<p>You don’t have to do anything for these transformations to take place: Thymeleaf will take care of them automatically.</p>
</section>
</section>
<section id="some-more-pages-for-our-grocery" class="level1">
<h1>14 Some more Pages for our Grocery</h1>
<p>Now we know a lot about using Thymeleaf, we can add some new pages to our website for order management.</p>
<p>Note that we will focus on XHTML code, but you can have a look at the bundled source code if you want to see the corresponding controllers.</p>
<section id="order-list" class="level2">
<h2>14.1 Order List</h2>
<p>Let’s start by creating an order list page, <code>/WEB-INF/templates/order/list.html</code>:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="dec">&lt;!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd"&gt;</span><span class="pln">

</span><span class="tag">&lt;html</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.w3.org/1999/xhtml"</span><span class="pln">
      </span><span class="atn">xmlns:th</span><span class="pun">=</span><span class="atv">"http://www.thymeleaf.org"</span><span class="tag">&gt;</span><span class="pln">

  </span><span class="tag">&lt;head&gt;</span><span class="pln">

    </span><span class="tag">&lt;title&gt;</span><span class="pln">Good Thymes Virtual Grocery</span><span class="tag">&lt;/title&gt;</span><span class="pln">
    </span><span class="tag">&lt;meta</span><span class="pln"> </span><span class="atn">http-equiv</span><span class="pun">=</span><span class="atv">"Content-Type"</span><span class="pln"> </span><span class="atn">content</span><span class="pun">=</span><span class="atv">"text/html; charset=UTF-8"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
    </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"stylesheet"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text/css"</span><span class="pln"> </span><span class="atn">media</span><span class="pun">=</span><span class="atv">"all"</span><span class="pln"> 
          </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"../../../css/gtvg.css"</span><span class="pln"> </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/css/gtvg.css}"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/head&gt;</span><span class="pln">

  </span><span class="tag">&lt;body&gt;</span><span class="pln">

    </span><span class="tag">&lt;h1&gt;</span><span class="pln">Order list</span><span class="tag">&lt;/h1&gt;</span><span class="pln">
  
    </span><span class="tag">&lt;table&gt;</span><span class="pln">
      </span><span class="tag">&lt;tr&gt;</span><span class="pln">
        </span><span class="tag">&lt;th&gt;</span><span class="pln">DATE</span><span class="tag">&lt;/th&gt;</span><span class="pln">
        </span><span class="tag">&lt;th&gt;</span><span class="pln">CUSTOMER</span><span class="tag">&lt;/th&gt;</span><span class="pln">
        </span><span class="tag">&lt;th&gt;</span><span class="pln">TOTAL</span><span class="tag">&lt;/th&gt;</span><span class="pln">
        </span><span class="tag">&lt;th&gt;&lt;/th&gt;</span><span class="pln">
      </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
      </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">th:each</span><span class="pun">=</span><span class="atv">"o : ${orders}"</span><span class="pln"> </span><span class="atn">th:class</span><span class="pun">=</span><span class="atv">"${oStat.odd}? 'odd'"</span><span class="tag">&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${#calendars.format(o.date,'dd/MMM/yyyy')}"</span><span class="tag">&gt;</span><span class="pln">13 jan 2011</span><span class="tag">&lt;/td&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${o.customer.name}"</span><span class="tag">&gt;</span><span class="pln">Frederic Tomato</span><span class="tag">&lt;/td&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${#aggregates.sum(o.orderLines.{purchasePrice * amount})}"</span><span class="tag">&gt;</span><span class="pln">23.32</span><span class="tag">&lt;/td&gt;</span><span class="pln">
        </span><span class="tag">&lt;td&gt;</span><span class="pln">
          </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"details.html"</span><span class="pln"> </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/order/details(orderId=${o.id})}"</span><span class="tag">&gt;</span><span class="pln">view</span><span class="tag">&lt;/a&gt;</span><span class="pln">
        </span><span class="tag">&lt;/td&gt;</span><span class="pln">
      </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;/table&gt;</span><span class="pln">
  
    </span><span class="tag">&lt;p&gt;</span><span class="pln">
      </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"../home.html"</span><span class="pln"> </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/}"</span><span class="tag">&gt;</span><span class="pln">Return to home</span><span class="tag">&lt;/a&gt;</span><span class="pln">
    </span><span class="tag">&lt;/p&gt;</span><span class="pln">
    
  </span><span class="tag">&lt;/body&gt;</span><span class="pln">
  
</span><span class="tag">&lt;/html&gt;</span></code></pre>
<p>There’s nothing here that should surprise us, except for this little bit of OGNL magic:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${#aggregates.sum(o.orderLines.{purchasePrice * amount})}"</span><span class="tag">&gt;</span><span class="pln">23.32</span><span class="tag">&lt;/td&gt;</span></code></pre>
<p>What that does is, for each order line (<code>OrderLine</code> object) in the order, multiply its <code>purchasePrice</code> and <code>amount</code> properties (by calling the corresponding <code>getPurchasePrice()</code> and <code>getAmount()</code> methods) and return the result into a list of numbers, later aggregated by the <code>#aggregates.sum(...)</code> function in order to obtain the order total price.</p>
<p>You’ve got to love the power of OGNL.</p>
</section>
<section id="order-details" class="level2">
<h2>14.2 Order Details</h2>
<p>Now for the order details page, in which we will make a heavy use of asterisk syntax:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="dec">&lt;!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd"&gt;</span><span class="pln">

</span><span class="tag">&lt;html</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.w3.org/1999/xhtml"</span><span class="pln">
      </span><span class="atn">xmlns:th</span><span class="pun">=</span><span class="atv">"http://www.thymeleaf.org"</span><span class="tag">&gt;</span><span class="pln">

  </span><span class="tag">&lt;head&gt;</span><span class="pln">
    </span><span class="tag">&lt;title&gt;</span><span class="pln">Good Thymes Virtual Grocery</span><span class="tag">&lt;/title&gt;</span><span class="pln">
    </span><span class="tag">&lt;meta</span><span class="pln"> </span><span class="atn">http-equiv</span><span class="pun">=</span><span class="atv">"Content-Type"</span><span class="pln"> </span><span class="atn">content</span><span class="pun">=</span><span class="atv">"text/html; charset=UTF-8"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
    </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"stylesheet"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text/css"</span><span class="pln"> </span><span class="atn">media</span><span class="pun">=</span><span class="atv">"all"</span><span class="pln"> 
          </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"../../../css/gtvg.css"</span><span class="pln"> </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/css/gtvg.css}"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/head&gt;</span><span class="pln">

  </span><span class="tag">&lt;body</span><span class="pln"> </span><span class="atn">th:object</span><span class="pun">=</span><span class="atv">"${order}"</span><span class="tag">&gt;</span><span class="pln">

    </span><span class="tag">&lt;h1&gt;</span><span class="pln">Order details</span><span class="tag">&lt;/h1&gt;</span><span class="pln">

    </span><span class="tag">&lt;div&gt;</span><span class="pln">
      </span><span class="tag">&lt;p&gt;&lt;b&gt;</span><span class="pln">Code:</span><span class="tag">&lt;/b&gt;</span><span class="pln"> </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"*{id}"</span><span class="tag">&gt;</span><span class="pln">99</span><span class="tag">&lt;/span&gt;&lt;/p&gt;</span><span class="pln">
      </span><span class="tag">&lt;p&gt;</span><span class="pln">
        </span><span class="tag">&lt;b&gt;</span><span class="pln">Date:</span><span class="tag">&lt;/b&gt;</span><span class="pln">
        </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"*{#calendars.format(date,'dd MMM yyyy')}"</span><span class="tag">&gt;</span><span class="pln">13 jan 2011</span><span class="tag">&lt;/span&gt;</span><span class="pln">
      </span><span class="tag">&lt;/p&gt;</span><span class="pln">
    </span><span class="tag">&lt;/div&gt;</span><span class="pln">

    </span><span class="tag">&lt;h2&gt;</span><span class="pln">Customer</span><span class="tag">&lt;/h2&gt;</span><span class="pln">

    </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:object</span><span class="pun">=</span><span class="atv">"*{customer}"</span><span class="tag">&gt;</span><span class="pln">
      </span><span class="tag">&lt;p&gt;&lt;b&gt;</span><span class="pln">Name:</span><span class="tag">&lt;/b&gt;</span><span class="pln"> </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"*{name}"</span><span class="tag">&gt;</span><span class="pln">Frederic Tomato</span><span class="tag">&lt;/span&gt;&lt;/p&gt;</span><span class="pln">
      </span><span class="tag">&lt;p&gt;</span><span class="pln">
        </span><span class="tag">&lt;b&gt;</span><span class="pln">Since:</span><span class="tag">&lt;/b&gt;</span><span class="pln">
        </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"*{#calendars.format(customerSince,'dd MMM yyyy')}"</span><span class="tag">&gt;</span><span class="pln">1 jan 2011</span><span class="tag">&lt;/span&gt;</span><span class="pln">
      </span><span class="tag">&lt;/p&gt;</span><span class="pln">
    </span><span class="tag">&lt;/div&gt;</span><span class="pln">
  
    </span><span class="tag">&lt;h2&gt;</span><span class="pln">Products</span><span class="tag">&lt;/h2&gt;</span><span class="pln">
  
    </span><span class="tag">&lt;table&gt;</span><span class="pln">
      </span><span class="tag">&lt;tr&gt;</span><span class="pln">
        </span><span class="tag">&lt;th&gt;</span><span class="pln">PRODUCT</span><span class="tag">&lt;/th&gt;</span><span class="pln">
        </span><span class="tag">&lt;th&gt;</span><span class="pln">AMOUNT</span><span class="tag">&lt;/th&gt;</span><span class="pln">
        </span><span class="tag">&lt;th&gt;</span><span class="pln">PURCHASE PRICE</span><span class="tag">&lt;/th&gt;</span><span class="pln">
      </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
      </span><span class="tag">&lt;tr</span><span class="pln"> </span><span class="atn">th:each</span><span class="pun">=</span><span class="atv">"ol,row : *{orderLines}"</span><span class="pln"> </span><span class="atn">th:class</span><span class="pun">=</span><span class="atv">"${row.odd}? 'odd'"</span><span class="tag">&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${ol.product.name}"</span><span class="tag">&gt;</span><span class="pln">Strawberries</span><span class="tag">&lt;/td&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${ol.amount}"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"number"</span><span class="tag">&gt;</span><span class="pln">3</span><span class="tag">&lt;/td&gt;</span><span class="pln">
        </span><span class="tag">&lt;td</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${ol.purchasePrice}"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"number"</span><span class="tag">&gt;</span><span class="pln">23.32</span><span class="tag">&lt;/td&gt;</span><span class="pln">
      </span><span class="tag">&lt;/tr&gt;</span><span class="pln">
    </span><span class="tag">&lt;/table&gt;</span><span class="pln">

    </span><span class="tag">&lt;div&gt;</span><span class="pln">
      </span><span class="tag">&lt;b&gt;</span><span class="pln">TOTAL:</span><span class="tag">&lt;/b&gt;</span><span class="pln">
      </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"*{#aggregates.sum(orderLines.{purchasePrice * amount})}"</span><span class="tag">&gt;</span><span class="pln">35.23</span><span class="tag">&lt;/span&gt;</span><span class="pln">
    </span><span class="tag">&lt;/div&gt;</span><span class="pln">
  
    </span><span class="tag">&lt;p&gt;</span><span class="pln">
      </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"list.html"</span><span class="pln"> </span><span class="atn">th:href</span><span class="pun">=</span><span class="atv">"@{/order/list}"</span><span class="tag">&gt;</span><span class="pln">Return to order list</span><span class="tag">&lt;/a&gt;</span><span class="pln">
    </span><span class="tag">&lt;/p&gt;</span><span class="pln">

  </span><span class="tag">&lt;/body&gt;</span><span class="pln">
  
</span><span class="tag">&lt;/html&gt;</span></code></pre>
<p>Not much really new here, except for this nested object selection:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;body</span><span class="pln"> </span><span class="atn">th:object</span><span class="pun">=</span><span class="atv">"${order}"</span><span class="tag">&gt;</span><span class="pln">

  ...

  </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:object</span><span class="pun">=</span><span class="atv">"*{customer}"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;p&gt;&lt;b&gt;</span><span class="pln">Name:</span><span class="tag">&lt;/b&gt;</span><span class="pln"> </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"*{name}"</span><span class="tag">&gt;</span><span class="pln">Frederic Tomato</span><span class="tag">&lt;/span&gt;&lt;/p&gt;</span><span class="pln">
    ...
  </span><span class="tag">&lt;/div&gt;</span><span class="pln">

  ...
</span><span class="tag">&lt;/body&gt;</span></code></pre>
<p>…which makes that <code>*{name}</code> in fact equivalent to:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;p&gt;&lt;b&gt;</span><span class="pln">Name:</span><span class="tag">&lt;/b&gt;</span><span class="pln"> </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${order.customer.name}"</span><span class="tag">&gt;</span><span class="pln">Frederic Tomato</span><span class="tag">&lt;/span&gt;&lt;/p&gt;</span></code></pre>
</section>
</section>
<section id="more-on-configuration" class="level1">
<h1>15 More on Configuration</h1>
<section id="template-resolvers" class="level2">
<h2>15.1 Template Resolvers</h2>
<p>For our Good Thymes Virtual Grocery, we chose an <code>ITemplateResolver</code> implementation called <code>ServletContextTemplateResolver</code> that allowed us to obtain templates as resources from the Servlet Context.</p>
<p>Besides giving you the ability to create your own template resolver by implementing <code>ITemplateResolver,</code> Thymeleaf includes three other implementations out of the box:</p>
<ul>
<li><p><code>org.thymeleaf.templateresolver.ClassLoaderTemplateResolver</code>, which resolves templates as classloader resources, like:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="kwd">return</span><span class="pln"> </span><span class="typ">Thread</span><span class="pun">.</span><span class="pln">currentThread</span><span class="pun">().</span><span class="pln">getContextClassLoader</span><span class="pun">().</span><span class="pln">getResourceAsStream</span><span class="pun">(</span><span class="pln">templateName</span><span class="pun">);</span></code></pre></li>
<li><p><code>org.thymeleaf.templateresolver.FileTemplateResolver</code>, which resolves templates as files from the file system, like:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">FileInputStream</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">File</span><span class="pun">(</span><span class="pln">templateName</span><span class="pun">));</span></code></pre></li>
<li><p><code>org.thymeleaf.templateresolver.UrlTemplateResolver</code>, which resolves templates as URLs (even non-local ones), like:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> URL</span><span class="pun">(</span><span class="pln">templateName</span><span class="pun">)).</span><span class="pln">openStream</span><span class="pun">();</span></code></pre></li>
</ul>
<p>All of the pre-bundled implementations of <code>ITemplateResolver</code> allow the same set of configuration parameters, which include:</p>
<ul>
<li><p>Prefix and suffix (as already seen):</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="pln">templateResolver</span><span class="pun">.</span><span class="pln">setPrefix</span><span class="pun">(</span><span class="str">"/WEB-INF/templates/"</span><span class="pun">);</span><span class="pln">
templateResolver</span><span class="pun">.</span><span class="pln">setSuffix</span><span class="pun">(</span><span class="str">".html"</span><span class="pun">);</span></code></pre></li>
<li><p>Template aliases that allow the use of template names that do not directly correspond to file names. If both suffix/prefix and alias exist, alias will be applied before prefix/suffix:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="pln">templateResolver</span><span class="pun">.</span><span class="pln">addTemplateAlias</span><span class="pun">(</span><span class="str">"adminHome"</span><span class="pun">,</span><span class="str">"profiles/admin/home"</span><span class="pun">);</span><span class="pln">
templateResolver</span><span class="pun">.</span><span class="pln">setTemplateAliases</span><span class="pun">(</span><span class="pln">aliasesMap</span><span class="pun">);</span></code></pre></li>
<li><p>Encoding to be applied when reading templates:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="pln">templateResolver</span><span class="pun">.</span><span class="pln">setEncoding</span><span class="pun">(</span><span class="str">"UTF-8"</span><span class="pun">);</span></code></pre></li>
<li><p>Default template mode, and patterns for defining other modes for specific templates:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">// Default is TemplateMode.XHTML</span><span class="pln">
templateResolver</span><span class="pun">.</span><span class="pln">setTemplateMode</span><span class="pun">(</span><span class="str">"HTML5"</span><span class="pun">);</span><span class="pln">
templateResolver</span><span class="pun">.</span><span class="pln">getXhtmlTemplateModePatternSpec</span><span class="pun">().</span><span class="pln">addPattern</span><span class="pun">(</span><span class="str">"*.xhtml"</span><span class="pun">);</span></code></pre></li>
<li><p>Default mode for template cache, and patterns for defining whether specific templates are cacheable or not:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">// Default is true</span><span class="pln">
templateResolver</span><span class="pun">.</span><span class="pln">setCacheable</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
templateResolver</span><span class="pun">.</span><span class="pln">getCacheablePatternSpec</span><span class="pun">().</span><span class="pln">addPattern</span><span class="pun">(</span><span class="str">"/users/*"</span><span class="pun">);</span></code></pre></li>
<li><p>TTL in milliseconds for parsed template cache entries originated in this template resolver. If not set, the only way to remove an entry from the cache will be LRU (cache max size exceeded and the entry is the oldest).</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">// Default is no TTL (only LRU would remove entries)</span><span class="pln">
templateResolver</span><span class="pun">.</span><span class="pln">setCacheTTLMs</span><span class="pun">(</span><span class="lit">60000L</span><span class="pun">);</span></code></pre></li>
</ul>
<p>Also, a Template Engine can be specified several template resolvers, in which case an order can be established between them for template resolution so that, if the first one is not able to resolve the template, the second one is asked, and so on:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="typ">ClassLoaderTemplateResolver</span><span class="pln"> classLoaderTemplateResolver </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ClassLoaderTemplateResolver</span><span class="pun">();</span><span class="pln">
classLoaderTemplateResolver</span><span class="pun">.</span><span class="pln">setOrder</span><span class="pun">(</span><span class="typ">Integer</span><span class="pun">.</span><span class="pln">valueOf</span><span class="pun">(</span><span class="lit">1</span><span class="pun">));</span><span class="pln">

</span><span class="typ">ServletContextTemplateResolver</span><span class="pln"> servletContextTemplateResolver </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ServletContextTemplateResolver</span><span class="pun">();</span><span class="pln">
servletContextTemplateResolver</span><span class="pun">.</span><span class="pln">setOrder</span><span class="pun">(</span><span class="typ">Integer</span><span class="pun">.</span><span class="pln">valueOf</span><span class="pun">(</span><span class="lit">2</span><span class="pun">));</span><span class="pln">

templateEngine</span><span class="pun">.</span><span class="pln">addTemplateResolver</span><span class="pun">(</span><span class="pln">classLoaderTemplateResolver</span><span class="pun">);</span><span class="pln">
templateEngine</span><span class="pun">.</span><span class="pln">addTemplateResolver</span><span class="pun">(</span><span class="pln">servletContextTemplateResolver</span><span class="pun">);</span></code></pre>
<p>When several template resolvers are applied, it is recommended to specify patterns for each template resolver so that Thymeleaf can quickly discard those template resolvers that are not meant to resolve the template, enhancing performance. Doing this is not a requirement, but an optimization:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="typ">ClassLoaderTemplateResolver</span><span class="pln"> classLoaderTemplateResolver </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ClassLoaderTemplateResolver</span><span class="pun">();</span><span class="pln">
classLoaderTemplateResolver</span><span class="pun">.</span><span class="pln">setOrder</span><span class="pun">(</span><span class="typ">Integer</span><span class="pun">.</span><span class="pln">valueOf</span><span class="pun">(</span><span class="lit">1</span><span class="pun">));</span><span class="pln">
</span><span class="com">// This classloader will not be even asked for any templates not matching these patterns </span><span class="pln">
classLoaderTemplateResolver</span><span class="pun">.</span><span class="pln">getResolvablePatternSpec</span><span class="pun">().</span><span class="pln">addPattern</span><span class="pun">(</span><span class="str">"/layout/*.html"</span><span class="pun">);</span><span class="pln">
classLoaderTemplateResolver</span><span class="pun">.</span><span class="pln">getResolvablePatternSpec</span><span class="pun">().</span><span class="pln">addPattern</span><span class="pun">(</span><span class="str">"/menu/*.html"</span><span class="pun">);</span><span class="pln">

</span><span class="typ">ServletContextTemplateResolver</span><span class="pln"> servletContextTemplateResolver </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ServletContextTemplateResolver</span><span class="pun">();</span><span class="pln">
servletContextTemplateResolver</span><span class="pun">.</span><span class="pln">setOrder</span><span class="pun">(</span><span class="typ">Integer</span><span class="pun">.</span><span class="pln">valueOf</span><span class="pun">(</span><span class="lit">2</span><span class="pun">));</span></code></pre>
</section>
<section id="message-resolvers" class="level2">
<h2>15.2 Message Resolvers</h2>
<p>We did not explicitly specify a Message Resolver implementation for our Grocery application, and as it was explained before, this meant that the implementation being used was an <code>org.thymeleaf.messageresolver.StandardMessageResolver</code> object.</p>
<p>This <code>StandardMessageResolver,</code> which looks for messages files with the same name as the template in the way already explained, is in fact the only message resolver implementation offered by Thymeleaf core out of the box, although of course you can create your own by just implementing the <code>org.thymeleaf.messageresolver.IMessageResolver</code> interface.</p>
<blockquote>
<p>The Thymeleaf + Spring integration packages offer an <code>IMessageResolver</code> implementation which uses the standard Spring way of retrieving externalized messages, by using <code>MessageSource</code> objects.</p>
</blockquote>
<p>What if you wanted to add a message resolver (or more) to the Template Engine? Easy:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">// For setting only one</span><span class="pln">
templateEngine</span><span class="pun">.</span><span class="pln">setMessageResolver</span><span class="pun">(</span><span class="pln">messageResolver</span><span class="pun">);</span><span class="pln">

</span><span class="com">// For setting more than one</span><span class="pln">
templateEngine</span><span class="pun">.</span><span class="pln">addMessageResolver</span><span class="pun">(</span><span class="pln">messageResolver</span><span class="pun">);</span></code></pre>
<p>And why would you want to have more than one message resolver? for the same reason as template resolvers: message resolvers are ordered and if the first one cannot resolve a specific message, the second one will be asked, then the third, etc.</p>
</section>
<section id="logging" class="level2">
<h2>15.3 Logging</h2>
<p>Thymeleaf pays quite a lot of attention to logging, and always tries to offer the maximum amount of useful information through its logging interface.</p>
<p>The logging library used is <code>slf4j,</code> which in fact acts as a bridge to whichever logging implementation you might want to use in your application (for example, <code>log4j</code>).</p>
<p>Thymeleaf classes will log <code>TRACE</code>, <code>DEBUG</code> and <code>INFO</code>-level information, depending on the level of detail you desire, and besides general logging it will use three special loggers associated with the TemplateEngine class which you can configure separately for different purposes:</p>
<ul>
<li><code>org.thymeleaf.TemplateEngine.CONFIG</code> will output detailed configuration of the library during initialization.</li>
<li><code>org.thymeleaf.TemplateEngine.TIMER</code> will output information about the amount of time taken to process each template (useful for benchmarking!)</li>
<li><code>org.thymeleaf.TemplateEngine.cache</code> is the prefix for a set of loggers that output specific information about the caches. Although the names of the cache loggers are configurable by the user and thus could change, by default they are:
<ul>
<li><code>org.thymeleaf.TemplateEngine.cache.TEMPLATE_CACHE</code></li>
<li><code>org.thymeleaf.TemplateEngine.cache.FRAGMENT_CACHE</code></li>
<li><code>org.thymeleaf.TemplateEngine.cache.MESSAGE_CACHE</code></li>
<li><code>org.thymeleaf.TemplateEngine.cache.EXPRESSION_CACHE</code></li>
</ul></li>
</ul>
<p>An example configuration for Thymeleaf’s logging infrastructure, using <code>log4j</code>, could be:</p>
<pre><code>log4j.logger.org.thymeleaf=DEBUG
log4j.logger.org.thymeleaf.TemplateEngine.CONFIG=TRACE
log4j.logger.org.thymeleaf.TemplateEngine.TIMER=TRACE
log4j.logger.org.thymeleaf.TemplateEngine.cache.TEMPLATE_CACHE=TRACE</code></pre>
</section>
</section>
<section id="template-cache" class="level1">
<h1>16 Template Cache</h1>
<p>Thymeleaf works thanks to a DOM processing engine and a series of processors —one for each type of node that needs to apply logic— that modify the document’s DOM tree in order to create the results you expect by combining this tree with your data.</p>
<p>It also includes —by default— a cache that stores parsed templates, this is, the DOM trees resulting from reading and parsing template files before processing them. This is especially useful when working in a web application, and builds on the following concepts:</p>
<ul>
<li>Input/Output is almost always the slowest part of any application. In-memory process is extremely quick compared to it.</li>
<li>Cloning an existing in-memory DOM-tree is always much quicker than reading a template file, parsing it and creating a new DOM object tree for it.</li>
<li>Web applications usually only have a few dozen templates.</li>
<li>Template files are small-to-medium size, and they are not modified while the application is running.</li>
</ul>
<p>This all leads to the idea that caching the most used templates in a web application is feasible without wasting big amounts of memory, and also that it will save a lot of time that would be spent on input/output operations on a small set of files that, in fact, never change.</p>
<p>And how can we take control of this cache? First, we’ve learned before that we can enable or disable it at the Template Resolver, even acting only on specific templates:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">// Default is true</span><span class="pln">
templateResolver</span><span class="pun">.</span><span class="pln">setCacheable</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
templateResolver</span><span class="pun">.</span><span class="pln">getCacheablePatternSpec</span><span class="pun">().</span><span class="pln">addPattern</span><span class="pun">(</span><span class="str">"/users/*"</span><span class="pun">);</span></code></pre>
<p>Also, we could modify its configuration by establishing our own <em>Cache Manager</em> object, which could be an instance of the default <code>StandardCacheManager</code> implementation:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">// Default is 50</span><span class="pln">
</span><span class="typ">StandardCacheManager</span><span class="pln"> cacheManager </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">StandardCacheManager</span><span class="pun">();</span><span class="pln">
cacheManager</span><span class="pun">.</span><span class="pln">setTemplateCacheMaxSize</span><span class="pun">(</span><span class="lit">100</span><span class="pun">);</span><span class="pln">
</span><span class="pun">...</span><span class="pln">
templateEngine</span><span class="pun">.</span><span class="pln">setCacheManager</span><span class="pun">(</span><span class="pln">cacheManager</span><span class="pun">);</span></code></pre>
<p>Refer to the javadoc API of <code>org.thymeleaf.cache.StandardCacheManager</code> for more info on configuring the caches.</p>
<p>Entries can be manually removed from the template cache:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">// Clear the cache completely</span><span class="pln">
templateEngine</span><span class="pun">.</span><span class="pln">clearTemplateCache</span><span class="pun">();</span><span class="pln">

</span><span class="com">// Clear a specific template from the cache</span><span class="pln">
templateEngine</span><span class="pun">.</span><span class="pln">clearTemplateCacheFor</span><span class="pun">(</span><span class="str">"/users/userList"</span><span class="pun">);</span></code></pre>
</section>
<section id="appendix-a-expression-basic-objects" class="level1">
<h1>17 Appendix A: Expression Basic Objects</h1>
<p>Some objects and variable maps are always available to be invoked at variable expressions (executed by OGNL or SpringEL). Let’s see them:</p>
<section id="base-objects" class="level3">
<h3>Base objects</h3>
<ul>
<li><strong>#ctx</strong> : the context object. It will be an implementation of <code>org.thymeleaf.context.IContext</code>, <code>org.thymeleaf.context.IWebContext</code> depending on our environment (standalone or web). If we are using the <em>Spring integration module</em>, it will be an instance of <code>org.thymeleaf.spring[3|4].context.SpringWebContext</code>.</li>
</ul>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">/*
 * ======================================================================
 * See javadoc API for class org.thymeleaf.context.IContext
 * ======================================================================
 */</span><span class="pln">

$</span><span class="pun">{#</span><span class="pln">ctx</span><span class="pun">.</span><span class="pln">locale</span><span class="pun">}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">ctx</span><span class="pun">.</span><span class="pln">variables</span><span class="pun">}</span><span class="pln">

</span><span class="com">/*
 * ======================================================================
 * See javadoc API for class org.thymeleaf.context.IWebContext
 * ======================================================================
 */</span><span class="pln">

$</span><span class="pun">{#</span><span class="pln">ctx</span><span class="pun">.</span><span class="pln">applicationAttributes</span><span class="pun">}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">ctx</span><span class="pun">.</span><span class="pln">httpServletRequest</span><span class="pun">}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">ctx</span><span class="pun">.</span><span class="pln">httpServletResponse</span><span class="pun">}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">ctx</span><span class="pun">.</span><span class="pln">httpSession</span><span class="pun">}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">ctx</span><span class="pun">.</span><span class="pln">requestAttributes</span><span class="pun">}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">ctx</span><span class="pun">.</span><span class="pln">requestParameters</span><span class="pun">}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">ctx</span><span class="pun">.</span><span class="pln">servletContext</span><span class="pun">}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">ctx</span><span class="pun">.</span><span class="pln">sessionAttributes</span><span class="pun">}</span></code></pre>
<ul>
<li><strong>#locale</strong> : direct access to the <code>java.util.Locale</code> associated with current request.</li>
</ul>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="pln">$</span><span class="pun">{#</span><span class="pln">locale</span><span class="pun">}</span></code></pre>
<ul>
<li><p><strong>#vars</strong> : an instance of <code>org.thymeleaf.context.VariablesMap</code> with all the variables in the Context (usually the variables contained in <code>#ctx.variables</code> plus local ones).</p>
<p>Unqualified expressions are evaluated against this object. In fact, <code>${something}</code> is completely equivalent to (but more beautiful than) <code>${#vars.something}</code>.</p>
<p><code>#root</code> is a synomyn for the same object.</p></li>
</ul>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">/*
 * ======================================================================
 * See javadoc API for class org.thymeleaf.context.VariablesMap
 * ======================================================================
 */</span><span class="pln">

$</span><span class="pun">{#</span><span class="pln">vars</span><span class="pun">.</span><span class="pln">get</span><span class="pun">(</span><span class="str">'foo'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">vars</span><span class="pun">.</span><span class="pln">containsKey</span><span class="pun">(</span><span class="str">'foo'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">vars</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()}</span><span class="pln">
</span><span class="pun">...</span></code></pre>
</section>
<section id="web-context-namespaces-for-requestsession-attributes-etc." class="level3">
<h3>Web context namespaces for request/session attributes, etc.</h3>
<p>When using Thymeleaf in a web environment, we can use a series of shortcuts for accessing request parameters, session attributes and application attributes:</p>
<blockquote>
<p>Note these are not <em>context objects</em>, but maps added to the context as variables, so we access them without <code>#</code>. In some way, therefore, they act as <em>namespaces</em>.</p>
</blockquote>
<ul>
<li><strong>param</strong> : for retrieving request parameters. <code>${param.foo}</code> is a <code>String[]</code> with the values of the <code>foo</code> request parameter, so <code>${param.foo[0]}</code> will normally be used for getting the first value.</li>
</ul>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">/*
 * ============================================================================
 * See javadoc API for class org.thymeleaf.context.WebRequestParamsVariablesMap
 * ============================================================================
 */</span><span class="pln">

$</span><span class="pun">{</span><span class="pln">param</span><span class="pun">.</span><span class="pln">foo</span><span class="pun">}</span><span class="pln">              </span><span class="com">// Retrieves a String[] with the values of request parameter 'foo'</span><span class="pln">
$</span><span class="pun">{</span><span class="pln">param</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()}</span><span class="pln">
$</span><span class="pun">{</span><span class="pln">param</span><span class="pun">.</span><span class="pln">isEmpty</span><span class="pun">()}</span><span class="pln">
$</span><span class="pun">{</span><span class="pln">param</span><span class="pun">.</span><span class="pln">containsKey</span><span class="pun">(</span><span class="str">'foo'</span><span class="pun">)}</span><span class="pln">
</span><span class="pun">...</span></code></pre>
<ul>
<li><strong>session</strong> : for retrieving session attributes.</li>
</ul>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">/*
 * ======================================================================
 * See javadoc API for class org.thymeleaf.context.WebSessionVariablesMap
 * ======================================================================
 */</span><span class="pln">

$</span><span class="pun">{</span><span class="pln">session</span><span class="pun">.</span><span class="pln">foo</span><span class="pun">}</span><span class="pln">                 </span><span class="com">// Retrieves the session atttribute 'foo'</span><span class="pln">
$</span><span class="pun">{</span><span class="pln">session</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()}</span><span class="pln">
$</span><span class="pun">{</span><span class="pln">session</span><span class="pun">.</span><span class="pln">isEmpty</span><span class="pun">()}</span><span class="pln">
$</span><span class="pun">{</span><span class="pln">session</span><span class="pun">.</span><span class="pln">containsKey</span><span class="pun">(</span><span class="str">'foo'</span><span class="pun">)}</span><span class="pln">
</span><span class="pun">...</span></code></pre>
<ul>
<li><strong>application</strong> : for retrieving application/servlet context attributes.</li>
</ul>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">/*
 * =============================================================================
 * See javadoc API for class org.thymeleaf.context.WebServletContextVariablesMap
 * =============================================================================
 */</span><span class="pln">

$</span><span class="pun">{</span><span class="pln">application</span><span class="pun">.</span><span class="pln">foo</span><span class="pun">}</span><span class="pln">              </span><span class="com">// Retrieves the ServletContext atttribute 'foo'</span><span class="pln">
$</span><span class="pun">{</span><span class="pln">application</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()}</span><span class="pln">
$</span><span class="pun">{</span><span class="pln">application</span><span class="pun">.</span><span class="pln">isEmpty</span><span class="pun">()}</span><span class="pln">
$</span><span class="pun">{</span><span class="pln">application</span><span class="pun">.</span><span class="pln">containsKey</span><span class="pun">(</span><span class="str">'foo'</span><span class="pun">)}</span><span class="pln">
</span><span class="pun">...</span></code></pre>
<p>Note there is <strong>no need to specify a namespace for accessing request attributes</strong> (as opposed to <em>request parameters</em>) because all request attributes are automatically added to the context as variables in the context root:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="pln">$</span><span class="pun">{</span><span class="pln">myRequestAttribute</span><span class="pun">}</span></code></pre>
</section>
<section id="web-context-objects" class="level3">
<h3>Web context objects</h3>
<p>Inside a web environment there is also direct access to the following objects (note these are objects, not maps/namespaces):</p>
<ul>
<li><strong>#httpServletRequest</strong> : direct access to the <code>javax.servlet.http.HttpServletRequest</code> object associated with the current request.</li>
</ul>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="pln">$</span><span class="pun">{#</span><span class="pln">httpServletRequest</span><span class="pun">.</span><span class="pln">getAttribute</span><span class="pun">(</span><span class="str">'foo'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">httpServletRequest</span><span class="pun">.</span><span class="pln">getParameter</span><span class="pun">(</span><span class="str">'foo'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">httpServletRequest</span><span class="pun">.</span><span class="pln">getContextPath</span><span class="pun">()}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">httpServletRequest</span><span class="pun">.</span><span class="pln">getRequestName</span><span class="pun">()}</span><span class="pln">
</span><span class="pun">...</span></code></pre>
<ul>
<li><strong>#httpSession</strong> : direct access to the <code>javax.servlet.http.HttpSession</code> object associated with the current request.</li>
</ul>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="pln">$</span><span class="pun">{#</span><span class="pln">httpSession</span><span class="pun">.</span><span class="pln">getAttribute</span><span class="pun">(</span><span class="str">'foo'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">httpSession</span><span class="pun">.</span><span class="pln">id</span><span class="pun">}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">httpSession</span><span class="pun">.</span><span class="pln">lastAccessedTime</span><span class="pun">}</span><span class="pln">
</span><span class="pun">...</span></code></pre>
</section>
<section id="spring-context-objects" class="level3">
<h3>Spring context objects</h3>
<p>If you are using Thymeleaf from Spring, you can also access these objects:</p>
<ul>
<li><strong>#themes</strong> : provides the same features as the Spring <code>spring:theme</code> JSP tag.</li>
</ul>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="pln">$</span><span class="pun">{#</span><span class="pln">themes</span><span class="pun">.</span><span class="pln">code</span><span class="pun">(</span><span class="str">'foo'</span><span class="pun">)}</span></code></pre>
</section>
<section id="spring-beans" class="level3">
<h3>Spring beans</h3>
<p>Thymeleaf also allows accessing beans registered at your Spring Application Context in the standard way defined by Spring EL, which is using the syntax <code>@beanName</code>, for example:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:text</span><span class="pun">=</span><span class="atv">"${@authService.getUserName()}"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/div&gt;</span></code></pre>
</section>
</section>
<section id="appendix-b-expression-utility-objects" class="level1">
<h1>18 Appendix B: Expression Utility Objects</h1>
<section id="dates" class="level3">
<h3>Dates</h3>
<ul>
<li><strong>#dates</strong> : utility methods for <code>java.util.Date</code> objects:</li>
</ul>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">/*
 * ======================================================================
 * See javadoc API for class org.thymeleaf.expression.Dates
 * ======================================================================
 */</span><span class="pln">

</span><span class="com">/*
 * Null-safe toString()
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">toString</span><span class="pun">(</span><span class="pln">obj</span><span class="pun">)}</span><span class="pln">                           </span><span class="com">// also array*, list* and set*</span><span class="pln">

</span><span class="com">/*
 * Format date with the standard locale format
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">arrayFormat</span><span class="pun">(</span><span class="pln">datesArray</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">listFormat</span><span class="pun">(</span><span class="pln">datesList</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">setFormat</span><span class="pun">(</span><span class="pln">datesSet</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Format date with the specified pattern
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">date</span><span class="pun">,</span><span class="pln"> </span><span class="str">'dd/MMM/yyyy HH:mm'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">arrayFormat</span><span class="pun">(</span><span class="pln">datesArray</span><span class="pun">,</span><span class="pln"> </span><span class="str">'dd/MMM/yyyy HH:mm'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">listFormat</span><span class="pun">(</span><span class="pln">datesList</span><span class="pun">,</span><span class="pln"> </span><span class="str">'dd/MMM/yyyy HH:mm'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">setFormat</span><span class="pun">(</span><span class="pln">datesSet</span><span class="pun">,</span><span class="pln"> </span><span class="str">'dd/MMM/yyyy HH:mm'</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Obtain date properties
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">day</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">                    </span><span class="com">// also arrayDay(...), listDay(...), etc.</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">month</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">                  </span><span class="com">// also arrayMonth(...), listMonth(...), etc.</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">monthName</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">              </span><span class="com">// also arrayMonthName(...), listMonthName(...), etc.</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">monthNameShort</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">         </span><span class="com">// also arrayMonthNameShort(...), listMonthNameShort(...), etc.</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">year</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">                   </span><span class="com">// also arrayYear(...), listYear(...), etc.</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">dayOfWeek</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">              </span><span class="com">// also arrayDayOfWeek(...), listDayOfWeek(...), etc.</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">dayOfWeekName</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">          </span><span class="com">// also arrayDayOfWeekName(...), listDayOfWeekName(...), etc.</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">dayOfWeekNameShort</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">     </span><span class="com">// also arrayDayOfWeekNameShort(...), listDayOfWeekNameShort(...), etc.</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">hour</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">                   </span><span class="com">// also arrayHour(...), listHour(...), etc.</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">minute</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">                 </span><span class="com">// also arrayMinute(...), listMinute(...), etc.</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">second</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">                 </span><span class="com">// also arraySecond(...), listSecond(...), etc.</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">millisecond</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">            </span><span class="com">// also arrayMillisecond(...), listMillisecond(...), etc.</span><span class="pln">

</span><span class="com">/*
 * Create date (java.util.Date) objects from its components
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">create</span><span class="pun">(</span><span class="pln">year</span><span class="pun">,</span><span class="pln">month</span><span class="pun">,</span><span class="pln">day</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">create</span><span class="pun">(</span><span class="pln">year</span><span class="pun">,</span><span class="pln">month</span><span class="pun">,</span><span class="pln">day</span><span class="pun">,</span><span class="pln">hour</span><span class="pun">,</span><span class="pln">minute</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">create</span><span class="pun">(</span><span class="pln">year</span><span class="pun">,</span><span class="pln">month</span><span class="pun">,</span><span class="pln">day</span><span class="pun">,</span><span class="pln">hour</span><span class="pun">,</span><span class="pln">minute</span><span class="pun">,</span><span class="pln">second</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">create</span><span class="pun">(</span><span class="pln">year</span><span class="pun">,</span><span class="pln">month</span><span class="pun">,</span><span class="pln">day</span><span class="pun">,</span><span class="pln">hour</span><span class="pun">,</span><span class="pln">minute</span><span class="pun">,</span><span class="pln">second</span><span class="pun">,</span><span class="pln">millisecond</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Create a date (java.util.Date) object for the current date and time
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">createNow</span><span class="pun">()}</span><span class="pln">

</span><span class="com">/*
 * Create a date (java.util.Date) object for the current date (time set to 00:00)
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">dates</span><span class="pun">.</span><span class="pln">createToday</span><span class="pun">()}</span></code></pre>
</section>
<section id="calendars" class="level3">
<h3>Calendars</h3>
<ul>
<li><strong>#calendars</strong> : analogous to <code>#dates</code>, but for <code>java.util.Calendar</code> objects:</li>
</ul>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">/*
 * ======================================================================
 * See javadoc API for class org.thymeleaf.expression.Calendars
 * ======================================================================
 */</span><span class="pln">

</span><span class="com">/*
 * Format calendar with the standard locale format
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">cal</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">arrayFormat</span><span class="pun">(</span><span class="pln">calArray</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">listFormat</span><span class="pun">(</span><span class="pln">calList</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">setFormat</span><span class="pun">(</span><span class="pln">calSet</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Format calendar with the specified pattern
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">cal</span><span class="pun">,</span><span class="pln"> </span><span class="str">'dd/MMM/yyyy HH:mm'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">arrayFormat</span><span class="pun">(</span><span class="pln">calArray</span><span class="pun">,</span><span class="pln"> </span><span class="str">'dd/MMM/yyyy HH:mm'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">listFormat</span><span class="pun">(</span><span class="pln">calList</span><span class="pun">,</span><span class="pln"> </span><span class="str">'dd/MMM/yyyy HH:mm'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">setFormat</span><span class="pun">(</span><span class="pln">calSet</span><span class="pun">,</span><span class="pln"> </span><span class="str">'dd/MMM/yyyy HH:mm'</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Obtain calendar properties
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">day</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">                </span><span class="com">// also arrayDay(...), listDay(...), etc.</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">month</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">              </span><span class="com">// also arrayMonth(...), listMonth(...), etc.</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">monthName</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">          </span><span class="com">// also arrayMonthName(...), listMonthName(...), etc.</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">monthNameShort</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">     </span><span class="com">// also arrayMonthNameShort(...), listMonthNameShort(...), etc.</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">year</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">               </span><span class="com">// also arrayYear(...), listYear(...), etc.</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">dayOfWeek</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">          </span><span class="com">// also arrayDayOfWeek(...), listDayOfWeek(...), etc.</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">dayOfWeekName</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">      </span><span class="com">// also arrayDayOfWeekName(...), listDayOfWeekName(...), etc.</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">dayOfWeekNameShort</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln"> </span><span class="com">// also arrayDayOfWeekNameShort(...), listDayOfWeekNameShort(...), etc.</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">hour</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">               </span><span class="com">// also arrayHour(...), listHour(...), etc.</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">minute</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">             </span><span class="com">// also arrayMinute(...), listMinute(...), etc.</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">second</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">             </span><span class="com">// also arraySecond(...), listSecond(...), etc.</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">millisecond</span><span class="pun">(</span><span class="pln">date</span><span class="pun">)}</span><span class="pln">        </span><span class="com">// also arrayMillisecond(...), listMillisecond(...), etc.</span><span class="pln">

</span><span class="com">/*
 * Create calendar (java.util.Calendar) objects from its components
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">create</span><span class="pun">(</span><span class="pln">year</span><span class="pun">,</span><span class="pln">month</span><span class="pun">,</span><span class="pln">day</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">create</span><span class="pun">(</span><span class="pln">year</span><span class="pun">,</span><span class="pln">month</span><span class="pun">,</span><span class="pln">day</span><span class="pun">,</span><span class="pln">hour</span><span class="pun">,</span><span class="pln">minute</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">create</span><span class="pun">(</span><span class="pln">year</span><span class="pun">,</span><span class="pln">month</span><span class="pun">,</span><span class="pln">day</span><span class="pun">,</span><span class="pln">hour</span><span class="pun">,</span><span class="pln">minute</span><span class="pun">,</span><span class="pln">second</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">create</span><span class="pun">(</span><span class="pln">year</span><span class="pun">,</span><span class="pln">month</span><span class="pun">,</span><span class="pln">day</span><span class="pun">,</span><span class="pln">hour</span><span class="pun">,</span><span class="pln">minute</span><span class="pun">,</span><span class="pln">second</span><span class="pun">,</span><span class="pln">millisecond</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Create a calendar (java.util.Calendar) object for the current date and time
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">createNow</span><span class="pun">()}</span><span class="pln">

</span><span class="com">/*
 * Create a calendar (java.util.Calendar) object for the current date (time set to 00:00)
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">calendars</span><span class="pun">.</span><span class="pln">createToday</span><span class="pun">()}</span></code></pre>
</section>
<section id="numbers" class="level3">
<h3>Numbers</h3>
<ul>
<li><strong>#numbers</strong> : utility methods for number objects:</li>
</ul>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">/*
 * ======================================================================
 * See javadoc API for class org.thymeleaf.expression.Numbers
 * ======================================================================
 */</span><span class="pln">

</span><span class="com">/*
 * ==========================
 * Formatting integer numbers
 * ==========================
 */</span><span class="pln">

</span><span class="com">/* 
 * Set minimum integer digits.
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">numbers</span><span class="pun">.</span><span class="pln">formatInteger</span><span class="pun">(</span><span class="pln">num</span><span class="pun">,</span><span class="lit">3</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">numbers</span><span class="pun">.</span><span class="pln">arrayFormatInteger</span><span class="pun">(</span><span class="pln">numArray</span><span class="pun">,</span><span class="lit">3</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">numbers</span><span class="pun">.</span><span class="pln">listFormatInteger</span><span class="pun">(</span><span class="pln">numList</span><span class="pun">,</span><span class="lit">3</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">numbers</span><span class="pun">.</span><span class="pln">setFormatInteger</span><span class="pun">(</span><span class="pln">numSet</span><span class="pun">,</span><span class="lit">3</span><span class="pun">)}</span><span class="pln">


</span><span class="com">/* 
 * Set minimum integer digits and thousands separator: 
 * 'POINT', 'COMMA', 'NONE' or 'DEFAULT' (by locale).
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">numbers</span><span class="pun">.</span><span class="pln">formatInteger</span><span class="pun">(</span><span class="pln">num</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="str">'POINT'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">numbers</span><span class="pun">.</span><span class="pln">arrayFormatInteger</span><span class="pun">(</span><span class="pln">numArray</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="str">'POINT'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">numbers</span><span class="pun">.</span><span class="pln">listFormatInteger</span><span class="pun">(</span><span class="pln">numList</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="str">'POINT'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">numbers</span><span class="pun">.</span><span class="pln">setFormatInteger</span><span class="pun">(</span><span class="pln">numSet</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="str">'POINT'</span><span class="pun">)}</span><span class="pln">


</span><span class="com">/*
 * ==========================
 * Formatting decimal numbers
 * ==========================
 */</span><span class="pln">

</span><span class="com">/*
 * Set minimum integer digits and (exact) decimal digits.
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">numbers</span><span class="pun">.</span><span class="pln">formatDecimal</span><span class="pun">(</span><span class="pln">num</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="lit">2</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">numbers</span><span class="pun">.</span><span class="pln">arrayFormatDecimal</span><span class="pun">(</span><span class="pln">numArray</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="lit">2</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">numbers</span><span class="pun">.</span><span class="pln">listFormatDecimal</span><span class="pun">(</span><span class="pln">numList</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="lit">2</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">numbers</span><span class="pun">.</span><span class="pln">setFormatDecimal</span><span class="pun">(</span><span class="pln">numSet</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="lit">2</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Set minimum integer digits and (exact) decimal digits, and also decimal separator.
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">numbers</span><span class="pun">.</span><span class="pln">formatDecimal</span><span class="pun">(</span><span class="pln">num</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="lit">2</span><span class="pun">,</span><span class="str">'COMMA'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">numbers</span><span class="pun">.</span><span class="pln">arrayFormatDecimal</span><span class="pun">(</span><span class="pln">numArray</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="lit">2</span><span class="pun">,</span><span class="str">'COMMA'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">numbers</span><span class="pun">.</span><span class="pln">listFormatDecimal</span><span class="pun">(</span><span class="pln">numList</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="lit">2</span><span class="pun">,</span><span class="str">'COMMA'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">numbers</span><span class="pun">.</span><span class="pln">setFormatDecimal</span><span class="pun">(</span><span class="pln">numSet</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="lit">2</span><span class="pun">,</span><span class="str">'COMMA'</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Set minimum integer digits and (exact) decimal digits, and also thousands and 
 * decimal separator.
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">numbers</span><span class="pun">.</span><span class="pln">formatDecimal</span><span class="pun">(</span><span class="pln">num</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="str">'POINT'</span><span class="pun">,</span><span class="lit">2</span><span class="pun">,</span><span class="str">'COMMA'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">numbers</span><span class="pun">.</span><span class="pln">arrayFormatDecimal</span><span class="pun">(</span><span class="pln">numArray</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="str">'POINT'</span><span class="pun">,</span><span class="lit">2</span><span class="pun">,</span><span class="str">'COMMA'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">numbers</span><span class="pun">.</span><span class="pln">listFormatDecimal</span><span class="pun">(</span><span class="pln">numList</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="str">'POINT'</span><span class="pun">,</span><span class="lit">2</span><span class="pun">,</span><span class="str">'COMMA'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">numbers</span><span class="pun">.</span><span class="pln">setFormatDecimal</span><span class="pun">(</span><span class="pln">numSet</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="str">'POINT'</span><span class="pun">,</span><span class="lit">2</span><span class="pun">,</span><span class="str">'COMMA'</span><span class="pun">)}</span><span class="pln">



</span><span class="com">/*
 * ==========================
 * Utility methods
 * ==========================
 */</span><span class="pln">

</span><span class="com">/*
 * Create a sequence (array) of integer numbers going
 * from x to y
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">numbers</span><span class="pun">.</span><span class="pln">sequence</span><span class="pun">(</span><span class="pln">from</span><span class="pun">,</span><span class="pln">to</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">numbers</span><span class="pun">.</span><span class="pln">sequence</span><span class="pun">(</span><span class="pln">from</span><span class="pun">,</span><span class="pln">to</span><span class="pun">,</span><span class="pln">step</span><span class="pun">)}</span></code></pre>
</section>
<section id="strings" class="level3">
<h3>Strings</h3>
<ul>
<li><strong>#strings</strong> : utility methods for <code>String</code> objects:</li>
</ul>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">/*
 * ======================================================================
 * See javadoc API for class org.thymeleaf.expression.Strings
 * ======================================================================
 */</span><span class="pln">

</span><span class="com">/*
 * Check whether a String is empty (or null). Performs a trim() operation before check
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">isEmpty</span><span class="pun">(</span><span class="pln">name</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">arrayIsEmpty</span><span class="pun">(</span><span class="pln">nameArr</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">listIsEmpty</span><span class="pun">(</span><span class="pln">nameList</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">setIsEmpty</span><span class="pun">(</span><span class="pln">nameSet</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Perform an 'isEmpty()' check on a string and return it if false, defaulting to
 * another specified string if true.
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">defaultString</span><span class="pun">(</span><span class="pln">text</span><span class="pun">,</span><span class="kwd">default</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">arrayDefaultString</span><span class="pun">(</span><span class="pln">textArr</span><span class="pun">,</span><span class="kwd">default</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">listDefaultString</span><span class="pun">(</span><span class="pln">textList</span><span class="pun">,</span><span class="kwd">default</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">setDefaultString</span><span class="pun">(</span><span class="pln">textSet</span><span class="pun">,</span><span class="kwd">default</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Check whether a fragment is contained in a String
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">contains</span><span class="pun">(</span><span class="pln">name</span><span class="pun">,</span><span class="str">'ez'</span><span class="pun">)}</span><span class="pln">                     </span><span class="com">// also array*, list* and set*</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">containsIgnoreCase</span><span class="pun">(</span><span class="pln">name</span><span class="pun">,</span><span class="str">'ez'</span><span class="pun">)}</span><span class="pln">           </span><span class="com">// also array*, list* and set*</span><span class="pln">

</span><span class="com">/*
 * Check whether a String starts or ends with a fragment
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">startsWith</span><span class="pun">(</span><span class="pln">name</span><span class="pun">,</span><span class="str">'Don'</span><span class="pun">)}</span><span class="pln">                  </span><span class="com">// also array*, list* and set*</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">endsWith</span><span class="pun">(</span><span class="pln">name</span><span class="pun">,</span><span class="pln">endingFragment</span><span class="pun">)}</span><span class="pln">           </span><span class="com">// also array*, list* and set*</span><span class="pln">

</span><span class="com">/*
 * Substring-related operations
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">indexOf</span><span class="pun">(</span><span class="pln">name</span><span class="pun">,</span><span class="pln">frag</span><span class="pun">)}</span><span class="pln">                      </span><span class="com">// also array*, list* and set*</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">name</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="lit">5</span><span class="pun">)}</span><span class="pln">                     </span><span class="com">// also array*, list* and set*</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">substringAfter</span><span class="pun">(</span><span class="pln">name</span><span class="pun">,</span><span class="pln">prefix</span><span class="pun">)}</span><span class="pln">             </span><span class="com">// also array*, list* and set*</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">substringBefore</span><span class="pun">(</span><span class="pln">name</span><span class="pun">,</span><span class="pln">suffix</span><span class="pun">)}</span><span class="pln">            </span><span class="com">// also array*, list* and set*</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="pln">name</span><span class="pun">,</span><span class="str">'las'</span><span class="pun">,</span><span class="str">'ler'</span><span class="pun">)}</span><span class="pln">               </span><span class="com">// also array*, list* and set*</span><span class="pln">

</span><span class="com">/*
 * Append and prepend
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">prepend</span><span class="pun">(</span><span class="pln">str</span><span class="pun">,</span><span class="pln">prefix</span><span class="pun">)}</span><span class="pln">                     </span><span class="com">// also array*, list* and set*</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">str</span><span class="pun">,</span><span class="pln">suffix</span><span class="pun">)}</span><span class="pln">                      </span><span class="com">// also array*, list* and set*</span><span class="pln">

</span><span class="com">/*
 * Change case
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">toUpperCase</span><span class="pun">(</span><span class="pln">name</span><span class="pun">)}</span><span class="pln">                       </span><span class="com">// also array*, list* and set*</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">toLowerCase</span><span class="pun">(</span><span class="pln">name</span><span class="pun">)}</span><span class="pln">                       </span><span class="com">// also array*, list* and set*</span><span class="pln">

</span><span class="com">/*
 * Split and join
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">arrayJoin</span><span class="pun">(</span><span class="pln">namesArray</span><span class="pun">,</span><span class="str">','</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">listJoin</span><span class="pun">(</span><span class="pln">namesList</span><span class="pun">,</span><span class="str">','</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">setJoin</span><span class="pun">(</span><span class="pln">namesSet</span><span class="pun">,</span><span class="str">','</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">arraySplit</span><span class="pun">(</span><span class="pln">namesStr</span><span class="pun">,</span><span class="str">','</span><span class="pun">)}</span><span class="pln">                </span><span class="com">// returns String[]</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">listSplit</span><span class="pun">(</span><span class="pln">namesStr</span><span class="pun">,</span><span class="str">','</span><span class="pun">)}</span><span class="pln">                 </span><span class="com">// returns List&lt;String&gt;</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">setSplit</span><span class="pun">(</span><span class="pln">namesStr</span><span class="pun">,</span><span class="str">','</span><span class="pun">)}</span><span class="pln">                  </span><span class="com">// returns Set&lt;String&gt;</span><span class="pln">

</span><span class="com">/*
 * Trim
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">trim</span><span class="pun">(</span><span class="pln">str</span><span class="pun">)}</span><span class="pln">                               </span><span class="com">// also array*, list* and set*</span><span class="pln">

</span><span class="com">/*
 * Compute length
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">length</span><span class="pun">(</span><span class="pln">str</span><span class="pun">)}</span><span class="pln">                             </span><span class="com">// also array*, list* and set*</span><span class="pln">

</span><span class="com">/*
 * Abbreviate text making it have a maximum size of n. If text is bigger, it
 * will be clipped and finished in "..."
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">abbreviate</span><span class="pun">(</span><span class="pln">str</span><span class="pun">,</span><span class="lit">10</span><span class="pun">)}</span><span class="pln">                      </span><span class="com">// also array*, list* and set*</span><span class="pln">

</span><span class="com">/*
 * Convert the first character to upper-case (and vice-versa)
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">capitalize</span><span class="pun">(</span><span class="pln">str</span><span class="pun">)}</span><span class="pln">                         </span><span class="com">// also array*, list* and set*</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">unCapitalize</span><span class="pun">(</span><span class="pln">str</span><span class="pun">)}</span><span class="pln">                       </span><span class="com">// also array*, list* and set*</span><span class="pln">

</span><span class="com">/*
 * Convert the first character of every word to upper-case
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">capitalizeWords</span><span class="pun">(</span><span class="pln">str</span><span class="pun">)}</span><span class="pln">                    </span><span class="com">// also array*, list* and set*</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">capitalizeWords</span><span class="pun">(</span><span class="pln">str</span><span class="pun">,</span><span class="pln">delimiters</span><span class="pun">)}</span><span class="pln">         </span><span class="com">// also array*, list* and set*</span><span class="pln">

</span><span class="com">/*
 * Escape the string
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">escapeXml</span><span class="pun">(</span><span class="pln">str</span><span class="pun">)}</span><span class="pln">                          </span><span class="com">// also array*, list* and set*</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">escapeJava</span><span class="pun">(</span><span class="pln">str</span><span class="pun">)}</span><span class="pln">                         </span><span class="com">// also array*, list* and set*</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">escapeJavaScript</span><span class="pun">(</span><span class="pln">str</span><span class="pun">)}</span><span class="pln">                   </span><span class="com">// also array*, list* and set*</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">unescapeJava</span><span class="pun">(</span><span class="pln">str</span><span class="pun">)}</span><span class="pln">                       </span><span class="com">// also array*, list* and set*</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">unescapeJavaScript</span><span class="pun">(</span><span class="pln">str</span><span class="pun">)}</span><span class="pln">                 </span><span class="com">// also array*, list* and set*</span><span class="pln">

</span><span class="com">/*
 * Null-safe comparison and concatenation
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">equals</span><span class="pun">(</span><span class="pln">str</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">equalsIgnoreCase</span><span class="pun">(</span><span class="pln">str</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">concat</span><span class="pun">(</span><span class="pln">str</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">concatReplaceNulls</span><span class="pun">(</span><span class="pln">str</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Random
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">randomAlphanumeric</span><span class="pun">(</span><span class="pln">count</span><span class="pun">)}</span></code></pre>
</section>
<section id="objects" class="level3">
<h3>Objects</h3>
<ul>
<li><strong>#objects</strong> : utility methods for objects in general</li>
</ul>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">/*
 * ======================================================================
 * See javadoc API for class org.thymeleaf.expression.Objects
 * ======================================================================
 */</span><span class="pln">

</span><span class="com">/*
 * Return obj if it is not null, and default otherwise
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">objects</span><span class="pun">.</span><span class="pln">nullSafe</span><span class="pun">(</span><span class="pln">obj</span><span class="pun">,</span><span class="kwd">default</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">objects</span><span class="pun">.</span><span class="pln">arrayNullSafe</span><span class="pun">(</span><span class="pln">objArray</span><span class="pun">,</span><span class="kwd">default</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">objects</span><span class="pun">.</span><span class="pln">listNullSafe</span><span class="pun">(</span><span class="pln">objList</span><span class="pun">,</span><span class="kwd">default</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">objects</span><span class="pun">.</span><span class="pln">setNullSafe</span><span class="pun">(</span><span class="pln">objSet</span><span class="pun">,</span><span class="kwd">default</span><span class="pun">)}</span></code></pre>
</section>
<section id="booleans" class="level3">
<h3>Booleans</h3>
<ul>
<li><strong>#bools</strong> : utility methods for boolean evaluation</li>
</ul>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">/*
 * ======================================================================
 * See javadoc API for class org.thymeleaf.expression.Bools
 * ======================================================================
 */</span><span class="pln">

</span><span class="com">/*
 * Evaluate a condition in the same way that it would be evaluated in a th:if tag
 * (see conditional evaluation chapter afterwards).
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">bools</span><span class="pun">.</span><span class="pln">isTrue</span><span class="pun">(</span><span class="pln">obj</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">bools</span><span class="pun">.</span><span class="pln">arrayIsTrue</span><span class="pun">(</span><span class="pln">objArray</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">bools</span><span class="pun">.</span><span class="pln">listIsTrue</span><span class="pun">(</span><span class="pln">objList</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">bools</span><span class="pun">.</span><span class="pln">setIsTrue</span><span class="pun">(</span><span class="pln">objSet</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Evaluate with negation
 * Also works with arrays, lists or sets
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">bools</span><span class="pun">.</span><span class="pln">isFalse</span><span class="pun">(</span><span class="pln">cond</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">bools</span><span class="pun">.</span><span class="pln">arrayIsFalse</span><span class="pun">(</span><span class="pln">condArray</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">bools</span><span class="pun">.</span><span class="pln">listIsFalse</span><span class="pun">(</span><span class="pln">condList</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">bools</span><span class="pun">.</span><span class="pln">setIsFalse</span><span class="pun">(</span><span class="pln">condSet</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Evaluate and apply AND operator
 * Receive an array, a list or a set as parameter
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">bools</span><span class="pun">.</span><span class="pln">arrayAnd</span><span class="pun">(</span><span class="pln">condArray</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">bools</span><span class="pun">.</span><span class="pln">listAnd</span><span class="pun">(</span><span class="pln">condList</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">bools</span><span class="pun">.</span><span class="pln">setAnd</span><span class="pun">(</span><span class="pln">condSet</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Evaluate and apply OR operator
 * Receive an array, a list or a set as parameter
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">bools</span><span class="pun">.</span><span class="pln">arrayOr</span><span class="pun">(</span><span class="pln">condArray</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">bools</span><span class="pun">.</span><span class="pln">listOr</span><span class="pun">(</span><span class="pln">condList</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">bools</span><span class="pun">.</span><span class="pln">setOr</span><span class="pun">(</span><span class="pln">condSet</span><span class="pun">)}</span></code></pre>
</section>
<section id="arrays" class="level3">
<h3>Arrays</h3>
<ul>
<li><strong>#arrays</strong> : utility methods for arrays</li>
</ul>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">/*
 * ======================================================================
 * See javadoc API for class org.thymeleaf.expression.Arrays
 * ======================================================================
 */</span><span class="pln">

</span><span class="com">/*
 * Converts to array, trying to infer array component class.
 * Note that if resulting array is empty, or if the elements
 * of the target object are not all of the same class,
 * this method will return Object[].
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">arrays</span><span class="pun">.</span><span class="pln">toArray</span><span class="pun">(</span><span class="pln">object</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Convert to arrays of the specified component class.
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">arrays</span><span class="pun">.</span><span class="pln">toStringArray</span><span class="pun">(</span><span class="pln">object</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">arrays</span><span class="pun">.</span><span class="pln">toIntegerArray</span><span class="pun">(</span><span class="pln">object</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">arrays</span><span class="pun">.</span><span class="pln">toLongArray</span><span class="pun">(</span><span class="pln">object</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">arrays</span><span class="pun">.</span><span class="pln">toDoubleArray</span><span class="pun">(</span><span class="pln">object</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">arrays</span><span class="pun">.</span><span class="pln">toFloatArray</span><span class="pun">(</span><span class="pln">object</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">arrays</span><span class="pun">.</span><span class="pln">toBooleanArray</span><span class="pun">(</span><span class="pln">object</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Compute length
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">arrays</span><span class="pun">.</span><span class="pln">length</span><span class="pun">(</span><span class="pln">array</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Check whether array is empty
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">arrays</span><span class="pun">.</span><span class="pln">isEmpty</span><span class="pun">(</span><span class="pln">array</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Check if element or elements are contained in array
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">arrays</span><span class="pun">.</span><span class="pln">contains</span><span class="pun">(</span><span class="pln">array</span><span class="pun">,</span><span class="pln"> element</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">arrays</span><span class="pun">.</span><span class="pln">containsAll</span><span class="pun">(</span><span class="pln">array</span><span class="pun">,</span><span class="pln"> elements</span><span class="pun">)}</span></code></pre>
</section>
<section id="lists" class="level3">
<h3>Lists</h3>
<ul>
<li><strong>#lists</strong> : utility methods for lists</li>
</ul>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">/*
 * ======================================================================
 * See javadoc API for class org.thymeleaf.expression.Lists
 * ======================================================================
 */</span><span class="pln">

</span><span class="com">/*
 * Converts to list
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">lists</span><span class="pun">.</span><span class="pln">toList</span><span class="pun">(</span><span class="pln">object</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Compute size
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">lists</span><span class="pun">.</span><span class="pln">size</span><span class="pun">(</span><span class="pln">list</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Check whether list is empty
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">lists</span><span class="pun">.</span><span class="pln">isEmpty</span><span class="pun">(</span><span class="pln">list</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Check if element or elements are contained in list
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">lists</span><span class="pun">.</span><span class="pln">contains</span><span class="pun">(</span><span class="pln">list</span><span class="pun">,</span><span class="pln"> element</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">lists</span><span class="pun">.</span><span class="pln">containsAll</span><span class="pun">(</span><span class="pln">list</span><span class="pun">,</span><span class="pln"> elements</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Sort a copy of the given list. The members of the list must implement
 * comparable or you must define a comparator.
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">lists</span><span class="pun">.</span><span class="pln">sort</span><span class="pun">(</span><span class="pln">list</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">lists</span><span class="pun">.</span><span class="pln">sort</span><span class="pun">(</span><span class="pln">list</span><span class="pun">,</span><span class="pln"> comparator</span><span class="pun">)}</span></code></pre>
</section>
<section id="sets" class="level3">
<h3>Sets</h3>
<ul>
<li><strong>#sets</strong> : utility methods for sets</li>
</ul>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">/*
 * ======================================================================
 * See javadoc API for class org.thymeleaf.expression.Sets
 * ======================================================================
 */</span><span class="pln">

</span><span class="com">/*
 * Converts to set
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">sets</span><span class="pun">.</span><span class="pln">toSet</span><span class="pun">(</span><span class="pln">object</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Compute size
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">sets</span><span class="pun">.</span><span class="pln">size</span><span class="pun">(</span><span class="pln">set</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Check whether set is empty
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">sets</span><span class="pun">.</span><span class="pln">isEmpty</span><span class="pun">(</span><span class="pln">set</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Check if element or elements are contained in set
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">sets</span><span class="pun">.</span><span class="pln">contains</span><span class="pun">(</span><span class="pln">set</span><span class="pun">,</span><span class="pln"> element</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">sets</span><span class="pun">.</span><span class="pln">containsAll</span><span class="pun">(</span><span class="pln">set</span><span class="pun">,</span><span class="pln"> elements</span><span class="pun">)}</span></code></pre>
</section>
<section id="maps" class="level3">
<h3>Maps</h3>
<ul>
<li><strong>#maps</strong> : utility methods for maps</li>
</ul>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">/*
 * ======================================================================
 * See javadoc API for class org.thymeleaf.expression.Maps
 * ======================================================================
 */</span><span class="pln">

</span><span class="com">/*
 * Compute size
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">maps</span><span class="pun">.</span><span class="pln">size</span><span class="pun">(</span><span class="pln">map</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Check whether map is empty
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">maps</span><span class="pun">.</span><span class="pln">isEmpty</span><span class="pun">(</span><span class="pln">map</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Check if key/s or value/s are contained in maps
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">maps</span><span class="pun">.</span><span class="pln">containsKey</span><span class="pun">(</span><span class="pln">map</span><span class="pun">,</span><span class="pln"> key</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">maps</span><span class="pun">.</span><span class="pln">containsAllKeys</span><span class="pun">(</span><span class="pln">map</span><span class="pun">,</span><span class="pln"> keys</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">maps</span><span class="pun">.</span><span class="pln">containsValue</span><span class="pun">(</span><span class="pln">map</span><span class="pun">,</span><span class="pln"> value</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">maps</span><span class="pun">.</span><span class="pln">containsAllValues</span><span class="pun">(</span><span class="pln">map</span><span class="pun">,</span><span class="pln"> value</span><span class="pun">)}</span></code></pre>
</section>
<section id="aggregates" class="level3">
<h3>Aggregates</h3>
<ul>
<li><strong>#aggregates</strong> : utility methods for creating aggregates on arrays or collections</li>
</ul>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">/*
 * ======================================================================
 * See javadoc API for class org.thymeleaf.expression.Aggregates
 * ======================================================================
 */</span><span class="pln">

</span><span class="com">/*
 * Compute sum. Returns null if array or collection is empty
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">aggregates</span><span class="pun">.</span><span class="pln">sum</span><span class="pun">(</span><span class="pln">array</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">aggregates</span><span class="pun">.</span><span class="pln">sum</span><span class="pun">(</span><span class="pln">collection</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Compute average. Returns null if array or collection is empty
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">aggregates</span><span class="pun">.</span><span class="pln">avg</span><span class="pun">(</span><span class="pln">array</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">aggregates</span><span class="pun">.</span><span class="pln">avg</span><span class="pun">(</span><span class="pln">collection</span><span class="pun">)}</span></code></pre>
</section>
<section id="messages-1" class="level3">
<h3>Messages</h3>
<ul>
<li><strong>#messages</strong> : utility methods for obtaining externalized messages inside variables expressions, in the same way as they would be obtained using <code>#{...}</code> syntax.</li>
</ul>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">/*
 * ======================================================================
 * See javadoc API for class org.thymeleaf.expression.Messages
 * ======================================================================
 */</span><span class="pln">

</span><span class="com">/*
 * Obtain externalized messages. Can receive a single key, a key plus arguments,
 * or an array/list/set of keys (in which case it will return an array/list/set of 
 * externalized messages).
 * If a message is not found, a default message (like '??msgKey??') is returned.
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">messages</span><span class="pun">.</span><span class="pln">msg</span><span class="pun">(</span><span class="str">'msgKey'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">messages</span><span class="pun">.</span><span class="pln">msg</span><span class="pun">(</span><span class="str">'msgKey'</span><span class="pun">,</span><span class="pln"> param1</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">messages</span><span class="pun">.</span><span class="pln">msg</span><span class="pun">(</span><span class="str">'msgKey'</span><span class="pun">,</span><span class="pln"> param1</span><span class="pun">,</span><span class="pln"> param2</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">messages</span><span class="pun">.</span><span class="pln">msg</span><span class="pun">(</span><span class="str">'msgKey'</span><span class="pun">,</span><span class="pln"> param1</span><span class="pun">,</span><span class="pln"> param2</span><span class="pun">,</span><span class="pln"> param3</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">messages</span><span class="pun">.</span><span class="pln">msgWithParams</span><span class="pun">(</span><span class="str">'msgKey'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Object</span><span class="pun">[]</span><span class="pln"> </span><span class="pun">{</span><span class="pln">param1</span><span class="pun">,</span><span class="pln"> param2</span><span class="pun">,</span><span class="pln"> param3</span><span class="pun">,</span><span class="pln"> param4</span><span class="pun">})}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">messages</span><span class="pun">.</span><span class="pln">arrayMsg</span><span class="pun">(</span><span class="pln">messageKeyArray</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">messages</span><span class="pun">.</span><span class="pln">listMsg</span><span class="pun">(</span><span class="pln">messageKeyList</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">messages</span><span class="pun">.</span><span class="pln">setMsg</span><span class="pun">(</span><span class="pln">messageKeySet</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Obtain externalized messages or null. Null is returned instead of a default
 * message if a message for the specified key is not found.
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">messages</span><span class="pun">.</span><span class="pln">msgOrNull</span><span class="pun">(</span><span class="str">'msgKey'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">messages</span><span class="pun">.</span><span class="pln">msgOrNull</span><span class="pun">(</span><span class="str">'msgKey'</span><span class="pun">,</span><span class="pln"> param1</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">messages</span><span class="pun">.</span><span class="pln">msgOrNull</span><span class="pun">(</span><span class="str">'msgKey'</span><span class="pun">,</span><span class="pln"> param1</span><span class="pun">,</span><span class="pln"> param2</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">messages</span><span class="pun">.</span><span class="pln">msgOrNull</span><span class="pun">(</span><span class="str">'msgKey'</span><span class="pun">,</span><span class="pln"> param1</span><span class="pun">,</span><span class="pln"> param2</span><span class="pun">,</span><span class="pln"> param3</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">messages</span><span class="pun">.</span><span class="pln">msgOrNullWithParams</span><span class="pun">(</span><span class="str">'msgKey'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Object</span><span class="pun">[]</span><span class="pln"> </span><span class="pun">{</span><span class="pln">param1</span><span class="pun">,</span><span class="pln"> param2</span><span class="pun">,</span><span class="pln"> param3</span><span class="pun">,</span><span class="pln"> param4</span><span class="pun">})}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">messages</span><span class="pun">.</span><span class="pln">arrayMsgOrNull</span><span class="pun">(</span><span class="pln">messageKeyArray</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">messages</span><span class="pun">.</span><span class="pln">listMsgOrNull</span><span class="pun">(</span><span class="pln">messageKeyList</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">messages</span><span class="pun">.</span><span class="pln">setMsgOrNull</span><span class="pun">(</span><span class="pln">messageKeySet</span><span class="pun">)}</span></code></pre>
</section>
<section id="ids" class="level3">
<h3>IDs</h3>
<ul>
<li><strong>#ids</strong> : utility methods for dealing with <code>id</code> attributes that might be repeated (for example, as a result of an iteration).</li>
</ul>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-java"><span class="com">/*
 * ======================================================================
 * See javadoc API for class org.thymeleaf.expression.Ids
 * ======================================================================
 */</span><span class="pln">

</span><span class="com">/*
 * Normally used in th:id attributes, for appending a counter to the id attribute value
 * so that it remains unique even when involved in an iteration process.
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">ids</span><span class="pun">.</span><span class="pln">seq</span><span class="pun">(</span><span class="str">'someId'</span><span class="pun">)}</span><span class="pln">

</span><span class="com">/*
 * Normally used in th:for attributes in &lt;label&gt; tags, so that these labels can refer to Ids
 * generated by means if the #ids.seq(...) function.
 *
 * Depending on whether the &lt;label&gt; goes before or after the element with the #ids.seq(...)
 * function, the "next" (label goes before "seq") or the "prev" function (label goes after 
 * "seq") function should be called.
 */</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">ids</span><span class="pun">.</span><span class="pln">next</span><span class="pun">(</span><span class="str">'someId'</span><span class="pun">)}</span><span class="pln">
$</span><span class="pun">{#</span><span class="pln">ids</span><span class="pun">.</span><span class="pln">prev</span><span class="pun">(</span><span class="str">'someId'</span><span class="pun">)}</span></code></pre>
</section>
</section>
<section id="appendix-c-dom-selector-syntax" class="level1">
<h1>19 Appendix C: DOM Selector syntax</h1>
<p>DOM Selectors borrow syntax features from XPATH, CSS and jQuery, in order to provide a powerful and easy to use way to specify template fragments.</p>
<p>For example, the following selector will select every <code>&lt;div&gt;</code> with the class <code>content</code>, in every position inside the markup:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:include</span><span class="pun">=</span><span class="atv">"mytemplate :: [//div[@class='content']]"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/div&gt;</span></code></pre>
<p>The basic syntax inspired from XPath includes:</p>
<ul>
<li><p><code>/x</code> means direct children of the current node with name x.</p></li>
<li><p><code>//x</code> means children of the current node with name x, at any depth.</p></li>
<li><p><code>x[@z="v"]</code> means elements with name x and an attribute called z with value “v”.</p></li>
<li><p><code>x[@z1="v1" and @z2="v2"]</code> means elements with name x and attributes z1 and z2 with values “v1” and “v2”, respectively.</p></li>
<li><p><code>x[i]</code> means element with name x positioned in number i among its siblings.</p></li>
<li><p><code>x[@z="v"][i]</code> means elements with name x, attribute z with value “v” and positioned in number i among its siblings that also match this condition.</p></li>
</ul>
<p>But more concise syntax can also be used:</p>
<ul>
<li><p><code>x</code> is exactly equivalent to <code>//x</code> (search an element with name or reference <code>x</code> at any depth level).</p></li>
<li><p>Selectors are also allowed without element name/reference, as long as they include a specification of arguments. So <code>[@class='oneclass']</code> is a valid selector that looks for any elements (tags) with a class attribute with value “oneclass”.</p></li>
</ul>
<p>Advanced attribute selection features:</p>
<ul>
<li><p>Besides <code>=</code> (equal), other comparison operators are also valid: <code>!=</code> (not equal), <code>^=</code> (starts with) and <code>$=</code> (ends with). For example: <code>x[@class^='section']</code> means elements with name <code>x</code> and a value for attribute <code>class</code> that starts with <code>section</code>.</p></li>
<li><p>Attributes can be specified both starting with <code>@</code> (XPath-style) and without (jQuery-style). So <code>x[z='v']</code> is equivalent to <code>x[@z='v']</code>.</p></li>
<li><p>Multiple-attribute modifiers can be joined both with <code>and</code> (XPath-style) and also by chaining multiple modifiers (jQuery-style). So <code>x[@z1='v1' and @z2='v2']</code> is actually equivalent to <code>x[@z1='v1'][@z2='v2']</code> (and also to <code>x[z1='v1'][z2='v2']</code>).</p></li>
</ul>
<p>Direct <em>jQuery-like</em> selectors:</p>
<ul>
<li><p><code>x.oneclass</code> is equivalent to <code>x[class='oneclass']</code>.</p></li>
<li><p><code>.oneclass</code> is equivalent to <code>[class='oneclass']</code>.</p></li>
<li><p><code>x#oneid</code> is equivalent to <code>x[id='oneid']</code>.</p></li>
<li><p><code>#oneid</code> is equivalent to <code>[id='oneid']</code>.</p></li>
<li><p><code>x%oneref</code> means nodes -not just elements- with name x that match reference <em>oneref</em> according to a specified <code>DOMSelector.INodeReferenceChecker</code> implementation.</p></li>
<li><p><code>%oneref</code> means nodes -not just elements- with any name that match reference <em>oneref</em> according to a specified <code>DOMSelector.INodeReferenceChecker</code> implementation. Note this is actually equivalent to simply <code>oneref</code> because references can be used instead of element names.</p></li>
<li><p>Direct selectors and attribute selectors can be mixed: <code>a.external[@href^='https']</code>.</p></li>
</ul>
<p>The above DOM Selector expression:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:include</span><span class="pun">=</span><span class="atv">"mytemplate :: [//div[@class='content']]"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/div&gt;</span></code></pre>
<p>could be written as:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:include</span><span class="pun">=</span><span class="atv">"mytemplate :: [div.content]"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/div&gt;</span></code></pre>
<section id="multivalued-class-matching" class="level3">
<h3>Multivalued class matching</h3>
<p>DOM Selectors understand the class attribute to be <strong>multivalued</strong>, and therefore allow the application of selectors on this attribute even if the element has several class values.</p>
<p>For example, <code>div[class='two']</code> will match <code>&lt;div class="one two three" /&gt;</code></p>
</section>
<section id="optional-brackets" class="level3">
<h3>Optional brackets</h3>
<p>The syntax of the fragment inclusion attributes converts every fragment selection into a DOM selection, so brackets <code>[...]</code> are not needed (though allowed).</p>
<p>So the following, with no brackets, is equivalent to the bracketed selector seen above:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:include</span><span class="pun">=</span><span class="atv">"mytemplate :: div.content"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/div&gt;</span></code></pre>
<p>So, summarizing, this:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:replace</span><span class="pun">=</span><span class="atv">"mytemplate :: myfrag"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/div&gt;</span></code></pre>
<p>Will look for a <code>th:fragment="myfrag"</code> fragment signature. But would also look for tags with name <code>myfrag</code> if they existed (which they don’t, in HTML). Note the difference with:</p>
<pre class="sourceCode prettyprint prettyprinted"><code class="language-html"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">th:replace</span><span class="pun">=</span><span class="atv">"mytemplate :: .myfrag"</span><span class="tag">&gt;</span><span class="pln">...</span><span class="tag">&lt;/div&gt;</span></code></pre>
<p>which will actually look for any elements with <code>class="myfrag"</code>, without caring about <code>th:fragment</code> signatures.</p>
</section>
</section>
<section class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Given the fact that XHTML5 is just XML-formed HTML5 served with the application/xhtml+xml content type, we could also say that Thymeleaf supports XHTML5.<a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#fnref1">↩</a></p></li>
<li id="fn2"><p>Note that, although this template is valid XHTML, we earlier selected template mode “XHTML” and not “VALIDXHTML”. For now, it will be OK for us to just have validation turned off – but at the same time we don’t want our IDE to complain too much.<a href="http://www.thymeleaf.org/doc/usingthymeleaf.html#fnref2">↩</a></p></li>
</ol>
</section>
		</div>
	</div>

	</div>




</body></html>